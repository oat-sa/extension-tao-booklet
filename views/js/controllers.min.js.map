{"version":3,"sources":["routes.js","Booklet/editBooklet.js","Booklet/preview.js","Booklet/wizard.js","../../taoItems/assets/manager.js","../../taoItems/runner/api/itemRunner.js","../../taoQtiItem/qtiItem/core/qtiClasses.js","../../taoQtiItem/qtiItem/helper/util.js","../../taoQtiItem/qtiItem/helper/rendererConfig.js","../../taoQtiItem/qtiItem/core/Element.js","../../taoQtiItem/qtiItem/helper/xmlNsHandler.js","../../taoQtiItem/qtiItem/core/Loader.js","../../taoQtiItem/qtiItem/helper/interactionHelper.js","../../taoQtiItem/qtiRunner/core/Renderer.js","../../taoQtiItem/runner/provider/manager/picManager.js","../../taoQtiItem/runner/provider/manager/userModules.js","../../taoQtiPrint/qtiPrintRenderer/tpl/notYetSupported!tpl","../../taoQtiPrint/runner/provider/qtiprint.js","../../taoQtiPrint/runner/itemRunner.js","../../taoItems/assets/strategies.js","../../taoQtiPrint/lib/qrcode.js","../../taoQtiPrint/runner/tpl/pageTest!tpl","../../taoQtiPrint/runner/tpl/pageSection!tpl","../../taoQtiPrint/runner/tpl/pageBlock!tpl","../../taoQtiPrint/runner/testRenderers.js","../../taoQtiPrint/runner/testRunner.js","../tpl/print!tpl","PrintTest/render.js","../component/taskQueue.js","Results/printWizard.js"],"names":["define","Booklet","actions","editBooklet","wizard","preview","Results","printWizard","$","_","module","urlHelper","start","$downloader","hide","append","on","e","preventDefault","$form","target","closest","attr","route","uri","find","val","classUri","id","$frame","$container","css","height","urlUtil","checkStrategy","strategy","isPlainObject","isFunction","handle","isString","name","TypeError","assetManagerFactory","strategies","data","options","cache","isArray","defaults","parseUrl","assetManager","_strategies","addStrategy","this","push","prependStrategy","unshift","setStrategies","newStrategies","self","forEach","length","setData","key","value","getData","resolve","url","resolved","inputUrl","hasOwnProperty","parse","result","resolveBy","clearCache","eventifier","itemRunnerFactory","providerName","provider","providers","flow","init","done","pending","render","undefined","size","Error","keys","toString","container","newData","initDone","pendingTask","call","trigger","merge","assets","err","elt","renderDone","state","HTMLElement","setState","get","clear","clearDone","getState","getResponses","responses","renderFeedbacks","feedbacks","itemSession","register","_container","assessmentItem","responseProcessing","_simpleFeedbackRule","stylesheet","math","img","object","outcomeDeclaration","responseDeclaration","rubricBlock","associableHotspot","gap","gapImg","gapText","hotspotChoice","hottext","inlineChoice","simpleAssociableChoice","simpleChoice","associateInteraction","choiceInteraction","endAttemptInteraction","extendedTextInteraction","gapMatchInteraction","graphicAssociateInteraction","graphicGapMatchInteraction","graphicOrderInteraction","hotspotInteraction","hottextInteraction","inlineChoiceInteraction","matchInteraction","mediaInteraction","orderInteraction","prompt","selectPointInteraction","sliderInteraction","textEntryInteraction","uploadInteraction","feedbackBlock","feedbackInline","modalFeedback","customInteraction","infoControl","include","table","printedVariable","_tooltip","util","buildSerial","prefix","chars","i","charAt","Math","floor","random","buildId","item","usedIds","suffix","exists","getUsedIds","contains","buildIdentifier","useSuffix","getUsedIdentifiers","isUndefined","replace","findInCollection","element","collectionNames","searchedSerial","found","each","collectionName","collection","split","nameToken","parent","addMarkupNamespace","markup","ns","$0","$1","$2","$3","$4","indexOf","removeMarkupNamespaces","getMarkupUsedNamespaces","namespaces","original","slash","node","uniq","rendererConfigHelper","getOptionsFromArguments","args","placeholder","subclass","renderer","arg","isRenderer","console","log","Class","loggerFactory","rendererConfig","_instances","logger","Element","extend","qtiClass","serial","rootElement","attributes","metaData","match","setAttributes","initContainer","arguments","initObject","is","getSerial","elts","getComposingElements","prop","document","removeData","removeAttr","removeAttributes","warn","getAttributes","clone","attrNames","getBody","getObject","v","isA","getUsedClasses","ret","composingElts","body","location","getRootElement","setRelatedItem","setRootElement","getRelatedItem","setRenderer","getRenderer","rendering","_renderer","tplData","defaultData","tag","resolveUrl","renderTpl","replaceWith","postRender","altClassName","postRenderers","compact","getContainer","$scope","toArray","arr","type","isEmpty","addClass","className","clazz","_containClass","hasClass","removeClass","regex","RegExp","trim","toggleClass","isset","issetElement","unset","unsetElement","allClassStr","test","qtiElement","getElementBySerial","composingElements","getPrefix","html5Ns","prefixed","stripNs","pattern","openRegEx","closeRegEx","restoreNs","xml","tagMatch","xmlRe","tagRe","xmlMatch","imsXsd","prefixAtt","qtiClasses","xmlNsHandler","loadPortableCustomElementData","portableElement","typeIdentifier","entryPoint","libraries","setNamespace","xmlns","loadPortableCustomElementProperties","properties","rawProperties","forOwn","JSON","Loader","classesLocation","qti","setClassesLocation","getRequiredClasses","union","loadRequiredClasses","callback","reload","requiredClass","requiredClasses","required","_this","require","QtiClass","prototype","getLoadedClasses","loadItemData","Qti","loadContainer","outcomes","outcome","buildOutcome","addOutcomeDeclaration","feedback","buildElement","addModalFeedback","stylesheets","addStylesheet","response","buildResponse","addResponseDeclaration","feedbackRules","forIn","fbData","buildSimpleFeedbackRule","setResponseProcessing","buildResponseProcessing","setNamespaces","setSchemaLocations","schemaLocations","setApipAccessibility","apipAccessibility","loadAndBuildElement","loadElement","loadElementData","loadElements","allElements","elementData","template","howMatch","defaultValue","correctResponse","correctResponses","mapping","mapEntries","areaMapping","mappingAttributes","feedbackRule","setCondition","condition","comparedValue","feedbackOutcome","feedbackThen","modalFeedbacks","feedbackElse","comparedOutcome","rp","processingType","bodyObject","bodyData","elements","eltData","setElement","bdy","loadObjectData","loadInteractionData","loadChoiceData","loadMathData","loadPicData","loadTooltipData","interaction","buildInteractionChoices","loadPciData","choices","set","matchSet","choice","addChoice","gapImgs","addGapImg","text","_alt","setMathML","mathML","annotations","encoding","setAnnotation","tooltip","content","pci","pic","convertChoices","outputType","c","findChoices","inputType","getChoice","getChoiceByIdentifier","shuffleChoices","r","f","j","n","k","tmp","serialToIdentifier","choiceSerial","Handlebars","Promise","interactionHelper","themeLoader","getDocumentBaseUrl","window","protocol","host","pathname","_isValidRenderer","valid","classCorrect","_renderableClasses","pos","slice","subClass","_renderableSubclasses","_dependencies","_defaults","Renderer","registerRendererClass","list","success","_locations","_renderers","shuffledChoices","_getClassRenderer","setOption","setOptions","opts","getOption","getCustomMessage","elementName","messageKey","messages","compile","getAssetManager","getThemeLoader","qtiSubclass","res","decorators","isObject","before","after","renderDirect","tpl","setResponse","qtiInteraction","getResponse","resetResponse","destroy","getLoadedRenderers","renderersLocations","load","themes","base","available","theme","index","path","preload","intersection","reqClass","deps","requiredSubClasses","values","unload","setShuffledChoices","identificationType","pluck","getShuffledChoices","reshuffle","returnedType","getChoices","getRenderers","getLocations","getAbsoluteUrl","relUrl","absUrl","runtimeLocations","runtimeLocation","baseUrl","setAreaBroker","areaBroker","_areaBroker","getAreaBroker","getItemCreator","build","defaultOptions","NewRenderer","apply","picManager","_pic","_item","getPic","getItem","getTypeIdentifier","getDom","_dom","tool","children","first","button","broken","enable","dom","remove","disabled","disable","appendTo","offset","width","outerWidth","outerHeight","show","eventName","rest","picManagerCollection","getList","force","_list","_map","getElements","manager","managerFactory","picId","execute","action","executeAll","filter","cb","enablePic","disablePic","showPic","hidePic","enableAll","disableAll","showAll","hideAll","collectionFactory","userModules","config","reject","dependency","exec","message","hb","depth0","helpers","partials","program1","stack1","helper","buffer","additional","hash","functionType","compilerInfo","inverse","noop","fn","program","__","context","QtiLoader","notYetSupportedTpl","getQtiRenderer","rendererType","QtiRendererPromise","rendererModules","locations","catch","error","missingSupport","label","identifier","timeout","results","booklet","bubbleSheet","itemData","then","QtiRenderer","rendererOptions","_loader","_itemData","showResponseIdentifier","innerHTML","trace","race","all","delay","getInteractions","itemRunner","qtiRuntimeProvider","prependToUrl","slashcat","directory","encodeURIComponent","file","packedUrl","source","findKey","isAbsolute","isRelative","itemCssNoCache","bust","Date","now","external","base64","isBase64","taomedia","QR8bitByte","mode","QRMode","MODE_8BIT_BYTE","parsedData","l","byteArray","code","charCodeAt","Array","concat","QRCodeModel","typeNumber","errorCorrectLevel","modules","moduleCount","dataCache","dataList","QRPolynomial","num","shift","QRRSBlock","totalCount","dataCount","QRBitBuffer","_isSupportCanvas","CanvasRenderingContext2D","_getAndroid","android","sAgent","navigator","userAgent","aMat","parseFloat","_getTypeNumber","sText","nCorrectLevel","nType","_getUTF8Length","len","QRCodeLimitLength","nLimit","QRErrorCorrectLevel","L","M","Q","H","replacedText","encodeURI","QRCode","getLength","write","put","addData","isDark","row","col","getModuleCount","make","makeImpl","getBestMaskPattern","maskPattern","setupPositionProbePattern","setupPositionAdjustPattern","setupTimingPattern","setupTypeInfo","setupTypeNumber","createData","mapData","minLostPoint","lostPoint","QRUtil","getLostPoint","createMovieClip","target_mc","instance_name","depth","qr_mc","createEmptyMovieClip","cs","y","x","dark","beginFill","moveTo","lineTo","endFill","getPatternPosition","bits","getBCHTypeNumber","mod","getBCHTypeInfo","inc","bitIndex","byteIndex","mask","getMask","PAD0","PAD1","rsBlocks","getRSBlocks","getLengthInBits","totalDataCount","putBit","createBytes","maxDcCount","maxEcCount","dcdata","ecdata","dcCount","ecCount","max","rsPoly","getErrorCorrectPolynomial","rawPoly","modPoly","modIndex","totalCodeCount","MODE_NUMBER","MODE_ALPHA_NUM","MODE_KANJI","QRMaskPattern","PATTERN000","PATTERN001","PATTERN010","PATTERN011","PATTERN100","PATTERN101","PATTERN110","PATTERN111","PATTERN_POSITION_TABLE","G15","G18","G15_MASK","d","getBCHDigit","digit","errorCorrectLength","a","multiply","QRMath","gexp","qrCode","sameCount","count","darkCount","ratio","abs","glog","LOG_TABLE","EXP_TABLE","RS_BLOCK_TABLE","rsBlock","getRsBlockTable","bufIndex","bit","svgDrawer","Drawing","el","htOption","_el","_htOption","draw","oQRCode","makeSVG","attrs","createElementNS","setAttribute","nCount","svg","viewBox","String","fill","colorLight","setAttributeNS","appendChild","colorDark","child","hasChildNodes","removeChild","lastChild","useSVG","documentElement","tagName","toLowerCase","_onMakeImage","_elImage","src","_elCanvas","toDataURL","style","display","_safeSetDataURI","fSuccess","fFail","_fFail","_fSuccess","_bSupportDataURI","createElement","fOnError","fOnSuccess","onabort","onerror","onload","_android","factor","devicePixelRatio","drawImage","image","sx","sy","sw","sh","dx","dy","dw","dh","nodeName","_bIsPainted","_oContext","getContext","alt","nWidth","nHeight","nRoundedWidth","round","nRoundedHeight","bIsDark","nLeft","nTop","strokeStyle","lineWidth","fillStyle","fillRect","strokeRect","ceil","makeImage","isPainted","clearRect","nNumber","aHTML","join","elTable","childNodes","nLeftMarginTable","offsetWidth","nTopMarginTable","offsetHeight","margin","vOption","correctLevel","getElementById","_oQRCode","_oDrawing","makeCode","title","CorrectLevel","uniqid","escapeExpression","program3","logo","helperMissing","program5","subtitle","program7","date","program9","qrcode","assetStrategies","pageTestTpl","pageSectionTpl","testPage","coverPageOptions","cover_page","description","unique_id","sectionPage","section","itemPage","itemRef","itemState","itemDone","isDone","lang","assetsList","asset","asyncLib","testRenderers","pageBlockTpl","testRunnerFactory","testDefinitions","createPage","$pageBlock","layoutOptions","layout","testDefinition","items","pageRenderers","empty","rtl","testData","states","partial","testParts","testPart","sections","href","regular","use_bubble_sheet","show_response_identifier","parallel","cls","testRunner","printTpl","showMessage","msg","printLayoutHacking","previous","threshold","pages","blankPage","$section","computePageFromHeight","nextUntil","ready","status","layoutClasses","one_page_item","one_page_section","setTimeout","$mainContainer","reduce","clearTimeout","taskQueueTableFactory","bookletTaskQueue","queueId","taskQueue","rows","dataUrl","statusUrl","removeUrl","hider","report","switchContainer","purpose","$containers","refreshTree","$header","displayReport","$reportContainer","$submitter","toggle","nested","fold","$formContainer","$sent","asyncQueue","off","params","instances","classes","parseInt","serializeArray","param","stringify","ajax","dataType","fileDownload","httpMethod","failCallback","successCallback","downloadUrl"],"mappings":"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AA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,IAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,IAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,GAAA,EAAA,IAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,GAAA,EAAA,IAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,KAAA,EAAA,IAAA,GAAA,EAAA,IAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,GAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,GAAA,IAAA,MAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,MAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,IAAA,IA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","file":"routes.js","sourcesContent":["/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n *\r\n */\r\n\r\n//@see http://forge.taotesting.com/projects/tao/wiki/Front_js\r\ndefine('taoBooklet/controller/routes',[],function () {\r\n    'use strict';\r\n\r\n    return {\r\n        'Booklet': {\r\n            'actions': {\r\n                'editBooklet' : 'controller/Booklet/editBooklet',\r\n                'wizard'      : 'controller/Booklet/wizard',\r\n                'preview'     : 'controller/Booklet/preview'\r\n            }\r\n        },\r\n        'Results': {\r\n            'actions': {\r\n                'printWizard' : 'controller/Results/printWizard'\r\n            }\r\n        }\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoBooklet/controller/Booklet/editBooklet',['jquery', 'lodash', 'module', 'util/url'], function ($, _, module, urlHelper) {\r\n    'use strict';\r\n\r\n    return {\r\n        start: function () {\r\n\r\n            var $downloader = $('<iframe/>').hide();\r\n            $('form').append($downloader);\r\n\r\n            $('.btn-download').on('click', function (e) {\r\n                e.preventDefault();\r\n                var $form = $(e.target).closest('form');\r\n\r\n                $downloader.attr('src', urlHelper.route('download', 'Booklet', 'taoBooklet', {\r\n                    uri: $form.find('input[name=\"uri\"]').val(),\r\n                    classUri: $form.find('input[name=\"classUri\"]').val(),\r\n                    id: $form.find('input[name=\"id\"]').val()\r\n                }));\r\n            });\r\n        }\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoBooklet/controller/Booklet/preview',['jquery'], function ($) {\r\n    'use strict';\r\n\r\n    return {\r\n        start: function () {\r\n\r\n            //resize the frame to it's container height\r\n            var $frame = $('.preview-test');\r\n            var $container  = $frame.closest('.content-container');\r\n            $frame.css('min-height', ($container.height() - 50) + 'px' );\r\n        }\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoBooklet/controller/Booklet/wizard',['jquery'], function ($) {\r\n    'use strict';\r\n\r\n    return {\r\n        start: function () {\r\n\r\n            var $form = $('.main-container ').find('form');\r\n\r\n        }\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * The asset manager proposes you to resolve your asset URLs for you!\r\n * You need to add the resolution strategies, it will then evaluate each strategy until the right one is found\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoItems/assets/manager',[\r\n    'lodash',\r\n    'util/url'\r\n], function(_, urlUtil){\r\n    'use strict';\r\n\r\n    /**\r\n     * @typedef AssetStrategy Defines a way to resolve an asset path\r\n     * @property {String} name - the strategy name\r\n     * @property {assetStrategyHandle} handle - how to resolve the strategy.\r\n     */\r\n\r\n    /**\r\n     * @callback assetStrategyHandle\r\n     * @param {String|Object} url - the URL to resolved. If parseUrl, it's an object that contains host, port, search, queryString, etc.\r\n     * @param {Object} data - the context data\r\n     * @returns {String?} falsy if not resolved otherwise the resolved URL\r\n     */\r\n\r\n    /**\r\n     * Check if the given object is a valid AssetStrategy\r\n     * @param {AssetStrategy} strategy\r\n     * @throws {TypeError}\r\n     */\r\n    var checkStrategy = function checkStrategy(strategy){\r\n        if(!_.isPlainObject(strategy) || !_.isFunction(strategy.handle) || !_.isString(strategy.name)){\r\n            throw new TypeError('An asset resolution strategy is an object with a handle method and a name');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * The assetManagerFactory create a new assetManager with the given resolution strategies and a data context.\r\n     *\r\n     * @example\r\n     *   //define AssetStrategies with a name and a handle method\r\n     *   var strategies = [{\r\n     *       name : 'external',\r\n     *       handle : function(url, data){\r\n     *           if(/^http/.test(url)){\r\n     *               return path;\r\n     *           }\r\n     *       }\r\n     *   }, {\r\n     *       name : 'relative',\r\n     *       handle : function(url, data){\r\n     *           if(/^((\\.\\/)|(\\w\\/))/){\r\n     *               return data.baseUrl + '/' + url ;\r\n     *           }\r\n     *       }\r\n     *   }]);\r\n     *\r\n     *   var assetManager = assetManagerFactory(strategies, { baseUrl : 'http://t.oa/public/assets/' });\r\n     *   assetManager.resolve('http://foo/bar.png'); //will resolved using external\r\n     *   assetManager.resolve('bar.png'); //will resolved using relative strategy\r\n     *\r\n     * @param {AssetStrategy[]} strategies - the strategies\r\n     * @param {Object} data - the context data\r\n     * @param {Object} [options] - the manager options\r\n     * @param {Boolean} [options.parseUrl = true] - If the URL to give to the strategies should be parsed or given as it is.\r\n     * @param {Boolean} [options.cache] - resolve the same URL only once and store the result in memory.\r\n     *\r\n     * @exports taoItems/assets/manager\r\n     * @namespace assetManagerFactory\r\n     */\r\n    var assetManagerFactory = function assetManagerFactory(strategies, data, options) {\r\n\r\n        var cache  = {};\r\n\r\n        strategies = _.isArray(strategies) ? strategies : [strategies];\r\n        data       = data || {};\r\n        options    = _.defaults(options || {}, {\r\n            parseUrl : true\r\n        });\r\n\r\n        /**\r\n         * A brand new asset manager is created by the factory\r\n         */\r\n        var assetManager = {\r\n\r\n            /**\r\n             * The stack of strategies that would be used to resolve the asset path\r\n             * @type {AssetStrategy[]}\r\n             */\r\n            _strategies : [],\r\n\r\n            /**\r\n             * Add an asset resolution strategy at the end of the stack.\r\n             * The strategies will be evaluated in the order they've been added.\r\n             * @param {AssetStrategy} strategy - the strategy to add\r\n             * @throws {TypeError} if the strategy isn't defined correctly\r\n             */\r\n            addStrategy : function addStrategy (strategy){\r\n\r\n                checkStrategy(strategy);\r\n\r\n                this._strategies.push(strategy);\r\n            },\r\n\r\n            /**\r\n             * Add an asset resolution strategy at the beginning of the stack.\r\n             * The strategies will be evaluated in the order they've been added.\r\n             * @param {AssetStrategy} strategy - the strategy to add\r\n             * @throws {TypeError} if the strategy isn't defined correctly\r\n             */\r\n            prependStrategy : function prependStrategy(strategy){\r\n\r\n                checkStrategy(strategy);\r\n\r\n                this._strategies.unshift(strategy);\r\n            },\r\n\r\n            /**\r\n             * Change the strategies\r\n             * @param {AssetStrategy[]} strategies - the strategies\r\n             * @throws {TypeError} if the strategy isn't defined correctly\r\n             */\r\n            setStrategies : function setStrategies(newStrategies){\r\n                var self = this;\r\n\r\n                this._strategies = [];\r\n\r\n                //assign the strategies to the assetManager\r\n                _.forEach(newStrategies, function(strategy){\r\n\r\n                    //if it's an object we add it directly\r\n                    if(_.isPlainObject(strategy)){\r\n                        assetManager.addStrategy(strategy);\r\n\r\n                    //if it's a function, we create the strategy with a generated name\r\n                    } else if(_.isFunction(strategy)){\r\n                        self.addStrategy({\r\n                            name   : 'strategy_' + (self._strategies.length + 1),\r\n                            handle : strategy\r\n                        });\r\n                    }\r\n                });\r\n            },\r\n\r\n            /**\r\n             * Set context data\r\n             * @param {String|Object} [key] - the key of the data to set or the data values if it's an object\r\n             * @param {*} [value] - the value to set if a key is given\r\n             */\r\n            setData : function setData(key, value){\r\n                if(_.isString(key) && typeof value !== 'undefined'){\r\n                    data[key] = value;\r\n                } else if(_.isPlainObject(key)){\r\n                    data = key;\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Get context data\r\n             * @param {String} [key] - if we want the value of a particular key\r\n             * @returns {Object|*} all the data or the propriety value if key is given\r\n             */\r\n            getData : function getData(key){\r\n                if(_.isString(key)){\r\n                    return data[key];\r\n                }\r\n                return data;\r\n            },\r\n\r\n            /**\r\n             * Resolve the given URL against the strategies\r\n             * @param {String} url - the URL to resolve\r\n             * @returns {String?} the resolved URL or nothing\r\n             */\r\n            resolve : function resolve(url){\r\n                var resolved;\r\n                var inputUrl;\r\n\r\n                //if caching try to load the value from the cache\r\n                if(options.cache && cache.hasOwnProperty(url)){\r\n                    return cache[url];\r\n                }\r\n\r\n                //parse the URL ?\r\n                inputUrl = options.parseUrl ? urlUtil.parse(url) : url;\r\n\r\n                //call strategies handlers, in their order until once returns something\r\n                _.forEach(this._strategies, function(strategy){\r\n                    var result = strategy.handle(inputUrl, data);\r\n                    if(result){\r\n                        resolved = result;\r\n                        return false;\r\n                    }\r\n                });\r\n\r\n                resolved = resolved || '';\r\n\r\n                if(options.cache){\r\n                    cache[url] = resolved;\r\n                }\r\n\r\n                return resolved;\r\n            },\r\n\r\n            /**\r\n             * Resolve the given URL against the strategy identified by the given name\r\n             * @param {String} name - the strategy name\r\n             * @param {String} url - the URL to resolve\r\n             * @returns {String?} the resolved URL or nothing\r\n             */\r\n            resolveBy : function resolveBy(name, url){\r\n                var inputUrl;\r\n                var resolved = '';\r\n                var strategy = _.find(this._strategies, {name : name});\r\n                if(strategy){\r\n                    //parse the URL ?\r\n                    inputUrl = options.parseUrl ? urlUtil.parse(url) : url;\r\n                    resolved = strategy.handle(inputUrl, data);\r\n                }\r\n                return resolved;\r\n            },\r\n\r\n            /**\r\n             * When the cache is used, it could be useful to clear the cache\r\n             */\r\n            clearCache : function clearCache(){\r\n                if(options.cache){\r\n                    cache = {};\r\n                }\r\n            }\r\n        };\r\n\r\n        assetManager.setStrategies(strategies);\r\n\r\n        return assetManager;\r\n    };\r\n\r\n    return assetManagerFactory;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoItems/runner/api/itemRunner',[\r\n    'jquery',\r\n    'lodash',\r\n    'core/eventifier',\r\n    'taoItems/assets/manager'\r\n], function($, _, eventifier, assetManagerFactory){\r\n    'use strict';\r\n\r\n     /**\r\n     *\r\n     * Builds a brand new {@link itemRunner}.\r\n     *\r\n     * <strong>The factory is an internal mechanism to create encapsulated contexts.\r\n     *  I suggest you to use directly the name <i>itemRunner</i> when you require this module.</strong>\r\n     *\r\n     * @example require(['itemRunner'], function(itemRunner){\r\n                    itemRunner({itemId : 12})\r\n     *                    .on('statechange', function(state){\r\n     *\r\n     *                    })\r\n     *                    .on('ready', function(){\r\n     *\r\n     *                    })\r\n     *                    .on('response', function(){\r\n     *\r\n     *                    })\r\n     *                   .init()\r\n     *                   .render($('.item-container'));\r\n     *          });\r\n     *\r\n     * @exports itemRunner\r\n     * @namespace itemRunnerFactory\r\n     *\r\n     * @param {String} [providerName] - the name of a provider previously registered see {@link itemRunnerFactory#register}\r\n     * @param {Object} [data] - the data of the item to run\r\n     *\r\n     * @returns {itemRunner}\r\n     */\r\n    var itemRunnerFactory = function itemRunnerFactory(providerName, data, options){\r\n\r\n        var provider,\r\n            providers,\r\n            assetManager;\r\n\r\n        //contains the bound events.\r\n        var events = {};\r\n\r\n        //flow structure to manage sync calls in an async context.\r\n        var flow = {\r\n            init : {\r\n                done: false,\r\n                pending : []\r\n            },\r\n            render : {\r\n                done: false,\r\n                pending : []\r\n            }\r\n        };\r\n\r\n        //optional params based on type\r\n        if(_.isPlainObject(providerName)){\r\n            data = providerName;\r\n            providerName = undefined;\r\n        }\r\n\r\n        data = data || {};\r\n        options = options || {};\r\n\r\n        /*\r\n         * Select the provider\r\n         */\r\n        providers = itemRunnerFactory.providers;\r\n\r\n        //check a provider is available\r\n        if(!providers || _.size(providers) === 0){\r\n            throw new Error('No provider regitered');\r\n        }\r\n\r\n        if(_.isString(providerName) && providerName.length > 0){\r\n            provider = providers[providerName];\r\n        } else if(_.size(providers) === 1) {\r\n\r\n            //if there is only one provider, then we take this one\r\n            providerName = _.keys(providers)[0];\r\n            provider = providers[providerName];\r\n        }\r\n\r\n        //now we should have a provider\r\n        if(!provider){\r\n            throw new Error('No candidate found for the provider');\r\n        }\r\n\r\n        //set up a default assetManager using a \"do nothing\" strategy\r\n        assetManager = options.assetManager || assetManagerFactory(function defaultStrategy(url){\r\n            return url.toString();\r\n        });\r\n\r\n\r\n       /**\r\n        * The itemRunner\r\n        * @typedef {Object} itemRunner\r\n        */\r\n\r\n        /**\r\n        * @type {itemRunner}\r\n        * @lends itemRunnerFactory\r\n        */\r\n        return eventifier({\r\n\r\n            /**\r\n             * Items container\r\n             * @type {HTMLElement}\r\n             */\r\n            container : null,\r\n\r\n            /**\r\n             * The asset manager used to resolve asset\r\n             * @see taoItems/asset/manager\r\n             * @type {AssetManager}\r\n             */\r\n            assetManager : assetManager,\r\n\r\n            /**\r\n             * To give options to the item runner provider\r\n             * @type {Object}\r\n             */\r\n            options : options,\r\n\r\n            /**\r\n             * Initialize the runner.\r\n             * @param {Object} [newData] - just in case you want to change item data (it should not occurs in most case)\r\n             * @returns {itemRunner} to chain calls\r\n             *\r\n             * @fires itemRunner#init\r\n             */\r\n            init : function(newData){\r\n                var self = this;\r\n\r\n                /**\r\n                 * Call back when init is done\r\n                 */\r\n                var initDone = function initDone(){\r\n\r\n                   //manage pending tasks the first time\r\n                    if(flow.init.done === false){\r\n                        flow.init.done = true;\r\n\r\n                        _.forEach(flow.init.pending, function(pendingTask){\r\n                            if(_.isFunction(pendingTask)){\r\n                                pendingTask.call(self);\r\n                            }\r\n                        });\r\n                        flow.init.pending = [];\r\n                    }\r\n\r\n                    /**\r\n                     * the runner has initialized correclty the item\r\n                     * @event itemRunner#init\r\n                     */\r\n                    self.trigger('init');\r\n                };\r\n\r\n                //merge data\r\n                if(newData){\r\n                    data = _.merge(data, newData);\r\n                }\r\n\r\n                if(_.isFunction(provider.init)){\r\n\r\n                    /**\r\n                     * Calls provider's initialization with item data.\r\n                     * @callback InitItemProvider\r\n                     * @param {Object} data - the item data\r\n                     * @param {Function} done - call once the initialization is done\r\n                     */\r\n                    provider.init.call(this, data, initDone);\r\n\r\n                } else {\r\n                    initDone();\r\n                }\r\n\r\n                return this;\r\n            },\r\n\r\n            /**\r\n             * Configure the assetManager\r\n             * @see taoItems/assets/manager\r\n             * @param {AssetStrategy[]} strategies - the resolving strategies\r\n             * @param {Object} [data] - the context data\r\n             * @param {Object} [options] - the asset manager options\r\n             * @returns {itemRunner} to chain calls\r\n             */\r\n            assets : function assets(strategies, data, options){\r\n\r\n                try{\r\n                    this.assetManager = assetManagerFactory(strategies, data, options);\r\n                } catch( err ){\r\n                    this.trigger('error', 'Something was wrong while configuring the asset manager : ' + err);\r\n                }\r\n\r\n                return this;\r\n            },\r\n\r\n            /**\r\n             * Initialize the current item.\r\n             *\r\n             * @param {HTMLElement|jQueryElement} elt - the DOM element that is going to contain the rendered item.\r\n             * @returns {itemRunner} to chain calls\r\n             *\r\n             * @fires itemRunner#ready\r\n             * @fires itemRunner#render\r\n             * @fires itemRunner#error if the elt isn't valid\r\n             *\r\n             * @fires itemRunner#statechange the provider is reponsible to trigger this event\r\n             * @fires itemRunner#responsechange  the provider is reponsible to trigger this event\r\n             */\r\n           render : function(elt, options){\r\n                var self = this;\r\n\r\n                /**\r\n                 * Call back when render is done\r\n                 */\r\n                var renderDone = function renderDone (){\r\n\r\n                    //manage pending tasks the first time\r\n                    if(flow.render.done === false){\r\n                        flow.render.done = true;\r\n\r\n                        _.forEach(flow.render.pending, function(pendingTask){\r\n                            if(_.isFunction(pendingTask)){\r\n                                pendingTask.call(self);\r\n                            }\r\n                        });\r\n                        flow.render.pending = [];\r\n                    }\r\n\r\n                    /**\r\n                     * The item is rendered\r\n                     * @event itemRunner#render\r\n                     */\r\n                    self.trigger('render');\r\n\r\n                    /**\r\n                     * The item is ready.\r\n                     * Alias of {@link itemRunner#render}\r\n                     * @event itemRunner#ready\r\n                     */\r\n                    self.trigger('ready');\r\n                };\r\n\r\n                options = _.defaults(options || {}, {state : {}});\r\n\r\n                //check elt\r\n                if( !(elt instanceof HTMLElement) && !(elt instanceof $) ){\r\n                    return self.trigger('error', 'A valid HTMLElement (or a jquery element) at least is required to render the item');\r\n                }\r\n\r\n                //set item state to restore item state after rendering if the provider enables it\r\n                if(options.state){\r\n                    this.setState(options.state);\r\n                }\r\n\r\n                if(flow.init.done === false){\r\n                    flow.init.pending.push(function(){\r\n                        this.render(elt, options);\r\n                    });\r\n                } else {\r\n\r\n                    //we keep a reference to the container\r\n                    if(elt instanceof $){\r\n                        this.container = elt.get(0);\r\n                    } else {\r\n                        this.container = elt;\r\n                    }\r\n\r\n                    //the state will be applied only when the rendering is made\r\n\r\n                    if(_.isFunction(provider.render)){\r\n\r\n                        /**\r\n                         * Calls the provider's render\r\n                         * @callback RendertItemProvider\r\n                         * @param {HTMLElement} elt - the element to render inside\r\n                         * @param {Function} done - call once the render is done\r\n                         * @param {Object} [options] - the array of options that the item runner provider may supports\r\n                         * @param {Object} [options.state] - pass initial item state to method render() in case the item runner provider require initial state to render\r\n                         */\r\n                        provider.render.call(this, this.container, renderDone, options);\r\n\r\n                    } else {\r\n                        renderDone();\r\n                    }\r\n                }\r\n\r\n                return this;\r\n           },\r\n\r\n           /**\r\n            * Clear the running item.\r\n            * @returns {itemRunner}\r\n            *\r\n            * @fires itemRunner#clear\r\n            */\r\n           clear : function(){\r\n                var self = this;\r\n\r\n                /**\r\n                 * Call back when clear is done\r\n                 */\r\n                var clearDone = function clearDone (){\r\n\r\n                    //events = {};\r\n\r\n                    /**\r\n                     * The item is ready.\r\n                     * @event itemRunner#clear\r\n                     */\r\n                    self.trigger('clear');\r\n                };\r\n                if(_.isFunction(provider.clear)){\r\n\r\n                    /**\r\n                     * Calls the provider's clear\r\n                     * @callback ClearItemProvider\r\n                     * @param {HTMLElement} elt - item's container\r\n                     * @param {Function} done - call once the initialization is done\r\n                     */\r\n                    provider.clear.call(this, this.container, clearDone);\r\n\r\n                } else {\r\n                    clearDone();\r\n                }\r\n\r\n                return this;\r\n           },\r\n\r\n           /**\r\n            * Get the current state of the running item.\r\n            *\r\n            * @returns {Object|Null} state\r\n            */\r\n           getState : function(){\r\n                var state = null;\r\n                if(_.isFunction(provider.getState)){\r\n\r\n                    /**\r\n                     * Calls the provider's getState\r\n                     * @callback GetStateItemProvider\r\n                     * @returns {Object} the state\r\n                     */\r\n                    state = provider.getState.call(this);\r\n                }\r\n                return state;\r\n           },\r\n\r\n           /**\r\n            * Set the current state of the running item.\r\n            * This should have the effect to restore the item state.\r\n            *\r\n            * @param {Object} state - the new state\r\n            * @returns {itemRunner}\r\n            *\r\n            * @fires itemRunner#error if the state type doesn't match\r\n            */\r\n           setState : function(state){\r\n\r\n                if(!_.isPlainObject(state)){\r\n                    return this.trigger('error', \"The item's state must be a JavaScript Plain Object: \" + (typeof state) + ' given');\r\n                }\r\n\r\n                //the state will be applied only when the rendering is made\r\n                if(flow.render.done === false){\r\n                    flow.render.pending.push(function(){\r\n                        this.setState(state);\r\n                    });\r\n                } else {\r\n\r\n                    if(_.isFunction(provider.setState)){\r\n\r\n                        /**\r\n                         * Calls the provider's setState\r\n                         * @callback SetStateItemProvider\r\n                         * @param {Object} state -  the state to set\r\n                         */\r\n                        provider.setState.call(this, state);\r\n                    }\r\n                }\r\n                return this;\r\n           },\r\n\r\n           /**\r\n            * Get the responses of the running item.\r\n            *\r\n            * @returns {Object} the item's responses\r\n            */\r\n           getResponses : function(){\r\n                var responses = {};\r\n                if(_.isFunction(provider.getResponses)){\r\n\r\n                    /**\r\n                     * Calls the provider's getResponses\r\n                     * @callback GetResponsesItemProvider\r\n                     * @returns {Object} the responses\r\n                     */\r\n                    responses = provider.getResponses.call(this);\r\n                }\r\n                return responses;\r\n           },\r\n\r\n            /**\r\n             * Append the modalFeedbacks into the item and create queue of feedbacks that should be displayed to the user\r\n             *\r\n             * @param {Object|Array} feedbacks - all feedbacks of the item\r\n             * @param {Object|Array} itemSession - determine feedbacks which should be displayed\r\n             * @param {function} done(renderingQueue) - runs after loading feedbacks into the item\r\n             *      # have parameter {Object|Array} renderingQueue with prepared queue of the feedbacks for displaying to the user\r\n             *\r\n             *\r\n             * Example:\r\n             *\r\n             *    this.renderFeedbacks({f1: 'feedback1', f2: 'feedback2', f3: 'feedback3'}, ['f2'], function(renderingQueue){\r\n             *      renderingQueue; // {'feedback2'}\r\n             *    });\r\n             */\r\n            renderFeedbacks : function renderFeedbacks(feedbacks, itemSession, done){\r\n                if(_.isFunction(provider.renderFeedbacks)) {\r\n                    provider.renderFeedbacks.call(this, feedbacks, itemSession, done);\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Register an <i>Item Runtime Provider</i> into the item runner.\r\n     * The provider provides the behavior required by the item runner.\r\n     *\r\n     * @param {String} name - the provider name will be used to select the provider while instantiating the runner\r\n     *\r\n     * @param {Object} provider - the Item Runtime Provider as a plain object. The itemRunner forwards encapsulate and delegate calls to the provider.\r\n     * @param {InitItemProvider} provider.init - the provider initializes the item from it's data, for example loading libraries, add some listeners, etc.\r\n     * @param {RenderItemProvider} provider.render - the provider renders the item within the given container element.\r\n     * @param {ClearItemProvider} [provider.clear] - the provider clears the item.\r\n     * @param {GetStateItemProvider} [provider.getState] - the provider get the item's state.\r\n     * @param {SetStateItemProvider} [provider.setState] - the provider restore the item to the given state.\r\n     * @param {GetRespnsesItemProvider} [provider.getResponses] - the provider gives the current responses.\r\n     *\r\n     * @throws TypeError when a wrong provider is given or an empty name.\r\n     */\r\n    itemRunnerFactory.register = function registerProvider(name, provider){\r\n        //type checking\r\n        if(!_.isString(name) || name.length <= 0){\r\n            throw new TypeError('It is required to give a name to your provider.');\r\n        }\r\n        if(!_.isPlainObject(provider) || (!_.isFunction(provider.init) && !_.isFunction(provider.render))){\r\n            throw new TypeError('A provider is an object that contains at least an init function or a render function.');\r\n        }\r\n\r\n        this.providers = this.providers || {};\r\n        this.providers[name] = provider;\r\n    };\r\n\r\n    return itemRunnerFactory;\r\n});\r\n\n","define('taoQtiItem/qtiItem/core/qtiClasses',[], function(){\r\n    return {\r\n        '_container' : 'taoQtiItem/qtiItem/core/Container',\r\n        'assessmentItem' : 'taoQtiItem/qtiItem/core/Item',\r\n        'responseProcessing' : 'taoQtiItem/qtiItem/core/ResponseProcessing',\r\n        '_simpleFeedbackRule' : 'taoQtiItem/qtiItem/core/response/SimpleFeedbackRule',\r\n        'stylesheet' : 'taoQtiItem/qtiItem/core/Stylesheet',\r\n        'math' : 'taoQtiItem/qtiItem/core/Math',\r\n        'img' : 'taoQtiItem/qtiItem/core/Img',\r\n        'object' : 'taoQtiItem/qtiItem/core/Object',\r\n        'outcomeDeclaration' : 'taoQtiItem/qtiItem/core/variables/OutcomeDeclaration',\r\n        'responseDeclaration' : 'taoQtiItem/qtiItem/core/variables/ResponseDeclaration',\r\n        'rubricBlock' : 'taoQtiItem/qtiItem/core/RubricBlock',\r\n        'associableHotspot' : 'taoQtiItem/qtiItem/core/choices/AssociableHotspot',\r\n        'gap' : 'taoQtiItem/qtiItem/core/choices/Gap',\r\n        'gapImg' : 'taoQtiItem/qtiItem/core/choices/GapImg',\r\n        'gapText' : 'taoQtiItem/qtiItem/core/choices/GapText',\r\n        'hotspotChoice' : 'taoQtiItem/qtiItem/core/choices/HotspotChoice',\r\n        'hottext' : 'taoQtiItem/qtiItem/core/choices/Hottext',\r\n        'inlineChoice' : 'taoQtiItem/qtiItem/core/choices/InlineChoice',\r\n        'simpleAssociableChoice' : 'taoQtiItem/qtiItem/core/choices/SimpleAssociableChoice',\r\n        'simpleChoice' : 'taoQtiItem/qtiItem/core/choices/SimpleChoice',\r\n        'associateInteraction' : 'taoQtiItem/qtiItem/core/interactions/AssociateInteraction',\r\n        'choiceInteraction' : 'taoQtiItem/qtiItem/core/interactions/ChoiceInteraction',\r\n        'endAttemptInteraction' : 'taoQtiItem/qtiItem/core/interactions/EndAttemptInteraction',\r\n        'extendedTextInteraction' : 'taoQtiItem/qtiItem/core/interactions/ExtendedTextInteraction',\r\n        'gapMatchInteraction' : 'taoQtiItem/qtiItem/core/interactions/GapMatchInteraction',\r\n        'graphicAssociateInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicAssociateInteraction',\r\n        'graphicGapMatchInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicGapMatchInteraction',\r\n        'graphicOrderInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicOrderInteraction',\r\n        'hotspotInteraction' : 'taoQtiItem/qtiItem/core/interactions/HotspotInteraction',\r\n        'hottextInteraction' : 'taoQtiItem/qtiItem/core/interactions/HottextInteraction',\r\n        'inlineChoiceInteraction' : 'taoQtiItem/qtiItem/core/interactions/InlineChoiceInteraction',\r\n        'matchInteraction' : 'taoQtiItem/qtiItem/core/interactions/MatchInteraction',\r\n        'mediaInteraction' : 'taoQtiItem/qtiItem/core/interactions/MediaInteraction',\r\n        'orderInteraction' : 'taoQtiItem/qtiItem/core/interactions/OrderInteraction',\r\n        'prompt' : 'taoQtiItem/qtiItem/core/interactions/Prompt',\r\n        'selectPointInteraction' : 'taoQtiItem/qtiItem/core/interactions/SelectPointInteraction',\r\n        'sliderInteraction' : 'taoQtiItem/qtiItem/core/interactions/SliderInteraction',\r\n        'textEntryInteraction' : 'taoQtiItem/qtiItem/core/interactions/TextEntryInteraction',\r\n        'uploadInteraction' : 'taoQtiItem/qtiItem/core/interactions/UploadInteraction',\r\n        'feedbackBlock' : 'taoQtiItem/qtiItem/core/feedbacks/FeedbackBlock',\r\n        'feedbackInline' : 'taoQtiItem/qtiItem/core/feedbacks/FeedbackInline',\r\n        'modalFeedback' : 'taoQtiItem/qtiItem/core/feedbacks/ModalFeedback',\r\n        'customInteraction' : 'taoQtiItem/qtiItem/core/interactions/CustomInteraction',\r\n        'infoControl' : 'taoQtiItem/qtiItem/core/PortableInfoControl',\r\n        'include' : 'taoQtiItem/qtiItem/core/Include',\r\n        'table' : 'taoQtiItem/qtiItem/core/Table',\r\n        'printedVariable' : 'taoQtiItem/qtiItem/core/PrintedVariable',\r\n        '_tooltip' : 'taoQtiItem/qtiItem/core/Tooltip'\r\n    };\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\r\n *\r\n */\r\n\r\n/**\r\n * Common basic util functions\r\n */\r\ndefine('taoQtiItem/qtiItem/helper/util',['lodash'], function(_){\r\n    'use strict';\r\n\r\n    var util = {\r\n\r\n        buildSerial : function buildSerial(prefix){\r\n            var id = prefix || '';\r\n            var chars = \"abcdefghijklmnopqrstuvwxyz0123456789\";\r\n            for(var i = 0; i < 22; i++){\r\n                id += chars.charAt(Math.floor(Math.random() * chars.length));\r\n            }\r\n            return id;\r\n        },\r\n\r\n        /**\r\n         * Generates an id for a Qti element (the generation is different from identifier)\r\n         * @param {Object} item - the element related item\r\n         * @param {String} prefix - identifier prefix\r\n         * @returns {String} the identifier\r\n         * @throws {TypeError} if there is no item\r\n         */\r\n        buildId : function buildId(item, prefix){\r\n            var id;\r\n            var usedIds;\r\n            var i = 1;\r\n            var suffix = '';\r\n            var exists = false;\r\n\r\n            if(!item){\r\n                throw new TypeError('A item is required to generate a unique identifier');\r\n            }\r\n\r\n            usedIds   = item.getUsedIds();\r\n\r\n            do{\r\n                exists = false;\r\n                id = prefix + suffix;\r\n                if(_.contains(usedIds, id)){\r\n                    exists = true;\r\n                    suffix = '_' + i;\r\n                    i++;\r\n                }\r\n            } while(exists);\r\n\r\n            return id;\r\n        },\r\n\r\n        /**\r\n         * Generates an identifier for a Qti element\r\n         * @param {Object} item - the element related item\r\n         * @param {String} prefix - identifier prefix\r\n         * @param {Boolean} [useSuffix = true] - add a \"_ + index\" to the identifier\r\n         * @returns {String} the identifier\r\n         * @throws {TypeError} if there is no item\r\n         */\r\n        buildIdentifier : function buildIdentifier(item, prefix, useSuffix){\r\n\r\n            var id;\r\n            var usedIds;\r\n            var suffix = '';\r\n            var i = 1;\r\n            var exists = false;\r\n\r\n            if(!item){\r\n                throw new TypeError('A item is required to generate a unique identifier');\r\n            }\r\n\r\n            if(!prefix){\r\n                throw new TypeError('Prefix is required to build an identifier');\r\n            }\r\n\r\n            usedIds   = item.getUsedIdentifiers();\r\n            useSuffix = _.isUndefined(useSuffix) ? true : useSuffix;\r\n\r\n            if(prefix){\r\n                prefix = prefix.replace(/_[0-9]+$/ig, '_') //detect incremental id of type choice_12, response_3, etc.\r\n                               .replace(/[^a-zA-Z0-9_]/ig, '_')\r\n                               .replace(/(_)+/ig, '_');\r\n                if(useSuffix){\r\n                    suffix = '_' + i;\r\n                }\r\n            }\r\n\r\n            do{\r\n                exists = false;\r\n                id = prefix + suffix;\r\n                if(usedIds[id]){\r\n                    exists = true;\r\n                    suffix = '_' + i;\r\n                    i++;\r\n                }\r\n            } while(exists);\r\n\r\n            return id;\r\n        },\r\n\r\n        findInCollection : function findInCollection(element, collectionNames, searchedSerial){\r\n\r\n            var found = null;\r\n\r\n            if(_.isString(collectionNames)){\r\n                collectionNames = [collectionNames];\r\n            }\r\n\r\n            if(_.isArray(collectionNames)){\r\n\r\n                _.each(collectionNames, function(collectionName){\r\n\r\n                    //get collection to search in (resolving case like interaction.choices.0\r\n                    var collection = element;\r\n                    _.each(collectionName.split('.'), function(nameToken){\r\n                        collection = collection[nameToken];\r\n                    });\r\n                    var elt = collection[searchedSerial];\r\n\r\n                    if(elt){\r\n                        found = {'parent' : element, 'element' : elt};\r\n                        return false;//break the each loop\r\n                    }\r\n\r\n                    //search inside each elements:\r\n                    _.each(collection, function(elt){\r\n\r\n                        if(_.isFunction(elt.find)){\r\n                            found = elt.find(searchedSerial);\r\n                            if(found){\r\n                                return false;//break the each loop\r\n                            }\r\n                        }\r\n\r\n                    });\r\n\r\n                    if(found){\r\n                        return false;//break the each loop\r\n                    }\r\n\r\n                });\r\n\r\n            }else{\r\n\r\n                throw new Error('invalid argument : collectionNames must be an array or a string');\r\n            }\r\n\r\n            return found;\r\n        },\r\n        addMarkupNamespace : function addMarkupNamespace(markup, ns){\r\n            if(ns) {\r\n                markup = markup.replace(/<(\\/)?([a-z:]+)(\\s?)([^><]*)>/g, function($0, $1, $2, $3, $4){\r\n                    if($2.indexOf(':')>0){\r\n                        return $0;\r\n                    }\r\n                    $1 = $1 || '';\r\n                    $3 = $3 || '';\r\n                    return '<'+ $1 + ns + ':'+$2+$3+$4+'>';\r\n                });\r\n                return markup;\r\n            }\r\n            return markup;\r\n\r\n        },\r\n        removeMarkupNamespaces : function removeMarkupNamespace(markup){\r\n            return markup.replace(/<(\\/)?(\\w*):([^>]*)>/g, '<$1$3>');\r\n        },\r\n        getMarkupUsedNamespaces : function getMarkupUsedNamespaces(markup){\r\n            var namespaces = [];\r\n            markup.replace(/<(\\/)?(\\w*):([^>]*)>/g, function(original, slash, ns, node){\r\n                namespaces.push(ns);\r\n                return '<'+slash+node+'>';\r\n            });\r\n            return _.uniq(namespaces);\r\n        }\r\n    };\r\n\r\n    return util;\r\n});\r\n\n","define('taoQtiItem/qtiItem/helper/rendererConfig',['lodash', 'jquery'], function(_, $){\r\n\r\n    var rendererConfigHelper = {};\r\n\r\n    rendererConfigHelper.getOptionsFromArguments = function(args){\r\n\r\n        var options = {\r\n            data : {},\r\n            placeholder : null,\r\n            subclass : '',\r\n            renderer : null\r\n        };\r\n        \r\n        _.each(args, function(arg){\r\n            if(arg){\r\n                if(arg.isRenderer){\r\n                    options.renderer = arg;\r\n                }else if(arg instanceof $ && arg.length){\r\n                    options.placeholder = arg;\r\n                }else if(_.isString(arg)){\r\n                    options.subclass = arg;\r\n                }else if(_.isPlainObject(arg)){\r\n                    options.data = arg;\r\n                }else{\r\n                    console.log('invalid arg', arg, args);\r\n                }\r\n            }\r\n        });\r\n        \r\n        return options;\r\n    };\r\n    \r\n    return rendererConfigHelper;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/Element',[\r\n    'jquery',\r\n    'lodash',\r\n    'class',\r\n    'core/logger',\r\n    'taoQtiItem/qtiItem/helper/util',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig'\r\n], function($, _, Class, loggerFactory, util, rendererConfig){\r\n    'use strict';\r\n\r\n    var _instances = {};\r\n\r\n    /**\r\n     * Create a logger\r\n     */\r\n    var logger = loggerFactory('taoQtiItem/qtiItem/core/Element');\r\n\r\n    var Element = Class.extend({\r\n        qtiClass : '',\r\n        serial : '',\r\n        rootElement : null,\r\n        init : function(serial, attributes){\r\n\r\n            //init own attributes\r\n            this.attributes = {};\r\n\r\n            //system properties, for item creator internal use only\r\n            this.metaData = {};\r\n\r\n            //init call in the format init(attributes)\r\n            if(typeof (serial) === 'object'){\r\n                attributes = serial;\r\n                serial = '';\r\n            }\r\n\r\n            if(!serial){\r\n                serial = util.buildSerial(this.qtiClass + '_');\r\n            }\r\n\r\n            if(serial && (typeof serial !== 'string' || !serial.match(/^[a-z_0-9]*$/i))){\r\n                throw 'invalid QTI serial : (' + (typeof serial) + ') ' + serial;\r\n            }\r\n\r\n            if(!_instances[serial]){\r\n                _instances[serial] = this;\r\n                this.serial = serial;\r\n                this.setAttributes(attributes || {});\r\n            }else{\r\n                throw 'a QTI Element with the same serial already exists ' + serial;\r\n            }\r\n\r\n            if(typeof this.initContainer === 'function'){\r\n                this.initContainer(arguments[2] || '');\r\n            }\r\n            if(typeof this.initObject === 'function'){\r\n                this.initObject();\r\n            }\r\n        },\r\n        is : function(qtiClass){\r\n            return (qtiClass === this.qtiClass);\r\n        },\r\n        placeholder : function(){\r\n            return '{{' + this.serial + '}}';\r\n        },\r\n        getSerial : function(){\r\n            return this.serial;\r\n        },\r\n        getUsedIdentifiers : function(){\r\n            var usedIds = {};\r\n            var elts = this.getComposingElements();\r\n            for(var i in elts){\r\n                var elt = elts[i];\r\n                var id = elt.attr('identifier');\r\n                if(id){\r\n                    //warning: simplistic implementation, allow only one unique identifier in the item no matter the element class/type\r\n                    usedIds[id] = elt;\r\n                }\r\n            }\r\n            return usedIds;\r\n        },\r\n\r\n        /**\r\n         * Get the ids in use. (id is different from identifier)\r\n         * @returns {Array} of the ids in use\r\n         */\r\n        getUsedIds : function getUsedIds(){\r\n            var usedIds = [];\r\n            _.forEach(this.getComposingElements(), function(elt){\r\n                var id = elt.attr('id');\r\n                if(id && !_.contains(usedIds, id)){\r\n                    usedIds.push(id);\r\n                }\r\n            });\r\n            return usedIds;\r\n        },\r\n\r\n        attr : function(name, value){\r\n            if(name){\r\n                if(value !== undefined){\r\n                    this.attributes[name] = value;\r\n                }else{\r\n                    if(typeof (name) === 'object'){\r\n                        for(var prop in name){\r\n                            this.attr(prop, name[prop]);\r\n                        }\r\n                    }else if(typeof (name) === 'string'){\r\n                        if(this.attributes[name] === undefined){\r\n                            return undefined;\r\n                        }else{\r\n                            return this.attributes[name];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return this;\r\n        },\r\n        data : function(name, value){\r\n            if(name){\r\n                if(value !== undefined){\r\n                    this.metaData[name] = value;\r\n                    $(document).trigger('metaChange.qti-widget', {element : this, key : name, value : value});\r\n                }else{\r\n                    if(typeof (name) === 'object'){\r\n                        for(var prop in name){\r\n                            this.data(prop, name[prop]);\r\n                        }\r\n                    }else if(typeof (name) === 'string'){\r\n                        if(this.metaData[name] === undefined){\r\n                            return undefined;\r\n                        }else{\r\n                            return this.metaData[name];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return this;\r\n        },\r\n        removeData : function(name){\r\n            delete this.metaData[name];\r\n            return this;\r\n        },\r\n        removeAttr : function(name){\r\n            return this.removeAttributes(name);\r\n        },\r\n        setAttributes : function(attributes){\r\n            if (!_.isPlainObject(attributes)) {\r\n                logger.warn('attributes should be a plain object');\r\n            }\r\n            this.attributes = attributes;\r\n            return this;\r\n        },\r\n        getAttributes : function(){\r\n            return _.clone(this.attributes);\r\n        },\r\n        removeAttributes : function(attrNames){\r\n            if(typeof (attrNames) === 'string'){\r\n                attrNames = [attrNames];\r\n            }\r\n            for(var i in attrNames){\r\n                delete this.attributes[attrNames[i]];\r\n            }\r\n            return this;\r\n        },\r\n        getComposingElements : function(){\r\n            var elts = {};\r\n            function append(element){\r\n                elts[element.getSerial()] = element;//pass individual object by ref, instead of the whole list(object)\r\n                elts = _.extend(elts, element.getComposingElements());\r\n            }\r\n            if(typeof this.initContainer === 'function'){\r\n                append(this.getBody());\r\n            }\r\n            if(typeof this.initObject === 'function'){\r\n                append(this.getObject());\r\n            }\r\n            _.each(this.metaData, function(v){\r\n                if(Element.isA(v, '_container')){\r\n                    append(v);\r\n                }else if(_.isArray(v)){\r\n                    _.each(v, function(v){\r\n                        if(Element.isA(v, '_container')){\r\n                            append(v);\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n            return elts;\r\n        },\r\n        getUsedClasses : function(){\r\n\r\n            var ret = [this.qtiClass],\r\n                composingElts = this.getComposingElements();\r\n\r\n            _.each(composingElts, function(elt){\r\n                ret.push(elt.qtiClass);\r\n            });\r\n\r\n            return _.uniq(ret);\r\n        },\r\n        find : function(serial){\r\n\r\n            var found = null;\r\n            var object,\r\n                body;\r\n\r\n            if(typeof this.initObject === 'function'){\r\n                object = this.getObject();\r\n                if(object.serial === serial){\r\n                    found = {'parent' : this, 'element' : object, 'location' : 'object'};\r\n                }\r\n            }\r\n\r\n            if(!found && typeof this.initContainer === 'function'){\r\n                body = this.getBody();\r\n                if (body.serial === serial) {\r\n                    found = {'parent' : this, 'element' : body, 'location' : 'body'};\r\n                } else {\r\n                    found = this.getBody().find(serial, this);\r\n                }\r\n            }\r\n\r\n            return found;\r\n        },\r\n        parent : function(){\r\n            var item = this.getRootElement();\r\n            if(item){\r\n                var found = item.find(this.getSerial());\r\n                if(found){\r\n                    return found.parent;\r\n                }\r\n            }\r\n            return null;\r\n        },\r\n        /**\r\n         * @deprecated - use setRootElement() instead\r\n         */\r\n        setRelatedItem : function(item) {\r\n            logger.warn('Deprecated use of setRelatedItem()');\r\n            this.setRootElement(item);\r\n        },\r\n        setRootElement : function(item){\r\n            var composingElts,\r\n                i;\r\n\r\n            if(Element.isA(item, 'assessmentItem')){\r\n                this.rootElement = item;\r\n                composingElts = this.getComposingElements();\r\n                for(i in composingElts){\r\n                    composingElts[i].setRootElement(item);\r\n                }\r\n            }\r\n\r\n        },\r\n        /**\r\n         * @deprecated - use getRootElement() instead\r\n         */\r\n        getRelatedItem : function(){\r\n            logger.warn('Deprecated use of getRelatedItem()');\r\n            return this.getRootElement();\r\n        },\r\n        getRootElement : function(){\r\n            var ret = null;\r\n            if(Element.isA(this.rootElement, 'assessmentItem')){\r\n                ret = this.rootElement;\r\n            }\r\n            return ret;\r\n        },\r\n        setRenderer : function(renderer){\r\n            if(renderer && renderer.isRenderer){\r\n                this.renderer = renderer;\r\n                var elts = this.getComposingElements();\r\n                for(var serial in elts){\r\n                    elts[serial].setRenderer(renderer);\r\n                }\r\n            }else{\r\n                throw 'invalid qti rendering engine';\r\n            }\r\n        },\r\n        getRenderer : function(){\r\n            return this.renderer;\r\n        },\r\n        /**\r\n         * Render the element. Arguments are all optional and can be given in any order.\r\n         * Argument parsing is based on argument type and is done by taoQtiItem/qtiItem/core/helpers/rendererConfig\r\n         * @param {Renderer} renderer - specify which renderer to use\r\n         * @param {jQuery} placeholder - DOM element that will be replaced by the rendered element\r\n         * @param {Object} data - template data for the rendering\r\n         * @param {String} subclass - subclass enables different behaviour of the same qti class in different contexts (eg. we could have different rendering for simpleChoice according to where it is being used: simpleChoice.orderInteraction, simpleChoice.choiceInteraction...)\r\n         * @returns {String} - the rendered element as an HTML string\r\n         */\r\n        render : function render(){\r\n            var args = rendererConfig.getOptionsFromArguments(arguments);\r\n            var _renderer = args.renderer || this.getRenderer();\r\n            var rendering;\r\n\r\n            var tplData = {},\r\n                defaultData = {\r\n                    'tag' : this.qtiClass,\r\n                    'serial' : this.serial,\r\n                    'attributes' : this.getAttributes()\r\n                };\r\n\r\n            if(!_renderer){\r\n                throw new Error('render: no renderer found for the element ' + this.qtiClass + ':' + this.serial);\r\n            }\r\n\r\n            if(typeof this.initContainer === 'function'){\r\n                //allow body to have a different renderer if it has its own renderer set\r\n                defaultData.body = this.getBody().render(args.renderer);\r\n            }\r\n            if(typeof this.initObject === 'function'){\r\n                defaultData.object = {\r\n                    attributes : this.object.getAttributes()\r\n                };\r\n                defaultData.object.attributes.data = _renderer.resolveUrl(this.object.attr('data'));\r\n            }\r\n\r\n            tplData = _.merge(defaultData, args.data || {});\r\n            tplData = _renderer.getData(this, tplData, args.subclass);\r\n            rendering = _renderer.renderTpl(this, tplData, args.subclass);\r\n            if(args.placeholder){\r\n                args.placeholder.replaceWith(rendering);\r\n            }\r\n\r\n            return rendering;\r\n        },\r\n        postRender : function(data, altClassName, renderer){\r\n\r\n            var postRenderers = [];\r\n            var _renderer = renderer || this.getRenderer();\r\n\r\n            if(typeof this.initContainer === 'function'){\r\n                //allow body to have a different renderer if it has its own renderer set\r\n                postRenderers = this.getBody().postRender(data, '', renderer);\r\n            }\r\n\r\n            if(_renderer){\r\n                postRenderers.push(_renderer.postRender(this, data, altClassName));\r\n            }else{\r\n                throw 'postRender: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\r\n            }\r\n\r\n            return _.compact(postRenderers);\r\n        },\r\n        getContainer : function($scope, subclass){\r\n            var renderer = this.getRenderer();\r\n            if(renderer){\r\n                return renderer.getContainer(this, $scope, subclass);\r\n            }else{\r\n                throw 'getContainer: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\r\n            }\r\n        },\r\n        toArray : function(){\r\n            var arr = {\r\n                serial : this.serial,\r\n                type : this.qtiClass,\r\n                attributes : this.getAttributes()\r\n            };\r\n\r\n            if(typeof this.initContainer === 'function'){\r\n                arr.body = this.getBody().toArray();\r\n            }\r\n            if(typeof this.initObject === 'function'){\r\n                arr.object = this.object.toArray();\r\n            }\r\n\r\n            return arr;\r\n        },\r\n        isEmpty : function(){\r\n            //tells whether the element should be considered empty or not, from the rendering point of view\r\n            return false;\r\n        },\r\n        addClass : function(className){\r\n            var clazz = this.attr('class') || '';\r\n            if(!_containClass(clazz, className)){\r\n                this.attr('class', clazz + (clazz.length ? ' ' : '') + className);\r\n            }\r\n        },\r\n        hasClass : function(className){\r\n            return _containClass(this.attr('class'), className);\r\n        },\r\n        removeClass : function(className){\r\n\r\n            var clazz = this.attr('class') || '';\r\n            if(clazz){\r\n\r\n                var regex = new RegExp('(?:^|\\\\s)' + className + '(?:\\\\s|$)');\r\n                clazz = clazz.replace(regex, ' ').trim();\r\n\r\n                if(clazz){\r\n                    this.attr('class', clazz);\r\n                }else{\r\n                    this.removeAttr('class');\r\n                }\r\n            }\r\n        },\r\n        /**\r\n         * Add or remove class. Setting the optional state will force addition/removal.\r\n         * State is here to keep the jQuery syntax\r\n         *\r\n         * @param {String} className\r\n         * @param {Boolean} [state]\r\n         */\r\n        toggleClass : function(className, state) {\r\n\r\n            if(typeof state === 'boolean') {\r\n                return state ? this.addClass(className) : this.removeClass(className);\r\n            }\r\n\r\n            if(this.hasClass(className)) {\r\n                return this.removeClass(className);\r\n            }\r\n            return this.addClass(className);\r\n        },\r\n        isset : function(){\r\n            return Element.issetElement(this.serial);\r\n        },\r\n        unset : function(){\r\n            return Element.unsetElement(this.serial);\r\n        }\r\n    });\r\n\r\n    var _containClass = function(allClassStr, className){\r\n        var regex = new RegExp('(?:^|\\\\s)' + className + '(?:\\\\s|$)', '');\r\n        return allClassStr && regex.test(allClassStr);\r\n    };\r\n\r\n    //helpers\r\n    Element.isA = function(qtiElement, qtiClass){\r\n        return (qtiElement instanceof Element && qtiElement.is(qtiClass));\r\n    };\r\n\r\n    Element.getElementBySerial = function(serial){\r\n        return _instances[serial];\r\n    };\r\n\r\n    Element.issetElement = function(serial){\r\n        return !!_instances[serial];\r\n    };\r\n\r\n    /**\r\n     * Unset a registered element from it's serial\r\n     * @param {String} serial - the element serial\r\n     * @returns {Boolean} true if unset\r\n     */\r\n    Element.unsetElement = function(serial){\r\n\r\n        var element = Element.getElementBySerial(serial);\r\n\r\n        if(element){\r\n\r\n            var composingElements = element.getComposingElements();\r\n            _.each(composingElements, function(elt){\r\n                delete _instances[elt.serial];\r\n            });\r\n            delete _instances[element.serial];\r\n\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    return Element;\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA\r\n */\r\n\r\n/**\r\n * XML namespace handling\r\n */\r\ndefine('taoQtiItem/qtiItem/helper/xmlNsHandler',[], function(){\r\n    'use strict';\r\n\r\n    /**\r\n     * Elements that need to be prefixed\r\n     *\r\n     * @see http://www.imsglobal.org/xsd/qti/qtiv2p2/imsqti_v2p2.xsd\r\n     * @type {string}\r\n     */\r\n    var prefixed = 'article|aside|bdi|figure|footer|header|nav|rb|rp|rt|rtc|ruby|section';\r\n\r\n\r\n    /**\r\n     * Find a possibly existing prefix\r\n     *\r\n     * @param namespaces\r\n     * @param html5Ns\r\n     * @returns {*}\r\n     */\r\n    function getPrefix(namespaces, html5Ns) {\r\n        var key;\r\n        for(key in namespaces) {\r\n            if(namespaces[key] === html5Ns) {\r\n                return key;\r\n            }\r\n        }\r\n        return 'qh5';\r\n    }\r\n\r\n    return {\r\n\r\n        /**\r\n         * Remove prefix to make sure elements are properly displayed\r\n         *\r\n         * @param body\r\n         */\r\n        stripNs : function stripNs(body) {\r\n            var pattern    = '([\\\\w]+)\\\\:(' + prefixed + ')';\r\n            var openRegEx  = new RegExp('(<' + pattern + ')', 'gi');\r\n            var closeRegEx = new RegExp('(<\\\\/' + pattern + '>)', 'gi');\r\n            return body.replace(openRegEx, '<$3').replace(closeRegEx, '</$3>');\r\n        },\r\n\r\n        /**\r\n         * Add a prefix to those elements that require one\r\n         *\r\n         * @param xml\r\n         * @param namespaces\r\n         * @returns {*}\r\n         */\r\n        restoreNs : function restoreNs(xml, namespaces) {\r\n            var xmlRe     = new RegExp('(<(' + prefixed + ')[^>]*>|<\\\\/(' + prefixed + ')>)', 'gi');\r\n            var tagRe     = new RegExp('((<)(' + prefixed + ')([^>]*)(>)|(<\\\\/)(' + prefixed + ')(>))', 'i');\r\n            var xmlMatch  = xml.match(xmlRe);\r\n            var imsXsd    = 'http://www.imsglobal.org/xsd';\r\n            var html5Ns   = imsXsd + '/imsqtiv2p2_html5_v1p0';\r\n            var prefix    = getPrefix(namespaces, html5Ns);\r\n            var prefixAtt = 'xmlns:' + prefix + '=\"' + html5Ns + '\"';\r\n            var i         = xmlMatch ? xmlMatch.length : 0;\r\n            var tagMatch;\r\n\r\n            if(!xmlMatch) {\r\n                return xml;\r\n            }\r\n\r\n            while(i--) {\r\n                tagMatch = xmlMatch[i].match(tagRe);\r\n                xml = xml.replace(xmlMatch[i],\r\n                    tagMatch[5]\r\n                        ? '<' + prefix + ':' + tagMatch[3] + tagMatch[4] + '>'\r\n                        : '</' + prefix + ':' + tagMatch[7] + '>'\r\n                );\r\n            }\r\n\r\n            // we found matches but no namespace has been set\r\n            if(xmlMatch.length && xml.indexOf(prefixAtt) === -1) {\r\n                xml = xml.replace('<assessmentItem', '<assessmentItem ' + prefixAtt);\r\n            }\r\n\r\n            // make sure the item is set to qti 2.2\r\n            xml = xml.replace('xmlns=\"' + imsXsd + '/imsqti_v2p1\"', 'xmlns=\"' + imsXsd + '/imsqti_v2p2\"');\r\n            xml = xml.replace(\r\n                'xsi:schemaLocation=\"' + imsXsd + '/imsqti_v2p1 imsqti_v2p1.xsd\"',\r\n                'xsi:schemaLocation=\"' + imsXsd + '/imsqti_v2p2 ' + imsXsd + '/qti/qtiv2p2/imsqti_v2p2.xsd\"'\r\n            );\r\n\r\n            return xml;\r\n        }\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\n//@todo : move this to the ../helper directory\r\ndefine('taoQtiItem/qtiItem/core/Loader',[\r\n    'lodash',\r\n    'class',\r\n    'taoQtiItem/qtiItem/core/qtiClasses',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiItem/helper/xmlNsHandler'\r\n], function(_, Class, qtiClasses, Element, xmlNsHandler){\r\n    'use strict';\r\n\r\n    var Loader = Class.extend({\r\n        init : function(item, classesLocation){\r\n\r\n            this.qti = {}; //loaded qti classes are store here\r\n            this.classesLocation = {};\r\n\r\n            this.item = item || null;//starts either from scratch or with an existing item object\r\n            this.setClassesLocation(classesLocation || qtiClasses);//load default location for qti classes model\r\n        },\r\n        setClassesLocation : function(qtiClasses){\r\n            _.extend(this.classesLocation, qtiClasses);\r\n            return this;\r\n        },\r\n        getRequiredClasses : function(data){\r\n            var ret = [], i;\r\n            for(i in data){\r\n                if(i === 'qtiClass' && data[i] !== '_container' && i !== 'rootElement'){//although a _container is a concrete class in TAO, it is not defined in QTI standard\r\n                    ret.push(data[i]);\r\n                }else if(typeof(data[i]) === 'object' && i !== 'responseRules'){    //responseRules should'nt be part of the parsing\r\n                    ret = _.union(ret, this.getRequiredClasses(data[i]));\r\n                }\r\n            }\r\n            return ret;\r\n        },\r\n        loadRequiredClasses : function(data, callback, reload){\r\n            var i;\r\n            var requiredClass,\r\n                requiredClasses = this.getRequiredClasses(data, reload), required = [];\r\n\r\n            for(i in requiredClasses){\r\n                requiredClass = requiredClasses[i];\r\n                if(this.classesLocation[requiredClass]){\r\n                    required.push(this.classesLocation[requiredClass]);\r\n                }else{\r\n                    throw new Error('missing qti class location declaration : ' + requiredClass);\r\n                }\r\n            }\r\n\r\n            var _this = this;\r\n            require(required, function(){\r\n                _.each(arguments, function(QtiClass){\r\n                    _this.qti[QtiClass.prototype.qtiClass] = QtiClass;\r\n                });\r\n                callback.call(_this, _this.qti);\r\n            });\r\n        },\r\n        getLoadedClasses : function(){\r\n            return _.keys(this.qti);\r\n        },\r\n        loadItemData : function(data, callback){\r\n\r\n            var _this = this;\r\n            _this.loadRequiredClasses(data, function(Qti){\r\n                var i;\r\n                if(typeof(data) === 'object' && data.qtiClass === 'assessmentItem'){\r\n\r\n                    //unload an item from it's serial (in case of a reload)\r\n                    if(data.serial){\r\n                        Element.unsetElement(data.serial);\r\n                    }\r\n\r\n                    _this.item = new Qti.assessmentItem(data.serial, data.attributes || {});\r\n                    _this.loadContainer(_this.item.getBody(), data.body);\r\n\r\n                    for(i in data.outcomes){\r\n                        var outcome = _this.buildOutcome(data.outcomes[i]);\r\n                        if(outcome){\r\n                            _this.item.addOutcomeDeclaration(outcome);\r\n                        }\r\n                    }\r\n                    for(i in data.feedbacks){\r\n                        var feedback = _this.buildElement(data.feedbacks[i]);\r\n                        if(feedback){\r\n                            _this.item.addModalFeedback(feedback);\r\n                        }\r\n                    }\r\n                    for(i in data.stylesheets){\r\n                        var stylesheet = _this.buildElement(data.stylesheets[i]);\r\n                        if(stylesheet){\r\n                            _this.item.addStylesheet(stylesheet);\r\n                        }\r\n                    }\r\n\r\n                    //important : build responses after all modal feedbacks and outcomes has been loaded, because the simple feedback rules need to reference them\r\n                    for(i in data.responses){\r\n                        var response = _this.buildResponse(data.responses[i]);\r\n                        if(response){\r\n                            _this.item.addResponseDeclaration(response);\r\n\r\n                            var feedbackRules = data.responses[i].feedbackRules;\r\n                            if(feedbackRules){\r\n                                _.forIn(feedbackRules, function(fbData, serial){\r\n                                    response.feedbackRules[serial] = _this.buildSimpleFeedbackRule(fbData, response);\r\n                                });\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if(data.responseProcessing){\r\n                        _this.item.setResponseProcessing(_this.buildResponseProcessing(data.responseProcessing));\r\n                    }\r\n                    _this.item.setNamespaces(data.namespaces);\r\n                    _this.item.setSchemaLocations(data.schemaLocations);\r\n                    _this.item.setApipAccessibility(data.apipAccessibility);\r\n                }\r\n\r\n                if(typeof(callback) === 'function'){\r\n                    callback.call(_this, _this.item);\r\n                }\r\n            });\r\n        },\r\n        loadAndBuildElement : function(data, callback){\r\n\r\n            var _this = this;\r\n\r\n            _this.loadRequiredClasses(data, function(Qti){\r\n\r\n                var element = _this.buildElement(data);\r\n\r\n                if(typeof(callback) === 'function'){\r\n                    callback.call(_this, element);\r\n                }\r\n            });\r\n        },\r\n        loadElement : function(element, data, callback){\r\n\r\n            var _this = this;\r\n            this.loadRequiredClasses(data, function(){\r\n                _this.loadElementData(element, data);\r\n                if(typeof(callback) === 'function'){\r\n                    callback.call(_this, element);\r\n                }\r\n            });\r\n        },\r\n        /**\r\n         * Load ALL given elements into existing loaded item\r\n         *\r\n         * @todo to be renamed to loadItemElements\r\n         * @param {object} data\r\n         * @param {function} callback\r\n         * @returns {undefined}\r\n         */\r\n        loadElements : function(data, callback){\r\n\r\n            var _this = this;\r\n\r\n            if(_this.item){\r\n\r\n                this.loadRequiredClasses(data, function(){\r\n\r\n                    var allElements = _this.item.getComposingElements();\r\n\r\n                    for(var i in data){\r\n                        var elementData = data[i];\r\n                        if(elementData && elementData.qtiClass && elementData.serial){\r\n                            //find and update element\r\n                            if(allElements[elementData.serial]){\r\n                                _this.loadElementData(allElements[elementData.serial], elementData);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if(typeof(callback) === 'function'){\r\n                        callback.call(_this, _this.item);\r\n                    }\r\n                });\r\n            }else{\r\n                throw 'QtiLoader : cannot load elements in empty item';\r\n            }\r\n\r\n        },\r\n        buildResponse : function(data){\r\n\r\n            var response = this.buildElement(data);\r\n\r\n            response.template = data.howMatch || null;\r\n            response.defaultValue = data.defaultValue || null;\r\n            response.correctResponse = data.correctResponses || null;\r\n\r\n            if(_.size(data.mapping)){\r\n                response.mapEntries = data.mapping;\r\n            }else if(_.size(data.areaMapping)){\r\n                response.mapEntries = data.areaMapping;\r\n            }else{\r\n                response.mapEntries = {};\r\n            }\r\n\r\n            response.mappingAttributes = data.mappingAttributes || {};\r\n\r\n            return response;\r\n        },\r\n        buildSimpleFeedbackRule : function(data, response){\r\n\r\n            var feedbackRule = this.buildElement(data);\r\n\r\n            feedbackRule.setCondition(response, data.condition, data.comparedValue || null);\r\n\r\n//            feedbackRule.comparedOutcome = this.item.responses[data.comparedOutcome] || null;\r\n            feedbackRule.feedbackOutcome = this.item.outcomes[data.feedbackOutcome] || null;\r\n            feedbackRule.feedbackThen = this.item.modalFeedbacks[data.feedbackThen] || null;\r\n            feedbackRule.feedbackElse = this.item.modalFeedbacks[data.feedbackElse] || null;\r\n\r\n            //associate the compared outcome to the feedbacks if applicable\r\n            var response = feedbackRule.comparedOutcome;\r\n            if(feedbackRule.feedbackThen){\r\n                feedbackRule.feedbackThen.data('relatedResponse', response);\r\n            }\r\n            if(feedbackRule.feedbackElse){\r\n                feedbackRule.feedbackElse.data('relatedResponse', response);\r\n            }\r\n\r\n            return feedbackRule;\r\n        },\r\n        buildOutcome : function(data){\r\n            var outcome = this.buildElement(data);\r\n            outcome.defaultValue = data.defaultValue || null;\r\n            return outcome;\r\n        },\r\n        buildResponseProcessing : function(data){\r\n            var rp = this.buildElement(data);\r\n            if(data && data.processingType){\r\n                if(data.processingType === 'custom'){\r\n                    rp.xml = data.data;\r\n                    rp.processingType = 'custom';\r\n                }else{\r\n                    rp.processingType = 'templateDriven';\r\n                }\r\n            }\r\n            return rp;\r\n        },\r\n        loadContainer : function(bodyObject, bodyData){\r\n            if(!Element.isA(bodyObject, '_container')){\r\n                throw 'bodyObject must be a QTI Container';\r\n            }\r\n\r\n            if(bodyData && typeof bodyData.body === 'string' && (typeof bodyData.elements === 'array' || typeof bodyData.elements === 'object')){\r\n                for(var serial in bodyData.elements){\r\n                    var eltData = bodyData.elements[serial];\r\n                    //check if class is loaded:\r\n                    var element = this.buildElement(eltData);\r\n                    if(element){\r\n                        bodyObject.setElement(element, bodyData.body);\r\n                    }\r\n                }\r\n                bodyObject.body(xmlNsHandler.stripNs(bodyData.body));\r\n            }else{\r\n                throw 'wrong bodydata format';\r\n            }\r\n        },\r\n        buildElement : function(elementData){\r\n            var elt = null;\r\n            if(elementData && elementData.qtiClass && elementData.serial){\r\n                var className = elementData.qtiClass;\r\n                if(this.qti[className]){\r\n                    elt = new this.qti[className](elementData.serial);\r\n                    this.loadElementData(elt, elementData);\r\n                }else{\r\n                    throw 'the qti element class does not exist: ' + className;\r\n                }\r\n            }else{\r\n                throw 'wrong elementData format';\r\n            }\r\n            return elt;\r\n        },\r\n        loadElementData : function(element, data){\r\n\r\n            //merge attributes when loading element data\r\n            var attributes = _.defaults(data.attributes || {}, element.attributes || {});\r\n            element.setAttributes(attributes);\r\n\r\n            if(element.body && data.body){\r\n                if(element.bdy){\r\n                    this.loadContainer(element.getBody(), data.body);\r\n                }\r\n            }\r\n\r\n            if(element.object && data.object){\r\n                if(element.object){\r\n                    this.loadObjectData(element.object, data.object);\r\n                }\r\n            }\r\n\r\n            if(Element.isA(element, 'interaction')){\r\n                this.loadInteractionData(element, data);\r\n            }else if(Element.isA(element, 'choice')){\r\n                this.loadChoiceData(element, data);\r\n            }else if(Element.isA(element, 'math')){\r\n                this.loadMathData(element, data);\r\n            }else if(Element.isA(element, 'infoControl')){\r\n                this.loadPicData(element, data);\r\n            }else if(Element.isA(element, '_tooltip')){\r\n                this.loadTooltipData(element, data);\r\n            }\r\n\r\n            return element;\r\n        },\r\n        loadInteractionData : function(interaction, data){\r\n            if(Element.isA(interaction, 'blockInteraction')){\r\n                if(data.prompt){\r\n                    this.loadContainer(interaction.prompt.getBody(), data.prompt);\r\n                }\r\n            }\r\n\r\n            this.buildInteractionChoices(interaction, data);\r\n\r\n            if(Element.isA(interaction, 'customInteraction')){\r\n                this.loadPciData(interaction, data);\r\n            }\r\n        },\r\n        buildInteractionChoices : function(interaction, data){\r\n\r\n            //note: Qti.ContainerInteraction (Qti.GapMatchInteraction and Qti.HottextInteraction) has already been parsed by builtElement(interacionData);\r\n            if(data.choices){\r\n                if(Element.isA(interaction, 'matchInteraction')){\r\n                    for(var set = 0; set < 2; set++){\r\n                        if(!data.choices[set]){\r\n                            throw 'missing match set #' + set;\r\n                        }\r\n                        var matchSet = data.choices[set];\r\n                        for(var serial in matchSet){\r\n                            var choice = this.buildElement(matchSet[serial]);\r\n                            if(choice){\r\n                                interaction.addChoice(choice, set);\r\n                            }\r\n                        }\r\n                    }\r\n                }else{\r\n                    for(var serial in data.choices){\r\n                        var choice = this.buildElement(data.choices[serial]);\r\n                        if(choice){\r\n                            interaction.addChoice(choice);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if(Element.isA(interaction, 'graphicGapMatchInteraction')){\r\n                    if(data.gapImgs){\r\n                        for(var serial in data.gapImgs){\r\n                            var gapImg = this.buildElement(data.gapImgs[serial]);\r\n                            if(gapImg){\r\n                                interaction.addGapImg(gapImg);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n\r\n        },\r\n        loadChoiceData : function(choice, data){\r\n            if(Element.isA(choice, 'textVariableChoice')){\r\n                choice.val(data.text);\r\n            }else if(Element.isA(choice, 'gapImg')){\r\n                //has already been taken care of in buildElement()\r\n            }else if(Element.isA(choice, 'gapText')){\r\n                // this ensure compatibility of Qti 2.1 items\r\n                if (! choice.body()) {\r\n                    choice.body(data.text);\r\n                }\r\n            }else if(Element.isA(choice, 'containerChoice')){\r\n                //has already been taken care of in buildElement()\r\n            }\r\n        },\r\n        loadObjectData : function(object, data){\r\n            object.setAttributes(data.attributes);\r\n            //@todo: manage object like a container\r\n            if(data._alt){\r\n                if(data._alt.qtiClass === 'object'){\r\n                    object._alt = Loader.buildElement(data._alt);\r\n                }else{\r\n                    object._alt = data._alt;\r\n                }\r\n            }\r\n        },\r\n        loadMathData : function(math, data){\r\n            math.ns = data.ns || {};\r\n            math.setMathML(data.mathML || '');\r\n            _.forIn(data.annotations || {}, function(value, encoding){\r\n                math.setAnnotation(encoding, value);\r\n            });\r\n        },\r\n        loadTooltipData : function(tooltip, data){\r\n            tooltip.content(data.content);\r\n        },\r\n        loadPciData : function(pci, data){\r\n            loadPortableCustomElementData(pci, data);\r\n        },\r\n        loadPicData : function(pic, data){\r\n            loadPortableCustomElementData(pic, data);\r\n        }\r\n    });\r\n\r\n    function loadPortableCustomElementData(portableElement, data){\r\n        portableElement.typeIdentifier = data.typeIdentifier;\r\n        portableElement.markup = data.markup;\r\n        portableElement.entryPoint = data.entryPoint;\r\n        portableElement.libraries = data.libraries;\r\n        portableElement.setNamespace('', data.xmlns);\r\n\r\n        loadPortableCustomElementProperties(portableElement, data.properties);\r\n    }\r\n\r\n    /**\r\n     * If a property is given as a serialized JSON object, parse it directly to a JS object\r\n     */\r\n    function loadPortableCustomElementProperties(portableElement, rawProperties) {\r\n        var properties = {};\r\n\r\n        _.forOwn(rawProperties, function(value, key) {\r\n            try {\r\n                properties[key] = JSON.parse(value);\r\n            } catch (e) {\r\n                properties[key] = value;\r\n            }\r\n        });\r\n        portableElement.properties = properties;\r\n    }\r\n\r\n    return Loader;\r\n});\r\n\n","/**\r\n * Common helper functions\r\n */\r\ndefine('taoQtiItem/qtiItem/helper/interactionHelper',['lodash', 'taoQtiItem/qtiItem/core/Element'], function(_, Element){\r\n    return {\r\n        convertChoices : function(choices, outputType){\r\n\r\n            var ret = [], _this = this;\r\n\r\n            _.each(choices, function(c){\r\n                if(Element.isA(c, 'choice')){\r\n                    switch(outputType){\r\n                        case 'serial':\r\n                            ret.push(c.getSerial());\r\n                            break;\r\n                        case 'identifier':\r\n                            ret.push(c.id());\r\n                            break;\r\n                        default:\r\n                            ret.push(c);\r\n                    }\r\n\r\n                }else if(_.isArray(c)){\r\n                    ret.push(_this.convertChoices(c, outputType));\r\n                }\r\n            });\r\n\r\n            return ret;\r\n        },\r\n        findChoices : function(interaction, choices, inputType){\r\n\r\n            var ret = [], _this = this;\r\n\r\n            _.each(choices, function(c){\r\n                var choice;\r\n                if(_.isString(c)){\r\n                    if(inputType === 'serial'){\r\n                        choice = interaction.getChoice(c);\r\n                        if(choice){\r\n                            ret.push(choice);\r\n                        }\r\n                    }else if(inputType === 'identifier'){\r\n                        choice = interaction.getChoiceByIdentifier(c);\r\n                        if(choice){\r\n                            ret.push(choice);\r\n                        }\r\n                    }else{\r\n                        ret.push(c);\r\n                    }\r\n                }else if(_.isArray(c)){\r\n                    ret.push(_this.findChoices(interaction, c, inputType));\r\n                }else{\r\n                    ret.push(c);\r\n                }\r\n            });\r\n\r\n            return ret;\r\n        },\r\n        shuffleChoices : function(choices){\r\n            var r = [], //returned array\r\n                f = {}, //fixed choices array\r\n                j = 0;\r\n\r\n            for(var i in choices){\r\n                if(Element.isA(choices[i], 'choice')){\r\n                    var choice = choices[i];\r\n                    if(choice.attr('fixed')){\r\n                        f[j] = choice;\r\n                    }\r\n                    r.push(choice);\r\n                    j++;\r\n                }else{\r\n                    throw 'invalid element in array: is not a qti choice';\r\n                }\r\n            }\r\n\r\n            for(var n = 0; n < r.length - 1; n++){\r\n                if(f[n]){\r\n                    continue;\r\n                }\r\n                var k = -1;\r\n                do{\r\n                    k = n + Math.floor(Math.random() * (r.length - n));\r\n                }while(f[k]);\r\n                var tmp = r[k];\r\n                r[k] = r[n];\r\n                r[n] = tmp;\r\n            }\r\n\r\n            return r;\r\n        },\r\n        serialToIdentifier : function(interaction, choiceSerial){\r\n            var choice = interaction.getChoice(choiceSerial);\r\n            if(choice){\r\n                return choice.id();\r\n            }else{\r\n                return '';\r\n            }\r\n        }\r\n    }\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * A factory to create a QTI renderer.\r\n *\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiRunner/core/Renderer',[\r\n    'lodash',\r\n    'jquery',\r\n    'handlebars',\r\n    'core/promise',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiItem/helper/interactionHelper',\r\n    'ui/themeLoader'\r\n], function(_, $, Handlebars, Promise, Element, interactionHelper, themeLoader){\r\n    'use strict';\r\n\r\n    var _isValidRenderer = function(renderer){\r\n\r\n        var valid = true;\r\n\r\n        if(typeof (renderer) !== 'object'){\r\n            return false;\r\n        }\r\n\r\n        var classCorrect = false;\r\n        if(renderer.qtiClass){\r\n            if(_.indexOf(_renderableClasses, renderer.qtiClass) >= 0){\r\n                classCorrect = true;\r\n            }else{\r\n                var pos = renderer.qtiClass.indexOf('.');\r\n                if(pos > 0){\r\n                    var qtiClass = renderer.qtiClass.slice(0, pos);\r\n                    var subClass = renderer.qtiClass.slice(pos + 1);\r\n                    if(_renderableSubclasses[qtiClass] && _.indexOf(_renderableSubclasses[qtiClass], subClass) >= 0){\r\n                        classCorrect = true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if(!classCorrect){\r\n            valid = false;\r\n            throw new Error('invalid qti class name in renderer declaration : ' + renderer.qtiClass);\r\n        }\r\n\r\n        if(!renderer.template){\r\n            valid = false;\r\n            throw new Error('missing template in renderer declaration : ' + renderer.qtiClass);\r\n        }\r\n\r\n        return valid;\r\n    };\r\n\r\n    var _renderableClasses = [\r\n        '_container',\r\n        'assessmentItem',\r\n        'stylesheet',\r\n        'responseDeclaration',\r\n        'outcomeDeclaration',\r\n        'responseProcessing',\r\n        '_simpleFeedbackRule',\r\n        '_tooltip',\r\n        'img',\r\n        'math',\r\n        'object',\r\n        'table',\r\n        'modalFeedback',\r\n        'rubricBlock',\r\n        'associateInteraction',\r\n        'choiceInteraction',\r\n        'extendedTextInteraction',\r\n        'gapMatchInteraction',\r\n        'graphicAssociateInteraction',\r\n        'graphicGapMatchInteraction',\r\n        'graphicOrderInteraction',\r\n        'hotspotInteraction',\r\n        'hottextInteraction',\r\n        'inlineChoiceInteraction',\r\n        'matchInteraction',\r\n        'mediaInteraction',\r\n        'orderInteraction',\r\n        'selectPointInteraction',\r\n        'sliderInteraction',\r\n        'textEntryInteraction',\r\n        'uploadInteraction',\r\n        'endAttemptInteraction',\r\n        'customInteraction',\r\n        'prompt',\r\n        'associableHotspot',\r\n        'gap',\r\n        'gapImg',\r\n        'gapText',\r\n        'hotspotChoice',\r\n        'hottext',\r\n        'inlineChoice',\r\n        'simpleAssociableChoice',\r\n        'simpleChoice',\r\n        'infoControl',\r\n        'include',\r\n        'printedVariable'\r\n    ];\r\n\r\n    /**\r\n     * The list of qti element dependencies. It is used internally to load dependent qti classes\r\n     */\r\n    var _dependencies = {\r\n        assessmentItem : ['stylesheet', '_container', 'prompt', 'modalFeedback'],\r\n        rubricBlock : ['_container'],\r\n        associateInteraction : ['simpleAssociableChoice'],\r\n        choiceInteraction : ['simpleChoice'],\r\n        gapMatchInteraction : ['gap', 'gapText'],\r\n        graphicAssociateInteraction : ['associableHotspot'],\r\n        graphicGapMatchInteraction : ['associableHotspot', 'gapImg'],\r\n        graphicOrderInteraction : ['hotspotChoice'],\r\n        hotspotInteraction : ['hotspotChoice'],\r\n        hottextInteraction : ['hottext'],\r\n        inlineChoiceInteraction : ['inlineChoice'],\r\n        matchInteraction : ['simpleAssociableChoice'],\r\n        orderInteraction : ['simpleChoice']\r\n    };\r\n\r\n    /**\r\n     * The list of supported qti subclasses.\r\n     */\r\n    var _renderableSubclasses = {\r\n        'simpleAssociableChoice' : ['associateInteraction', 'matchInteraction'],\r\n        'simpleChoice' : ['choiceInteraction', 'orderInteraction']\r\n    };\r\n\r\n    /**\r\n     * List of the default properties for the item\r\n     */\r\n    var _defaults = {\r\n        shuffleChoices : true\r\n    };\r\n\r\n    /**\r\n     * Get the location of the document, useful to define a baseUrl for the required context\r\n     * @returns {String}\r\n     */\r\n    function getDocumentBaseUrl(){\r\n        return window.location.protocol + '//' + window.location.host + window.location.pathname.replace(/([^\\/]*)$/, '');\r\n    }\r\n\r\n    /**\r\n     * The built Renderer class\r\n     * @constructor\r\n     * @param {Object} [options] - the renderer options\r\n     * @param {AssetManager} [options.assetManager] - The renderer needs an AssetManager to resolve URLs (see {@link taoItems/assets/manager})\r\n     * @param {Boolean} [options.shuffleChoices = true] - Does the renderer take care of the shuffling\r\n     * @param {Object} [options.decorators] - to set up rendering decorator\r\n     * @param {preRenderDecorator} [options.decorators.before] - to set up a pre decorator\r\n     * @param {postRenderDecorator} [options.decorators.after] - to set up a post decorator\r\n     */\r\n    var Renderer = function(options){\r\n\r\n        /**\r\n         * Store the registered renderer location\r\n         */\r\n        var _locations = {};\r\n\r\n        /**\r\n         * Store loaded renderers\r\n         */\r\n        var _renderers = {};\r\n\r\n        options = _.defaults(options || {}, _defaults);\r\n\r\n        this.isRenderer = true;\r\n\r\n        this.name = '';\r\n\r\n        //store shuffled choice here\r\n        this.shuffledChoices = [];\r\n\r\n        /**\r\n         * Get the actual renderer of the give qti class or subclass:\r\n         * e.g. simplceChoice, simpleChoice.choiceInteraction, simpleChoice.orderInteraction\r\n         */\r\n        var _getClassRenderer = function(qtiClass){\r\n            var ret = null;\r\n            if(_renderers[qtiClass]){\r\n                ret = _renderers[qtiClass];\r\n            }else{\r\n                var pos = qtiClass.indexOf('.');\r\n                if(pos > 0){\r\n                    qtiClass = qtiClass.slice(0, pos);\r\n                    if(_renderers[qtiClass]){\r\n                        ret = _renderers[qtiClass];\r\n                    }\r\n                }\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        /**\r\n         * Registers a QTI renderer class\r\n         * @param {String} qtiClass\r\n         * @param {Array} list\r\n         * @returns {Boolean} `true` if the class has been successfully registered\r\n         */\r\n        function registerRendererClass(qtiClass, list) {\r\n            var success = false;\r\n            if (_locations[qtiClass] === false) {\r\n                //mark this class as not renderable\r\n                _renderers[qtiClass] = false;\r\n                success = true;\r\n            } else if (_locations[qtiClass]) {\r\n                list.push(_locations[qtiClass]);\r\n                success = true;\r\n            }\r\n            return success;\r\n        }\r\n\r\n        /**\r\n         * Set the renderer options\r\n         * @param {String} key - the name of the option\r\n         * @param {*} value - the option vallue\r\n         * @returns {Renderer} for chaining\r\n         */\r\n        this.setOption = function(key, value){\r\n            if(typeof (key) === 'string'){\r\n                options[key] = value;\r\n            }\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Set the renderer options\r\n         * @param {Object} opts - the options\r\n         * @returns {Renderer} for chaining\r\n         */\r\n        this.setOptions = function(opts){\r\n            options = _.extend(options, opts);\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Get the renderer option\r\n         * @param {String} key - the name of the option\r\n         * @returns {*|null} the option vallue\r\n         */\r\n        this.getOption = function(key){\r\n            if(typeof (key) === 'string' && options[key]){\r\n                return options[key];\r\n            }\r\n            return null;\r\n        };\r\n\r\n        this.getCustomMessage = function getCustomMessage(elementName, messageKey){\r\n            var messages = this.getOption('messages');\r\n            if(messages &&\r\n                elementName &&\r\n                messages[elementName] &&\r\n                _.isString(messages[elementName][messageKey])){\r\n                //currently not translatable but potentially could be if the need raises\r\n                return Handlebars.compile(messages[elementName][messageKey]);\r\n            }else{\r\n                return null;\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Get the bound assetManager\r\n         * @returns {AssetManager} the assetManager\r\n         */\r\n        this.getAssetManager = function getAssetManager(){\r\n            return options.assetManager;\r\n        };\r\n\r\n        /**\r\n         * Get the bound theme loader\r\n         * @returns {Object} the themeLoader\r\n         */\r\n        this.getThemeLoader = function getThemeLoader(){\r\n            return this.themeLoader;\r\n        };\r\n\r\n\r\n        /**\r\n         * Renders the template\r\n         * @param {Object} element - the QTI model element\r\n         * @param {Object} data - the data to give to the template\r\n         * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\r\n         * @returns {String} the template results\r\n         * @throws {Error} if the renderer is not set or has no template bound\r\n         */\r\n        this.renderTpl = function(element, data, qtiSubclass){\r\n\r\n            var res;\r\n            var ret        = '';\r\n            var tplFound   = false;\r\n            var qtiClass   = qtiSubclass || element.qtiClass;\r\n            var renderer   = _getClassRenderer(qtiClass);\r\n            var decorators = this.getOption('decorators');\r\n\r\n            if(!renderer || !_.isFunction(renderer.template)){\r\n                throw new Error('no renderer template loaded under the class name : ' + qtiClass);\r\n            }\r\n\r\n            //pre rendering decoration\r\n            if(_.isObject(decorators) && _.isFunction(decorators.before)){\r\n\r\n                /**\r\n                 * @callback preRenderDecoractor\r\n                 * @param {Object} element - the QTI model element\r\n                 * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\r\n                 * @returns {String} the decorator result\r\n                 */\r\n                res = decorators.before(element, qtiSubclass);\r\n                if(_.isString(res)){\r\n                    ret += res;\r\n                }\r\n            }\r\n\r\n            //render the template\r\n            ret += renderer.template(data);\r\n\r\n\r\n            //post rendering decoration\r\n            if(_.isObject(decorators) && _.isFunction(decorators.after)){\r\n\r\n                /**\r\n                 * @callback postRenderDecoractor\r\n                 * @param {Object} element - the QTI model element\r\n                 * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\r\n                 * @returns {String} the decorator result\r\n                 */\r\n                res = decorators.after(element, qtiSubclass);\r\n                if(_.isString(res)){\r\n                    ret += res;\r\n                }\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        this.getData = function(element, data, qtiSubclass){\r\n\r\n            var ret = data,\r\n                qtiClass = qtiSubclass || element.qtiClass,\r\n                renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(typeof (renderer.getData) === 'function'){\r\n                    ret = renderer.getData.call(this, element, data);\r\n                }\r\n            }\r\n\r\n            return ret;\r\n        };\r\n\r\n        this.renderDirect = function(tpl, data){\r\n            return Handlebars.compile(tpl)(data);\r\n        };\r\n\r\n        this.getContainer = function(qtiElement, $scope, qtiSubclass){\r\n\r\n            var ret = null,\r\n                qtiClass = qtiSubclass || qtiElement.qtiClass,\r\n                renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                ret = renderer.getContainer(qtiElement, $scope);\r\n            }else{\r\n                throw 'no renderer found for the class : ' + qtiElement.qtiClass;\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        this.postRender = function(qtiElement, data, qtiSubclass){\r\n\r\n            var qtiClass = qtiSubclass || qtiElement.qtiClass;\r\n            var renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer && typeof (renderer.render) === 'function') {\r\n                return renderer.render.call(this, qtiElement, data);\r\n            }\r\n        };\r\n\r\n        this.setResponse = function(qtiInteraction, response, qtiSubclass){\r\n\r\n            var ret = false,\r\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\r\n                renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(typeof (renderer.setResponse) === 'function'){\r\n                    ret = renderer.setResponse.call(this, qtiInteraction, response);\r\n                    var $container = renderer.getContainer.call(this, qtiInteraction);\r\n                    if($container instanceof $ && $container.length){\r\n                        $container.trigger('responseSet', [qtiInteraction, response]);\r\n                    }\r\n                }\r\n            }else{\r\n                throw 'no renderer registered under the name : ' + qtiClass;\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        this.getResponse = function(qtiInteraction, qtiSubclass){\r\n\r\n            var ret = false,\r\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\r\n                renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(typeof (renderer.getResponse) === 'function'){\r\n                    ret = renderer.getResponse.call(this, qtiInteraction);\r\n                }\r\n            }else{\r\n                throw 'no renderer registered under the name : ' + qtiClass;\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        this.resetResponse = function(qtiInteraction, qtiSubclass){\r\n\r\n            var ret = false,\r\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\r\n                renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(typeof (renderer.resetResponse) === 'function'){\r\n                    ret = renderer.resetResponse.call(this, qtiInteraction);\r\n                }\r\n            }else{\r\n                throw 'no renderer registered under the name : ' + qtiClass;\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        /**\r\n         * Retrieve the state of the interaction.\r\n         * If the renderer has no state management, it falls back to the response management.\r\n         *\r\n         * @param {Object} qtiInteraction - the interaction\r\n         * @param {String} [qtiSubClass] - (not sure of the type and how it is used - Sam ? )\r\n         * @returns {Object} the interaction's state\r\n         *\r\n         * @throws {Error} if no renderer is registered\r\n         */\r\n        this.getState = function(qtiInteraction, qtiSubclass){\r\n\r\n            var ret = false;\r\n            var qtiClass = qtiSubclass || qtiInteraction.qtiClass;\r\n            var renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(_.isFunction(renderer.getState)){\r\n                    ret = renderer.getState.call(this, qtiInteraction);\r\n                } else {\r\n                    ret = renderer.getResponse.call(this, qtiInteraction);\r\n                }\r\n            }else{\r\n                throw 'no renderer registered under the name : ' + qtiClass;\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        /**\r\n         * Retrieve the state of the interaction.\r\n         * If the renderer has no state management, it falls back to the response management.\r\n         *\r\n         * @param {Object} qtiInteraction - the interaction\r\n         * @param {Object} state - the interaction's state\r\n         * @param {String} [qtiSubClass] - (not sure of the type and how it is used - Sam ? )\r\n         *\r\n         * @throws {Error} if no renderer is found\r\n         */\r\n        this.setState =  function(qtiInteraction, state, qtiSubclass){\r\n\r\n            var qtiClass = qtiSubclass || qtiInteraction.qtiClass;\r\n            var renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(_.isFunction(renderer.setState)){\r\n                    renderer.setState.call(this, qtiInteraction, state);\r\n                } else {\r\n                    renderer.resetResponse.call(this, qtiInteraction);\r\n                    renderer.setResponse.call(this, qtiInteraction, state);\r\n                }\r\n            }else{\r\n                throw 'no renderer registered under the name : ' + qtiClass;\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Calls the renderer destroy.\r\n         * Ask the renderer to run destroy if exists.\r\n         *\r\n         * @throws {Error} if no renderer is found\r\n         */\r\n        this.destroy = function(qtiInteraction, qtiSubclass){\r\n\r\n            var ret = false,\r\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\r\n                renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(_.isFunction(renderer.destroy)){\r\n                    ret = renderer.destroy.call(this, qtiInteraction);\r\n                }\r\n            }else{\r\n                throw 'no renderer registered under the name : ' + qtiClass;\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        this.getLoadedRenderers = function(){\r\n            return _renderers;\r\n        };\r\n\r\n        this.register = function(renderersLocations){\r\n            _.extend(_locations, renderersLocations);\r\n        };\r\n\r\n        this.load = function(callback, requiredClasses){\r\n            var self = this;\r\n            var required = [];\r\n\r\n            if(options.themes){\r\n\r\n                //resolve themes paths\r\n                options.themes.base = this.resolveUrl(options.themes.base);\r\n                _.forEach(options.themes.available, function(theme, index){\r\n                    options.themes.available[index].path = self.resolveUrl(theme.path);\r\n                });\r\n                this.themeLoader = themeLoader(options.themes).load(options.preload);\r\n            }\r\n\r\n            if(requiredClasses){\r\n                if(_.isArray(requiredClasses)){\r\n\r\n                    //exclude abstract classes\r\n                    requiredClasses = _.intersection(requiredClasses, _renderableClasses);\r\n\r\n                    //add dependencies\r\n                    _.each(requiredClasses, function(reqClass){\r\n                        var deps = _dependencies[reqClass];\r\n                        if(deps){\r\n                            requiredClasses = _.union(requiredClasses, deps);\r\n                        }\r\n                    });\r\n\r\n                    _.forEach(requiredClasses, function(qtiClass){\r\n                        var requiredSubClasses;\r\n                        if(_renderableSubclasses[qtiClass]){\r\n                            requiredSubClasses = _.intersection(requiredClasses, _renderableSubclasses[qtiClass]);\r\n                            _.each(requiredSubClasses, function(subclass){\r\n                                if (!registerRendererClass(qtiClass + '.' + subclass, required) && !registerRendererClass(qtiClass, required)) {\r\n                                    throw new Error(self.name + ' : missing qti class location declaration: ' + qtiClass + ', subclass: ' + subclass);\r\n                                }\r\n                            });\r\n                        } else {\r\n                            if (!registerRendererClass(qtiClass, required)) {\r\n                                throw new Error(self.name + ' : missing qti class location declaration: ' + qtiClass);\r\n                            }\r\n                        }\r\n                    });\r\n                } else {\r\n                    throw new Error('invalid argument type: expected array for arg \"requireClasses\"');\r\n                }\r\n\r\n            }else{\r\n                required = _.values(_locations);\r\n            }\r\n\r\n            require(required, function(){\r\n\r\n                _.each(arguments, function(clazz){\r\n                    if(_isValidRenderer(clazz)){\r\n                        _renderers[clazz.qtiClass] = clazz;\r\n                    }\r\n                });\r\n\r\n                if(typeof (callback) === 'function'){\r\n                    callback.call(self, _renderers);\r\n                }\r\n            });\r\n\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Unload the renderer\r\n         */\r\n        this.unload = function unload(){\r\n            if(this.themeLoader){\r\n                themeLoader(options.themes).unload();\r\n            }\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Define the shuffling manually\r\n         *\r\n         * @param {Object} interaction - the interaction\r\n         * @param {Array} choices - the shuffled choices\r\n         * @param {String} identificationType -\r\n         */\r\n        this.setShuffledChoices = function(interaction, choices, identificationType){\r\n            if(Element.isA(interaction, 'interaction')){\r\n                this.shuffledChoices[interaction.getSerial()] = _.pluck(interactionHelper.findChoices(interaction, choices, identificationType), 'serial');\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Get the choices shuffled for this interaction.\r\n         *\r\n         * @param {Object} interaction - the interaction\r\n         * @param {Boolean} reshuffle - by default choices are shuffled only once and store, but if true you can force shuffling again\r\n         * @param {String} returnedType - the choice type\r\n         * @returns {Array} the choices\r\n         */\r\n        this.getShuffledChoices = function(interaction, reshuffle, returnedType){\r\n            var choices = [];\r\n            var shuffled = [];\r\n            var serial, i;\r\n\r\n            if(Element.isA(interaction, 'interaction')){\r\n                serial = interaction.getSerial();\r\n\r\n                //1st time, we shuffle (or asked to force shuffling)\r\n                if(!this.shuffledChoices[serial] || reshuffle){\r\n                    if(Element.isA(interaction, 'matchInteraction')){\r\n                        this.shuffledChoices[serial] = [];\r\n                        for(i = 0; i < 2; i++){\r\n                            choices[i] = interactionHelper.shuffleChoices(interaction.getChoices(i));\r\n                            this.shuffledChoices[serial][i] = _.pluck(choices[i], 'serial');\r\n                        }\r\n                    } else {\r\n                        choices = interactionHelper.shuffleChoices(interaction.getChoices());\r\n                        this.shuffledChoices[serial] = _.pluck(choices, 'serial');\r\n                    }\r\n\r\n                //otherwise get the choices from the serials\r\n                } else {\r\n                    if(Element.isA(interaction, 'matchInteraction')){\r\n                        _.forEach(choices, function(choice, index){\r\n                            if(index < 2){\r\n                                _.forEach(this.shuffledChoices[serial][i], function(choiceSerial){\r\n                                    choice.push(interaction.getChoice(choiceSerial));\r\n                                });\r\n                            }\r\n                        });\r\n                    } else {\r\n                        _.forEach(this.shuffledChoices[serial], function(choiceSerial){\r\n                            choices.push(interaction.getChoice(choiceSerial));\r\n                        });\r\n                    }\r\n                }\r\n\r\n                //do some type convertion\r\n                if(returnedType === 'serial' || returnedType === 'identifier'){\r\n                    return interactionHelper.convertChoices(choices, returnedType);\r\n                }\r\n\r\n                //pass value only, not ref\r\n                return _.clone(choices);\r\n            }\r\n\r\n            return [];\r\n        };\r\n\r\n        this.getRenderers = function(){\r\n            return _renderers;\r\n        };\r\n\r\n        this.getLocations = function(){\r\n            return _locations;\r\n        };\r\n\r\n        /**\r\n         * Resolve URLs using the defined assetManager's strategies\r\n         * @param {String} url - the URL to resolve\r\n         * @returns {String} the resolved URL\r\n         */\r\n        this.resolveUrl = function resolveUrl(url){\r\n            if(!options.assetManager){\r\n                return url;\r\n            }\r\n            if(typeof url === 'string' && url.length > 0){\r\n                return options.assetManager.resolve(url);\r\n            }\r\n        };\r\n\r\n        /**\r\n         * @deprecated in favor of resolveUrl\r\n         */\r\n        this.getAbsoluteUrl = function(relUrl){\r\n\r\n            //let until method is removed\r\n            console.warn('DEPRECATED used getAbsoluteUrl with ', arguments);\r\n\r\n            //allow relative url output only if explicitely said so\r\n            if(this.getOption('userRelativeUrl')){\r\n                return relUrl.replace(/^\\.?\\//, '');\r\n            }\r\n\r\n            if(/^http(s)?:\\/\\//i.test(relUrl) || /^data:[^\\/]+\\/[^;]+(;charset=[\\w]+)?;base64,/.test(relUrl)){\r\n                //already absolute or base64 encoded\r\n                return relUrl;\r\n            }else{\r\n\r\n                var absUrl = '';\r\n                var runtimeLocations = this.getOption('runtimeLocations');\r\n\r\n                if(runtimeLocations && _.size(runtimeLocations)){\r\n                    _.forIn(runtimeLocations, function(runtimeLocation, typeIdentifier){\r\n                        if(relUrl.indexOf(typeIdentifier) === 0){\r\n                            absUrl = relUrl.replace(typeIdentifier, runtimeLocation);\r\n                            return false;//break\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if(absUrl){\r\n                    return absUrl;\r\n                }else{\r\n                    var baseUrl = this.getOption('baseUrl') || getDocumentBaseUrl();\r\n                    return baseUrl + relUrl;\r\n                }\r\n\r\n            }\r\n        };\r\n\r\n        this.setAreaBroker = function setAreaBroker(areaBroker) {\r\n            this._areaBroker = areaBroker;\r\n        };\r\n\r\n        this.getAreaBroker = function getAreaBroker() {\r\n            if (this._areaBroker) {\r\n                return this._areaBroker;\r\n            }\r\n        };\r\n\r\n        this.getItemCreator = function getItemCreator() {\r\n            return this.getOption('itemCreator');\r\n        };\r\n    };\r\n\r\n    /**\r\n     * Expose the renderer's factory\r\n     * @exports taoQtiItem/qtiRunner/core/Renderer\r\n     */\r\n    return {\r\n\r\n        /**\r\n         * Creates a new Renderer by extending the Renderer's prototype\r\n         * @param {Object} renderersLocations -\r\n         * @param {String} [name] - the new renderer name\r\n         * @param {Object} [defaultOptions] - the renderer options\r\n         */\r\n        build : function(renderersLocations, name, defaultOptions){\r\n            var NewRenderer = function(){\r\n                var options = _.isPlainObject(arguments[0]) ? arguments[0] : {};\r\n\r\n                Renderer.apply(this);\r\n\r\n                this.register(renderersLocations);\r\n                this.name = name || '';\r\n                this.setOptions(_.defaults(options, defaultOptions || {}));\r\n            };\r\n            NewRenderer.prototype = Renderer.prototype;\r\n            return NewRenderer;\r\n        }\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\n/**\r\n * @author Jean-Sbastien Conan <jean-sebastien.conan@vesperiagroup.com>\r\n */\r\ndefine('taoQtiItem/runner/provider/manager/picManager',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/core/Element'\r\n], function ($, _, Element) {\r\n    'use strict';\r\n\r\n    /**\r\n     * The template of a PicManager instance\r\n     * @type {picManager}\r\n     */\r\n    var picManager = {\r\n        /**\r\n         * Creates a manager for a particular PIC\r\n         *\r\n         * @param {Object} pic\r\n         * @param {QtiItem} item\r\n         * @returns {picManager}\r\n         */\r\n        init : function init(pic, item) {\r\n            if (Element.isA(pic, 'infoControl')) {\r\n                this._pic = pic;\r\n            }\r\n\r\n            if (Element.isA(item, 'assessmentItem')) {\r\n                this._item = item;\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Gets the managed PIC\r\n         *\r\n         * @returns {Object} the descriptor of the PIC\r\n         */\r\n        getPic : function getPic() {\r\n            return this._pic;\r\n        },\r\n\r\n        /**\r\n         * Gets the related Item\r\n         *\r\n         * @returns {QtiItem} the Item\r\n         */\r\n        getItem : function getItem() {\r\n            return this._item;\r\n        },\r\n\r\n        /**\r\n         * Gets the PIC serial\r\n         * @returns {String}\r\n         */\r\n        getSerial : function getSerial() {\r\n            return this._pic && this._pic.serial;\r\n        },\r\n\r\n        /**\r\n         * Gets the PIC type identifier\r\n         * @returns {String}\r\n         */\r\n        getTypeIdentifier : function getTypeIdentifier() {\r\n            return this._pic && this._pic.typeIdentifier;\r\n        },\r\n\r\n        /**\r\n         * Gets the underlying DOM element of the managed PIC\r\n         * @returns {{pic: (jQuery), tool: (jQuery), button: (jQuery), broken: (Boolean))}|*} An object providing the underlying DOM elements of the PIC and its tool\r\n         */\r\n        getDom : function getDom() {\r\n            if (!this._dom) {\r\n                var serial = this.getSerial();\r\n                var pic, tool;\r\n\r\n                if (serial) {\r\n                    pic = $('[data-serial=\"' + serial + '\"]');\r\n                    if (pic.length) {\r\n                        tool = $('[data-pic-serial=\"' + serial + '\"]');\r\n\r\n                        if (!tool.length) {\r\n                            tool = pic.children().first();\r\n                        }\r\n\r\n                        this._dom = {\r\n                            pic : pic,\r\n                            tool : tool,\r\n                            button : tool.find('.sts-button'),\r\n                            broken : pic.is(':empty') // tells if the tool has been moved outside of the PIC\r\n                        };\r\n                    }\r\n                }\r\n            }\r\n\r\n            return this._dom;\r\n        },\r\n\r\n        /**\r\n         * Enables the PIC.\r\n         * @fires enable\r\n         * @returns {picManager}\r\n         */\r\n        enable : function enable() {\r\n            // @todo: find a better solution for disabling/enabling a PIC\r\n            var dom = this.getDom();\r\n            if (dom) {\r\n                // just remove the disabled state and destroy the disable mask\r\n                dom.button.removeClass('disabled');\r\n                dom.tool.find('.sts-button-disable-mask').remove();\r\n\r\n                this.disabled = false;\r\n                this.trigger('enable');\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Disables the PIC\r\n         * @fires disable\r\n         * @returns {picManager}\r\n         */\r\n        disable : function disable() {\r\n            // @todo: find a better solution for disabling/enabling a PIC\r\n            var dom = this.getDom();\r\n            var button;\r\n            if (dom) {\r\n                // set a disabled state by adding a CSS class, then mask the button with a top-level element\r\n                button = dom.button.addClass('disabled');\r\n\r\n                $('<div class=\"sts-button-disable-mask\" style=\"position:absolute;z-index:10000000000000\"></div>')\r\n                    .appendTo(dom.tool)\r\n                    .offset(button.offset())\r\n                    .width(button.outerWidth())\r\n                    .height(button.outerHeight());\r\n\r\n                // also hide any sub component\r\n                dom.tool.find('.sts-container, .sts-menu-container').addClass('sts-hidden-container');\r\n\r\n                this.disabled = true;\r\n                this.trigger('disable');\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Shows the PIC\r\n         * @fires show\r\n         * @returns {picManager}\r\n         */\r\n        show : function show() {\r\n            var dom = this.getDom();\r\n            if (dom) {\r\n                dom.tool.show();\r\n\r\n                this.trigger('show');\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Hides the PIC\r\n         * @fires hide\r\n         * @returns {picManager}\r\n         */\r\n        hide : function hide() {\r\n            var dom = this.getDom();\r\n            if (dom) {\r\n                dom.tool.hide();\r\n\r\n                this.trigger('hide');\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Triggers an event on the underlying DOM element\r\n         * @param {String} eventName\r\n         * @returns {picManager}\r\n         */\r\n        trigger : function trigger(eventName) {\r\n            var dom = this.getDom();\r\n            var args = _.rest(arguments, 1);\r\n\r\n            args.unshift(this);\r\n\r\n            if (dom) {\r\n                // trigger the event, if the tool has been moved outside of the PIC, trigger also the event on the PIC\r\n                dom.tool.trigger(eventName, args);\r\n                if (dom.broken) {\r\n                    dom.pic.trigger(eventName, args);\r\n                }\r\n            }\r\n\r\n            return this;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * The template of a PicManagerCollection instance\r\n     * @type {picManagerCollection}\r\n     */\r\n    var picManagerCollection = {\r\n        /**\r\n         * Creates the collection of PIC from an Item\r\n         *\r\n         * @param {QtiItem} item\r\n         * @returns {picManagerCollection}\r\n         */\r\n        init : function init(item) {\r\n            if (Element.isA(item, 'assessmentItem')) {\r\n                this._item = item;\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Gets the list of PIC managers for the PIC provided by the running item.\r\n         *\r\n         * @param {Boolean} [force] Force a list rebuild\r\n         * @returns {Array} Returns the list of managers for the provided PIC\r\n         */\r\n        getList : function getList(force) {\r\n            var self = this;\r\n\r\n            // build the list if empty\r\n            if (force || !self._list) {\r\n                self._map = {};\r\n                self._list = [];\r\n                if (self._item) {\r\n                    _.forEach(self._item.getElements(), function(element) {\r\n                        var manager;\r\n\r\n                        if (Element.isA(element, 'infoControl')) {\r\n                            manager = managerFactory(element, self._item);\r\n                            self._list.push(manager);\r\n                            self._map[element.serial] = manager;\r\n                            self._map[element.typeIdentifier] = manager;\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            return this._list;\r\n        },\r\n\r\n        /**\r\n         * Gets the manager of the first PIC matching the identifier from the list provided by the running item.\r\n         *\r\n         * @param {String} picId The PIC typeIdentifier or serial\r\n         * @returns {Object} The manager of the PIC\r\n         */\r\n        getPic : function getPic(picId) {\r\n            this.getList();\r\n            return this._map[picId];\r\n        },\r\n\r\n        /**\r\n         * Executes an action on a particular PIC from the running item.\r\n         * @param {String} picId The PIC typeIdentifier or serial\r\n         * @param {String} action The name of the action to call\r\n         * @returns {*} Returns the action result\r\n         */\r\n        execute : function execute(picId, action) {\r\n            var pic = this.getPic(picId);\r\n            if (pic && pic[action]) {\r\n                return pic[action].apply(pic, _.rest(arguments, 2));\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Executes an action on each PIC provided by the running item.\r\n         * @param {String} action The name of the action to call\r\n         * @param {Function} [filter] An optional filter to reduce the list\r\n         * @returns {picManagerCollection}\r\n         */\r\n        executeAll : function executeAll(action, filter) {\r\n            var args = _.rest(arguments, 2);\r\n            var cb;\r\n\r\n            if (typeof filter === 'function') {\r\n                cb = function(pic) {\r\n                    if (filter.call(pic, pic) && pic[action]) {\r\n                        pic[action].apply(pic, args);\r\n                    }\r\n                };\r\n            } else {\r\n                cb = function(pic) {\r\n                    if (pic[action]) {\r\n                        pic[action].apply(pic, args);\r\n                    }\r\n                };\r\n            }\r\n\r\n            return this.each(cb);\r\n        },\r\n\r\n        /**\r\n         * Calls a callback function on each listed PIC from the running item.\r\n         * @param {Function} cb The callback function to apply on each listed PIC\r\n         * @returns {picManagerCollection}\r\n         */\r\n        each : function each(cb) {\r\n            _.forEach(this.getList(), cb);\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Enables a PIC provided by the running item.\r\n         *\r\n         * @param {String} picId The PIC typeIdentifier or serial\r\n         * @returns {picManagerCollection}\r\n         */\r\n        enablePic : function enablePic(picId) {\r\n            this.execute(picId, 'enable');\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Disables a PIC provided by the running item.\r\n         *\r\n         * @param {String} picId The PIC typeIdentifier or serial\r\n         * @returns {picManagerCollection}\r\n         */\r\n        disablePic : function disablePic(picId) {\r\n            this.execute(picId, 'disable');\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Shows a PIC provided by the running item.\r\n         *\r\n         * @param {String} picId The PIC typeIdentifier or serial\r\n         * @returns {picManagerCollection}\r\n         */\r\n        showPic : function showPic(picId) {\r\n            this.execute(picId, 'show');\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Hides a PIC provided by the running item.\r\n         *\r\n         * @param {String} picId The PIC typeIdentifier or serial\r\n         * @returns {picManagerCollection}\r\n         */\r\n        hidePic : function hidePic(picId) {\r\n            this.execute(picId, 'hide');\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Enables all PIC provided by the running item.\r\n         *\r\n         * @param {Function} [filter] An optional filter to reduce the list of PIC to enable\r\n         * @returns {picManagerCollection}\r\n         */\r\n        enableAll : function enableAll(filter) {\r\n            this.executeAll('enable', filter);\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Disables all PIC provided by the running item.\r\n         *\r\n         * @param {Function} [filter] An optional filter to reduce the list of PIC to disable\r\n         * @returns {picManagerCollection}\r\n         */\r\n        disableAll : function disableAll(filter) {\r\n            this.executeAll('disable', filter);\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Shows all PIC provided by the running item.\r\n         *\r\n         * @param {Function} [filter] An optional filter to reduce the list of PIC to show\r\n         * @returns {picManagerCollection}\r\n         */\r\n        showAll : function showAll(filter) {\r\n            this.executeAll('show', filter);\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Hides all PIC provided by the running item.\r\n         *\r\n         * @param {Function} [filter] An optional filter to reduce the list of PIC to hide\r\n         * @returns {picManagerCollection}\r\n         */\r\n        hideAll : function hideAll(filter) {\r\n            this.executeAll('hide', filter);\r\n            return this;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Creates a PIC manager for a particular Item.\r\n     * @param {Object} pic\r\n     * @param {QtiItem} item\r\n     * @returns {picManager} Returns the instance of the PIC manager\r\n     */\r\n    var managerFactory = function managerFactory(pic, item) {\r\n        var manager = _.clone(picManager, true);\r\n        return manager.init(pic, item);\r\n    };\r\n\r\n    /**\r\n     * Creates a PIC manager for a particular Item.\r\n     * @param {QtiItem} item\r\n     * @returns {picManager} Returns the instance of the PIC manager\r\n     */\r\n    var collectionFactory = function collectionFactory(item) {\r\n        var collection = _.clone(picManagerCollection, true);\r\n        return collection.init(item);\r\n    };\r\n\r\n    return {\r\n        collection: collectionFactory,\r\n        manager: managerFactory\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n */\r\n/**\r\n * @author Christophe Nol <christophe@taotesting.com>\r\n */\r\ndefine('taoQtiItem/runner/provider/manager/userModules',[\r\n    'lodash',\r\n    'module',\r\n    'core/promise'\r\n], function (_, module, Promise) {\r\n    'use strict';\r\n\r\n    return {\r\n        /**\r\n         * Load user modules defined in the module config\r\n         * @param {Array} [userModules] - manually specify user modules to load instead of getting them from the module config\r\n         * @returns {Promise}\r\n         */\r\n        load: function load(userModules) {\r\n            var config = module.config();\r\n\r\n            if (! userModules || ! _.isArray(userModules)) {\r\n                if (config && config.userModules && _.isArray(config.userModules)) {\r\n                    userModules = config.userModules;\r\n                } else {\r\n                    userModules = [];\r\n                }\r\n            }\r\n            return new Promise(function(resolve, reject) {\r\n                require(\r\n                    userModules,\r\n                    function () {\r\n                        _.forEach(arguments, function (dependency) {\r\n                            if (dependency && _.isFunction(dependency.exec)) {\r\n                                dependency.exec();\r\n                            }\r\n                        });\r\n                        resolve();\r\n                    },\r\n                    function (err) {\r\n                        reject(err.message);\r\n                    }\r\n                );\r\n            });\r\n        }\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiPrint/qtiPrintRenderer/tpl/notYetSupported', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n    <div class=\\\"additional\\\">\\r\\n        <div class=\\\"title\\\">Additional information:</div>\\r\\n        <p class=\\\"info\\\">\";\n  if (helper = helpers.additional) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.additional); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</p>\\r\\n    </div>\\r\\n\";\n  return buffer;\n  }\n\n  buffer += \"<article class=\\\"render-error feedback-error\\\">\\r\\n    <span class=\\\"icon-error\\\"></span>\\r\\n    <p class=\\\"message\\\">\";\n  if (helper = helpers.message) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.message); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</p>\\r\\n\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.additional), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</article>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\n/**\r\n * Item Runner for printed items\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiPrint/runner/provider/qtiprint',[\r\n    'lodash',\r\n    'i18n',\r\n    'context',\r\n    'core/logger',\r\n    'core/promise',\r\n    'taoQtiItem/qtiItem/core/Loader',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiRunner/core/Renderer',\r\n    'taoQtiItem/runner/provider/manager/picManager',\r\n    'taoQtiItem/runner/provider/manager/userModules',\r\n    'tpl!taoQtiPrint/qtiPrintRenderer/tpl/notYetSupported'\r\n], function (_, __, context, loggerFactory, Promise, QtiLoader, Element, Renderer, picManager, userModules, notYetSupportedTpl) {\r\n    'use strict';\r\n\r\n    var timeout = (context.timeout > 0 ? context.timeout + 1 : 30) * 1000;\r\n\r\n    var logger = loggerFactory('runner/provider/qtiPrint');\r\n\r\n    /**\r\n     * List the renderer's modules\r\n     * @type Object\r\n     */\r\n    var rendererModules = {\r\n        results: ['taoQtiPrint/qtiCommonRenderer/renderers/config', 'css!taoQtiPrintCss/themes/items/default/theme.css'],\r\n        booklet: ['taoQtiPrint/qtiPrintRenderer/renderers/config', 'css!taoQtiPrintCss/qti.css'],\r\n        bubbleSheet: ['taoQtiPrint/qtiPrintRenderer/renderers/config', 'css!taoQtiPrintCss/themes/items/bubble-sheet/theme.css']\r\n    };\r\n\r\n    /**\r\n     * The promise that resolves the chosen renderer\r\n     * @type {Promise}\r\n     */\r\n    var QtiRendererPromise = null;\r\n\r\n    /**\r\n     * Gets a promise that will resolve the chosen renderer\r\n     * @param {String} rendererType The name of the renderer to resolve\r\n     * @returns {Promise}\r\n     */\r\n    function getQtiRenderer(rendererType) {\r\n        if (!QtiRendererPromise) {\r\n            QtiRendererPromise = new Promise(function (resolve) {\r\n                require(rendererModules[rendererType], function (config) {\r\n                    resolve(Renderer.build(config.locations, config.name, config.options));\r\n                });\r\n            }).catch(function (err) {\r\n                logger.error(err);\r\n            });\r\n        }\r\n        return QtiRendererPromise;\r\n    }\r\n\r\n    /**\r\n     * Gets a block that displays information about unsupported content\r\n     * @param {Object} item\r\n     * @param {Object} additional\r\n     * @returns {String}\r\n     */\r\n    function missingSupport(item, additional) {\r\n        var label = item.identifier;\r\n        if (item.attributes && item.attributes.label) {\r\n            label = item.attributes.label;\r\n        }\r\n        return notYetSupportedTpl({\r\n            message: __(\"The item &laquo;%s&raquo; contains an interaction that is not yet supported for printing purpose\", label),\r\n            additional: additional\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @exports taoQtiPrint/runner/provider/qtiprint\r\n     */\r\n    return {\r\n        /**\r\n         *\r\n         * @param {Object} itemData\r\n         * @param {Function} done\r\n         */\r\n        init: function init(itemData, done) {\r\n            var self = this;\r\n\r\n            getQtiRenderer(self.options.renderer).then(function (QtiRenderer) {\r\n                var rendererOptions = {\r\n                    assetManager: self.assetManager\r\n                };\r\n\r\n                if (self.options.themes) {\r\n                    rendererOptions.themes = self.options.themes;\r\n                }\r\n\r\n                self._loader = new QtiLoader();\r\n                self._renderer = new QtiRenderer(rendererOptions);\r\n\r\n                self._loader.loadItemData(itemData, function (item) {\r\n                    if (!item) {\r\n                        return self.trigger('error', 'Unable to load item from the given data.');\r\n                    }\r\n\r\n                    self._itemData = itemData;\r\n                    self._item = item;\r\n                    try {\r\n                        self._renderer.load(function () {\r\n                            self._item.setRenderer(this);\r\n\r\n                            done();\r\n                        }, this.getLoadedClasses());\r\n                    } catch (e) {\r\n                        self.trigger('error', 'Unable to render the item : ' + e);\r\n                    }\r\n                });\r\n            });\r\n        },\r\n\r\n        /**\r\n         *\r\n         * @param {HTMLElement} elt\r\n         * @param {Function} done\r\n         */\r\n        render: function render(elt, done) {\r\n            var self = this;\r\n            if (this._item) {\r\n                try {\r\n                    if(this.options.showResponseIdentifier){\r\n                        this._item.addClass('show-response-identifier');\r\n                    }\r\n                    elt.innerHTML = this._item.render({});\r\n                } catch (e) {\r\n                    logger.trace(e);\r\n                    elt.innerHTML = missingSupport(this._itemData, e);\r\n                    self.trigger('warning', 'Error in template rendering : ' + e);\r\n                }\r\n                try {\r\n                    // Race between postRendering and timeout\r\n                    // postRendering waits for everything to be resolved or one reject\r\n                    Promise\r\n                        .race([\r\n                            Promise.all(this._item.postRender()),\r\n                            new Promise(function (resolve, reject) {\r\n                                _.delay(reject, timeout, new Error('Post rendering ran out of time in item ' + self._itemData.serial));\r\n                            })\r\n                        ])\r\n                        .then(function () {\r\n                            /**\r\n                             * Lists the PIC provided by this item.\r\n                             * @event qti#listpic\r\n                             */\r\n                            self.trigger('listpic', picManager.collection(self._item));\r\n\r\n                            return userModules.load().then(done);\r\n                        })\r\n                        .catch(function (err) {\r\n                            self.trigger('error', 'Error in post rendering : ' + err instanceof Error ? err.message : err);\r\n                            done();\r\n                        });\r\n\r\n                } catch (e) {\r\n                    self.trigger('error', 'Error in post rendering : ' + e);\r\n                    done();\r\n                }\r\n            } else {\r\n                done();\r\n            }\r\n        },\r\n\r\n        /**\r\n         *\r\n         * @param {HTMLElement} elt\r\n         * @param {Function} done\r\n         */\r\n        clear: function clear(elt, done) {\r\n            done();\r\n        },\r\n\r\n        /**\r\n         *\r\n         * @returns {Object}\r\n         */\r\n        getState: function getState() {\r\n            return {};\r\n        },\r\n\r\n        /**\r\n         *\r\n         * @param {Object} state\r\n         */\r\n        setState: function setState(state) {\r\n            if (this._item && state) {\r\n\r\n                //set interaction state\r\n                _.forEach(this._item.getInteractions(), function (interaction) {\r\n                    var id = interaction.attr('responseIdentifier');\r\n                    if (id && state[id]) {\r\n                        interaction.setState(state[id]);\r\n                    }\r\n                });\r\n\r\n                //set info control state\r\n                if (state.pic) {\r\n                    _.forEach(this._item.getElements(), function (element) {\r\n                        if (Element.isA(element, 'infoControl') && state.pic[element.attr('id')]) {\r\n                            element.setState(state.pic[element.attr('id')]);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         *\r\n         * @returns {Array}\r\n         */\r\n        getResponses: function getResponses() {\r\n            return [];\r\n        }\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiPrint/runner/itemRunner',[\r\n    'taoItems/runner/api/itemRunner',\r\n    'taoQtiPrint/runner/provider/qtiprint'\r\n], function(itemRunner, qtiRuntimeProvider){\r\n    'use strict';\r\n\r\n    //register the QTI Provider\r\n    itemRunner.register('qtiprint', qtiRuntimeProvider);\r\n\r\n    /**\r\n     * Expose the itemRunner with the QTI provider registered\r\n     * @exports taoQtiPrint/runner/itemRunner\r\n     */\r\n    return itemRunner;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * Provides common strategies to resolved assets\r\n * that may be used by any type of items.\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoItems/assets/strategies',[\r\n    'util/url',\r\n    'lodash'\r\n], function(urlUtil, _){\r\n    'use strict';\r\n\r\n    /**\r\n     * Prepend a base to an URL\r\n     * @param {Object} url - a parsed URL\r\n     * @param {String} base - the base to prepend\r\n     * @param {Boolean} [slashcat = false] - remove dots, double slashes, etc.\r\n     * @returns {String} the URL\r\n     */\r\n    var prependToUrl = function prependToUrl(url, base, slashcat){\r\n\r\n        //is slashcat we manage slash concact\r\n        if(slashcat === true){\r\n            return base.replace(/\\/$/, '') + '/' + url.directory.replace(/^\\.\\//, '').replace(/^\\//, '')\r\n                + encodeURIComponent(url.file.replace(/^\\.\\//, '').replace(/^\\//, ''));\r\n        }\r\n\r\n        return base + url.directory.replace(/^\\.?\\//, '') + encodeURIComponent(url.file.replace(/^\\.?\\//, ''));\r\n    };\r\n\r\n    /**\r\n     * Unrelated strategies accessible by there name.\r\n     * Remember to not use the whole object, but each one in an array since the order matters.\r\n     *\r\n     * @exports taoItems/assets/strategies\r\n     */\r\n    var strategies = {\r\n\r\n        //the packedUrl will replace the asset with the url given in the assets part\r\n        //the assetManager should add the assets part to data with .setData('assets' itemData.content.assets)\r\n        packedUrl : {\r\n            name : 'packedUrl',\r\n            handle : function handlePackedUrl(url, data){\r\n                var type;\r\n                if(!_.isUndefined(url.source) && !_.isUndefined(data.assets)) {\r\n                    type = _.findKey(data.assets, url.source);\r\n                    if( type && urlUtil.isAbsolute(data.assets[type][url.source])){\r\n                        return data.assets[type][url.source];\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        //the baseUrl concats the baseUrl in data if the url is relative\r\n        baseUrl : {\r\n            name : 'baseUrl',\r\n            handle : function handleBaseUrl(url, data){\r\n                if(typeof data.baseUrl === 'string' && (urlUtil.isRelative(url)) ){\r\n                    return prependToUrl(url, data.baseUrl, data.slashcat);\r\n                }\r\n            }\r\n        },\r\n\r\n        //bust the cache for item CSS\r\n        itemCssNoCache : {\r\n            name : 'itemCssNoCache',\r\n            handle : function handleItemCss(url, data){\r\n                if(typeof data.baseUrl === 'string' && (urlUtil.isRelative(url)) && /\\.css$/.test(url.file)) {\r\n                    return urlUtil.build(prependToUrl(url, data.baseUrl, data.slashcat), { bust : Date.now() });\r\n                }\r\n            }\r\n        },\r\n\r\n        //absolute URL are just left intact\r\n        external : {\r\n            name : 'external',\r\n            handle : function handleExternal(url){\r\n                if(urlUtil.isAbsolute(url)){\r\n                    return url.toString();\r\n                }\r\n            }\r\n        },\r\n\r\n        //the base64 encoded resources are also left intact\r\n        base64 : {\r\n            name : 'base64',\r\n            handle : function handleB64(url){\r\n                if(urlUtil.isBase64(url)){\r\n                    return url.toString();\r\n                }\r\n            }\r\n        },\r\n\r\n        //special tao media protocol\r\n        taomedia : {\r\n            name : 'taomedia',\r\n            handle : function handleTaoMedia(url, data){\r\n                //either a baseUrl is given or if empty, taomedia resources are managed as relative resources\r\n                var baseUrl = data.baseUrl || './';\r\n                if( (typeof url === 'object' && url.protocol === 'taomedia') ||\r\n                    (/^taomedia:\\/\\//.test(url.toString())) ){\r\n                    return baseUrl + url.toString();\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return strategies;\r\n});\r\n\n","/**\r\n * @fileoverview\r\n * - Using the 'QRCode for Javascript library'\r\n * - Fixed dataset of 'QRCode for Javascript library' for support full-spec.\r\n * - this library has no dependencies.\r\n * \r\n * @author davidshimjs\r\n * @see <a href=\"http://www.d-project.com/\" target=\"_blank\">http://www.d-project.com/</a>\r\n * @see <a href=\"http://jeromeetienne.github.com/jquery-qrcode/\" target=\"_blank\">http://jeromeetienne.github.com/jquery-qrcode/</a>\r\n */\r\n define('taoQtiPrint/lib/qrcode',[], function(){\r\nvar QRCode;\r\n\r\n\t//---------------------------------------------------------------------\r\n\t// QRCode for JavaScript\r\n\t//\r\n\t// Copyright (c) 2009 Kazuhiko Arase\r\n\t//\r\n\t// URL: http://www.d-project.com/\r\n\t//\r\n\t// Licensed under the MIT license:\r\n\t//   http://www.opensource.org/licenses/mit-license.php\r\n\t//\r\n\t// The word \"QR Code\" is registered trademark of \r\n\t// DENSO WAVE INCORPORATED\r\n\t//   http://www.denso-wave.com/qrcode/faqpatent-e.html\r\n\t//\r\n\t//---------------------------------------------------------------------\r\n\tfunction QR8bitByte(data) {\r\n\t\tthis.mode = QRMode.MODE_8BIT_BYTE;\r\n\t\tthis.data = data;\r\n\t\tthis.parsedData = [];\r\n\r\n\t\t// Added to support UTF-8 Characters\r\n\t\tfor (var i = 0, l = this.data.length; i < l; i++) {\r\n\t\t\tvar byteArray = [];\r\n\t\t\tvar code = this.data.charCodeAt(i);\r\n\r\n\t\t\tif (code > 0x10000) {\r\n\t\t\t\tbyteArray[0] = 0xF0 | ((code & 0x1C0000) >>> 18);\r\n\t\t\t\tbyteArray[1] = 0x80 | ((code & 0x3F000) >>> 12);\r\n\t\t\t\tbyteArray[2] = 0x80 | ((code & 0xFC0) >>> 6);\r\n\t\t\t\tbyteArray[3] = 0x80 | (code & 0x3F);\r\n\t\t\t} else if (code > 0x800) {\r\n\t\t\t\tbyteArray[0] = 0xE0 | ((code & 0xF000) >>> 12);\r\n\t\t\t\tbyteArray[1] = 0x80 | ((code & 0xFC0) >>> 6);\r\n\t\t\t\tbyteArray[2] = 0x80 | (code & 0x3F);\r\n\t\t\t} else if (code > 0x80) {\r\n\t\t\t\tbyteArray[0] = 0xC0 | ((code & 0x7C0) >>> 6);\r\n\t\t\t\tbyteArray[1] = 0x80 | (code & 0x3F);\r\n\t\t\t} else {\r\n\t\t\t\tbyteArray[0] = code;\r\n\t\t\t}\r\n\r\n\t\t\tthis.parsedData.push(byteArray);\r\n\t\t}\r\n\r\n\t\tthis.parsedData = Array.prototype.concat.apply([], this.parsedData);\r\n\r\n\t\tif (this.parsedData.length != this.data.length) {\r\n\t\t\tthis.parsedData.unshift(191);\r\n\t\t\tthis.parsedData.unshift(187);\r\n\t\t\tthis.parsedData.unshift(239);\r\n\t\t}\r\n\t}\r\n\r\n\tQR8bitByte.prototype = {\r\n\t\tgetLength: function (buffer) {\r\n\t\t\treturn this.parsedData.length;\r\n\t\t},\r\n\t\twrite: function (buffer) {\r\n\t\t\tfor (var i = 0, l = this.parsedData.length; i < l; i++) {\r\n\t\t\t\tbuffer.put(this.parsedData[i], 8);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tfunction QRCodeModel(typeNumber, errorCorrectLevel) {\r\n\t\tthis.typeNumber = typeNumber;\r\n\t\tthis.errorCorrectLevel = errorCorrectLevel;\r\n\t\tthis.modules = null;\r\n\t\tthis.moduleCount = 0;\r\n\t\tthis.dataCache = null;\r\n\t\tthis.dataList = [];\r\n\t}\r\n\r\n\tQRCodeModel.prototype={addData:function(data){var newData=new QR8bitByte(data);this.dataList.push(newData);this.dataCache=null;},isDark:function(row,col){if(row<0||this.moduleCount<=row||col<0||this.moduleCount<=col){throw new Error(row+\",\"+col);}\r\n\treturn this.modules[row][col];},getModuleCount:function(){return this.moduleCount;},make:function(){this.makeImpl(false,this.getBestMaskPattern());},makeImpl:function(test,maskPattern){this.moduleCount=this.typeNumber*4+17;this.modules=new Array(this.moduleCount);for(var row=0;row<this.moduleCount;row++){this.modules[row]=new Array(this.moduleCount);for(var col=0;col<this.moduleCount;col++){this.modules[row][col]=null;}}\r\n\tthis.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();this.setupTypeInfo(test,maskPattern);if(this.typeNumber>=7){this.setupTypeNumber(test);}\r\n\tif(this.dataCache==null){this.dataCache=QRCodeModel.createData(this.typeNumber,this.errorCorrectLevel,this.dataList);}\r\n\tthis.mapData(this.dataCache,maskPattern);},setupPositionProbePattern:function(row,col){for(var r=-1;r<=7;r++){if(row+r<=-1||this.moduleCount<=row+r)continue;for(var c=-1;c<=7;c++){if(col+c<=-1||this.moduleCount<=col+c)continue;if((0<=r&&r<=6&&(c==0||c==6))||(0<=c&&c<=6&&(r==0||r==6))||(2<=r&&r<=4&&2<=c&&c<=4)){this.modules[row+r][col+c]=true;}else{this.modules[row+r][col+c]=false;}}}},getBestMaskPattern:function(){var minLostPoint=0;var pattern=0;for(var i=0;i<8;i++){this.makeImpl(true,i);var lostPoint=QRUtil.getLostPoint(this);if(i==0||minLostPoint>lostPoint){minLostPoint=lostPoint;pattern=i;}}\r\n\treturn pattern;},createMovieClip:function(target_mc,instance_name,depth){var qr_mc=target_mc.createEmptyMovieClip(instance_name,depth);var cs=1;this.make();for(var row=0;row<this.modules.length;row++){var y=row*cs;for(var col=0;col<this.modules[row].length;col++){var x=col*cs;var dark=this.modules[row][col];if(dark){qr_mc.beginFill(0,100);qr_mc.moveTo(x,y);qr_mc.lineTo(x+cs,y);qr_mc.lineTo(x+cs,y+cs);qr_mc.lineTo(x,y+cs);qr_mc.endFill();}}}\r\n\treturn qr_mc;},setupTimingPattern:function(){for(var r=8;r<this.moduleCount-8;r++){if(this.modules[r][6]!=null){continue;}\r\n\tthis.modules[r][6]=(r%2==0);}\r\n\tfor(var c=8;c<this.moduleCount-8;c++){if(this.modules[6][c]!=null){continue;}\r\n\tthis.modules[6][c]=(c%2==0);}},setupPositionAdjustPattern:function(){var pos=QRUtil.getPatternPosition(this.typeNumber);for(var i=0;i<pos.length;i++){for(var j=0;j<pos.length;j++){var row=pos[i];var col=pos[j];if(this.modules[row][col]!=null){continue;}\r\n\tfor(var r=-2;r<=2;r++){for(var c=-2;c<=2;c++){if(r==-2||r==2||c==-2||c==2||(r==0&&c==0)){this.modules[row+r][col+c]=true;}else{this.modules[row+r][col+c]=false;}}}}}},setupTypeNumber:function(test){var bits=QRUtil.getBCHTypeNumber(this.typeNumber);for(var i=0;i<18;i++){var mod=(!test&&((bits>>i)&1)==1);this.modules[Math.floor(i/3)][i%3+this.moduleCount-8-3]=mod;}\r\n\tfor(var i=0;i<18;i++){var mod=(!test&&((bits>>i)&1)==1);this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=mod;}},setupTypeInfo:function(test,maskPattern){var data=(this.errorCorrectLevel<<3)|maskPattern;var bits=QRUtil.getBCHTypeInfo(data);for(var i=0;i<15;i++){var mod=(!test&&((bits>>i)&1)==1);if(i<6){this.modules[i][8]=mod;}else if(i<8){this.modules[i+1][8]=mod;}else{this.modules[this.moduleCount-15+i][8]=mod;}}\r\n\tfor(var i=0;i<15;i++){var mod=(!test&&((bits>>i)&1)==1);if(i<8){this.modules[8][this.moduleCount-i-1]=mod;}else if(i<9){this.modules[8][15-i-1+1]=mod;}else{this.modules[8][15-i-1]=mod;}}\r\n\tthis.modules[this.moduleCount-8][8]=(!test);},mapData:function(data,maskPattern){var inc=-1;var row=this.moduleCount-1;var bitIndex=7;var byteIndex=0;for(var col=this.moduleCount-1;col>0;col-=2){if(col==6)col--;while(true){for(var c=0;c<2;c++){if(this.modules[row][col-c]==null){var dark=false;if(byteIndex<data.length){dark=(((data[byteIndex]>>>bitIndex)&1)==1);}\r\n\tvar mask=QRUtil.getMask(maskPattern,row,col-c);if(mask){dark=!dark;}\r\n\tthis.modules[row][col-c]=dark;bitIndex--;if(bitIndex==-1){byteIndex++;bitIndex=7;}}}\r\n\trow+=inc;if(row<0||this.moduleCount<=row){row-=inc;inc=-inc;break;}}}}};QRCodeModel.PAD0=0xEC;QRCodeModel.PAD1=0x11;QRCodeModel.createData=function(typeNumber,errorCorrectLevel,dataList){var rsBlocks=QRRSBlock.getRSBlocks(typeNumber,errorCorrectLevel);var buffer=new QRBitBuffer();for(var i=0;i<dataList.length;i++){var data=dataList[i];buffer.put(data.mode,4);buffer.put(data.getLength(),QRUtil.getLengthInBits(data.mode,typeNumber));data.write(buffer);}\r\n\tvar totalDataCount=0;for(var i=0;i<rsBlocks.length;i++){totalDataCount+=rsBlocks[i].dataCount;}\r\n\tif(buffer.getLengthInBits()>totalDataCount*8){throw new Error(\"code length overflow. (\"\r\n\t+buffer.getLengthInBits()\r\n\t+\">\"\r\n\t+totalDataCount*8\r\n\t+\")\");}\r\n\tif(buffer.getLengthInBits()+4<=totalDataCount*8){buffer.put(0,4);}\r\n\twhile(buffer.getLengthInBits()%8!=0){buffer.putBit(false);}\r\n\twhile(true){if(buffer.getLengthInBits()>=totalDataCount*8){break;}\r\n\tbuffer.put(QRCodeModel.PAD0,8);if(buffer.getLengthInBits()>=totalDataCount*8){break;}\r\n\tbuffer.put(QRCodeModel.PAD1,8);}\r\n\treturn QRCodeModel.createBytes(buffer,rsBlocks);};QRCodeModel.createBytes=function(buffer,rsBlocks){var offset=0;var maxDcCount=0;var maxEcCount=0;var dcdata=new Array(rsBlocks.length);var ecdata=new Array(rsBlocks.length);for(var r=0;r<rsBlocks.length;r++){var dcCount=rsBlocks[r].dataCount;var ecCount=rsBlocks[r].totalCount-dcCount;maxDcCount=Math.max(maxDcCount,dcCount);maxEcCount=Math.max(maxEcCount,ecCount);dcdata[r]=new Array(dcCount);for(var i=0;i<dcdata[r].length;i++){dcdata[r][i]=0xff&buffer.buffer[i+offset];}\r\n\toffset+=dcCount;var rsPoly=QRUtil.getErrorCorrectPolynomial(ecCount);var rawPoly=new QRPolynomial(dcdata[r],rsPoly.getLength()-1);var modPoly=rawPoly.mod(rsPoly);ecdata[r]=new Array(rsPoly.getLength()-1);for(var i=0;i<ecdata[r].length;i++){var modIndex=i+modPoly.getLength()-ecdata[r].length;ecdata[r][i]=(modIndex>=0)?modPoly.get(modIndex):0;}}\r\n\tvar totalCodeCount=0;for(var i=0;i<rsBlocks.length;i++){totalCodeCount+=rsBlocks[i].totalCount;}\r\n\tvar data=new Array(totalCodeCount);var index=0;for(var i=0;i<maxDcCount;i++){for(var r=0;r<rsBlocks.length;r++){if(i<dcdata[r].length){data[index++]=dcdata[r][i];}}}\r\n\tfor(var i=0;i<maxEcCount;i++){for(var r=0;r<rsBlocks.length;r++){if(i<ecdata[r].length){data[index++]=ecdata[r][i];}}}\r\n\treturn data;};var QRMode={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3};var QRErrorCorrectLevel={L:1,M:0,Q:3,H:2};var QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var QRUtil={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:(1<<10)|(1<<8)|(1<<5)|(1<<4)|(1<<2)|(1<<1)|(1<<0),G18:(1<<12)|(1<<11)|(1<<10)|(1<<9)|(1<<8)|(1<<5)|(1<<2)|(1<<0),G15_MASK:(1<<14)|(1<<12)|(1<<10)|(1<<4)|(1<<1),getBCHTypeInfo:function(data){var d=data<<10;while(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G15)>=0){d^=(QRUtil.G15<<(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G15)));}\r\n\treturn((data<<10)|d)^QRUtil.G15_MASK;},getBCHTypeNumber:function(data){var d=data<<12;while(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G18)>=0){d^=(QRUtil.G18<<(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G18)));}\r\n\treturn(data<<12)|d;},getBCHDigit:function(data){var digit=0;while(data!=0){digit++;data>>>=1;}\r\n\treturn digit;},getPatternPosition:function(typeNumber){return QRUtil.PATTERN_POSITION_TABLE[typeNumber-1];},getMask:function(maskPattern,i,j){switch(maskPattern){case QRMaskPattern.PATTERN000:return(i+j)%2==0;case QRMaskPattern.PATTERN001:return i%2==0;case QRMaskPattern.PATTERN010:return j%3==0;case QRMaskPattern.PATTERN011:return(i+j)%3==0;case QRMaskPattern.PATTERN100:return(Math.floor(i/2)+Math.floor(j/3))%2==0;case QRMaskPattern.PATTERN101:return(i*j)%2+(i*j)%3==0;case QRMaskPattern.PATTERN110:return((i*j)%2+(i*j)%3)%2==0;case QRMaskPattern.PATTERN111:return((i*j)%3+(i+j)%2)%2==0;default:throw new Error(\"bad maskPattern:\"+maskPattern);}},getErrorCorrectPolynomial:function(errorCorrectLength){var a=new QRPolynomial([1],0);for(var i=0;i<errorCorrectLength;i++){a=a.multiply(new QRPolynomial([1,QRMath.gexp(i)],0));}\r\n\treturn a;},getLengthInBits:function(mode,type){if(1<=type&&type<10){switch(mode){case QRMode.MODE_NUMBER:return 10;case QRMode.MODE_ALPHA_NUM:return 9;case QRMode.MODE_8BIT_BYTE:return 8;case QRMode.MODE_KANJI:return 8;default:throw new Error(\"mode:\"+mode);}}else if(type<27){switch(mode){case QRMode.MODE_NUMBER:return 12;case QRMode.MODE_ALPHA_NUM:return 11;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 10;default:throw new Error(\"mode:\"+mode);}}else if(type<41){switch(mode){case QRMode.MODE_NUMBER:return 14;case QRMode.MODE_ALPHA_NUM:return 13;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 12;default:throw new Error(\"mode:\"+mode);}}else{throw new Error(\"type:\"+type);}},getLostPoint:function(qrCode){var moduleCount=qrCode.getModuleCount();var lostPoint=0;for(var row=0;row<moduleCount;row++){for(var col=0;col<moduleCount;col++){var sameCount=0;var dark=qrCode.isDark(row,col);for(var r=-1;r<=1;r++){if(row+r<0||moduleCount<=row+r){continue;}\r\n\tfor(var c=-1;c<=1;c++){if(col+c<0||moduleCount<=col+c){continue;}\r\n\tif(r==0&&c==0){continue;}\r\n\tif(dark==qrCode.isDark(row+r,col+c)){sameCount++;}}}\r\n\tif(sameCount>5){lostPoint+=(3+sameCount-5);}}}\r\n\tfor(var row=0;row<moduleCount-1;row++){for(var col=0;col<moduleCount-1;col++){var count=0;if(qrCode.isDark(row,col))count++;if(qrCode.isDark(row+1,col))count++;if(qrCode.isDark(row,col+1))count++;if(qrCode.isDark(row+1,col+1))count++;if(count==0||count==4){lostPoint+=3;}}}\r\n\tfor(var row=0;row<moduleCount;row++){for(var col=0;col<moduleCount-6;col++){if(qrCode.isDark(row,col)&&!qrCode.isDark(row,col+1)&&qrCode.isDark(row,col+2)&&qrCode.isDark(row,col+3)&&qrCode.isDark(row,col+4)&&!qrCode.isDark(row,col+5)&&qrCode.isDark(row,col+6)){lostPoint+=40;}}}\r\n\tfor(var col=0;col<moduleCount;col++){for(var row=0;row<moduleCount-6;row++){if(qrCode.isDark(row,col)&&!qrCode.isDark(row+1,col)&&qrCode.isDark(row+2,col)&&qrCode.isDark(row+3,col)&&qrCode.isDark(row+4,col)&&!qrCode.isDark(row+5,col)&&qrCode.isDark(row+6,col)){lostPoint+=40;}}}\r\n\tvar darkCount=0;for(var col=0;col<moduleCount;col++){for(var row=0;row<moduleCount;row++){if(qrCode.isDark(row,col)){darkCount++;}}}\r\n\tvar ratio=Math.abs(100*darkCount/moduleCount/moduleCount-50)/5;lostPoint+=ratio*10;return lostPoint;}};var QRMath={glog:function(n){if(n<1){throw new Error(\"glog(\"+n+\")\");}\r\n\treturn QRMath.LOG_TABLE[n];},gexp:function(n){while(n<0){n+=255;}\r\n\twhile(n>=256){n-=255;}\r\n\treturn QRMath.EXP_TABLE[n];},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var i=0;i<8;i++){QRMath.EXP_TABLE[i]=1<<i;}\r\n\tfor(var i=8;i<256;i++){QRMath.EXP_TABLE[i]=QRMath.EXP_TABLE[i-4]^QRMath.EXP_TABLE[i-5]^QRMath.EXP_TABLE[i-6]^QRMath.EXP_TABLE[i-8];}\r\n\tfor(var i=0;i<255;i++){QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]]=i;}\r\n\tfunction QRPolynomial(num,shift){if(num.length==undefined){throw new Error(num.length+\"/\"+shift);}\r\n\tvar offset=0;while(offset<num.length&&num[offset]==0){offset++;}\r\n\tthis.num=new Array(num.length-offset+shift);for(var i=0;i<num.length-offset;i++){this.num[i]=num[i+offset];}}\r\n\tQRPolynomial.prototype={get:function(index){return this.num[index];},getLength:function(){return this.num.length;},multiply:function(e){var num=new Array(this.getLength()+e.getLength()-1);for(var i=0;i<this.getLength();i++){for(var j=0;j<e.getLength();j++){num[i+j]^=QRMath.gexp(QRMath.glog(this.get(i))+QRMath.glog(e.get(j)));}}\r\n\treturn new QRPolynomial(num,0);},mod:function(e){if(this.getLength()-e.getLength()<0){return this;}\r\n\tvar ratio=QRMath.glog(this.get(0))-QRMath.glog(e.get(0));var num=new Array(this.getLength());for(var i=0;i<this.getLength();i++){num[i]=this.get(i);}\r\n\tfor(var i=0;i<e.getLength();i++){num[i]^=QRMath.gexp(QRMath.glog(e.get(i))+ratio);}\r\n\treturn new QRPolynomial(num,0).mod(e);}};function QRRSBlock(totalCount,dataCount){this.totalCount=totalCount;this.dataCount=dataCount;}\r\n\tQRRSBlock.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];QRRSBlock.getRSBlocks=function(typeNumber,errorCorrectLevel){var rsBlock=QRRSBlock.getRsBlockTable(typeNumber,errorCorrectLevel);if(rsBlock==undefined){throw new Error(\"bad rs block @ typeNumber:\"+typeNumber+\"/errorCorrectLevel:\"+errorCorrectLevel);}\r\n\tvar length=rsBlock.length/3;var list=[];for(var i=0;i<length;i++){var count=rsBlock[i*3+0];var totalCount=rsBlock[i*3+1];var dataCount=rsBlock[i*3+2];for(var j=0;j<count;j++){list.push(new QRRSBlock(totalCount,dataCount));}}\r\n\treturn list;};QRRSBlock.getRsBlockTable=function(typeNumber,errorCorrectLevel){switch(errorCorrectLevel){case QRErrorCorrectLevel.L:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+0];case QRErrorCorrectLevel.M:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+1];case QRErrorCorrectLevel.Q:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+2];case QRErrorCorrectLevel.H:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+3];default:return undefined;}};function QRBitBuffer(){this.buffer=[];this.length=0;}\r\n\tQRBitBuffer.prototype={get:function(index){var bufIndex=Math.floor(index/8);return((this.buffer[bufIndex]>>>(7-index%8))&1)==1;},put:function(num,length){for(var i=0;i<length;i++){this.putBit(((num>>>(length-i-1))&1)==1);}},getLengthInBits:function(){return this.length;},putBit:function(bit){var bufIndex=Math.floor(this.length/8);if(this.buffer.length<=bufIndex){this.buffer.push(0);}\r\n\tif(bit){this.buffer[bufIndex]|=(0x80>>>(this.length%8));}\r\n\tthis.length++;}};var QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];\r\n\t\r\n\tfunction _isSupportCanvas() {\r\n\t\treturn typeof CanvasRenderingContext2D != \"undefined\";\r\n\t}\r\n\t\r\n\t// android 2.x doesn't support Data-URI spec\r\n\tfunction _getAndroid() {\r\n\t\tvar android = false;\r\n\t\tvar sAgent = navigator.userAgent;\r\n\t\t\r\n\t\tif (/android/i.test(sAgent)) { // android\r\n\t\t\tandroid = true;\r\n\t\t\tvar aMat = sAgent.toString().match(/android ([0-9]\\.[0-9])/i);\r\n\t\t\t\r\n\t\t\tif (aMat && aMat[1]) {\r\n\t\t\t\tandroid = parseFloat(aMat[1]);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn android;\r\n\t}\r\n\t\r\n\tvar svgDrawer = (function() {\r\n\r\n\t\tvar Drawing = function (el, htOption) {\r\n\t\t\tthis._el = el;\r\n\t\t\tthis._htOption = htOption;\r\n\t\t};\r\n\r\n\t\tDrawing.prototype.draw = function (oQRCode) {\r\n\t\t\tvar _htOption = this._htOption;\r\n\t\t\tvar _el = this._el;\r\n\t\t\tvar nCount = oQRCode.getModuleCount();\r\n\t\t\tvar nWidth = Math.floor(_htOption.width / nCount);\r\n\t\t\tvar nHeight = Math.floor(_htOption.height / nCount);\r\n\r\n\t\t\tthis.clear();\r\n\r\n\t\t\tfunction makeSVG(tag, attrs) {\r\n\t\t\t\tvar el = document.createElementNS('http://www.w3.org/2000/svg', tag);\r\n\t\t\t\tfor (var k in attrs)\r\n\t\t\t\t\tif (attrs.hasOwnProperty(k)) el.setAttribute(k, attrs[k]);\r\n\t\t\t\treturn el;\r\n\t\t\t}\r\n\r\n\t\t\tvar svg = makeSVG(\"svg\" , {'viewBox': '0 0 ' + String(nCount) + \" \" + String(nCount), 'width': '100%', 'height': '100%', 'fill': _htOption.colorLight});\r\n\t\t\tsvg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\r\n\t\t\t_el.appendChild(svg);\r\n\r\n\t\t\tsvg.appendChild(makeSVG(\"rect\", {\"fill\": _htOption.colorLight, \"width\": \"100%\", \"height\": \"100%\"}));\r\n\t\t\tsvg.appendChild(makeSVG(\"rect\", {\"fill\": _htOption.colorDark, \"width\": \"1\", \"height\": \"1\", \"id\": \"template\"}));\r\n\r\n\t\t\tfor (var row = 0; row < nCount; row++) {\r\n\t\t\t\tfor (var col = 0; col < nCount; col++) {\r\n\t\t\t\t\tif (oQRCode.isDark(row, col)) {\r\n\t\t\t\t\t\tvar child = makeSVG(\"use\", {\"x\": String(row), \"y\": String(col)});\r\n\t\t\t\t\t\tchild.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\", \"#template\")\r\n\t\t\t\t\t\tsvg.appendChild(child);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tDrawing.prototype.clear = function () {\r\n\t\t\twhile (this._el.hasChildNodes())\r\n\t\t\t\tthis._el.removeChild(this._el.lastChild);\r\n\t\t};\r\n\t\treturn Drawing;\r\n\t})();\r\n\r\n\tvar useSVG = document.documentElement.tagName.toLowerCase() === \"svg\";\r\n\r\n\t// Drawing in DOM by using Table tag\r\n\tvar Drawing = useSVG ? svgDrawer : !_isSupportCanvas() ? (function () {\r\n\t\tvar Drawing = function (el, htOption) {\r\n\t\t\tthis._el = el;\r\n\t\t\tthis._htOption = htOption;\r\n\t\t};\r\n\t\t\t\r\n\t\t/**\r\n\t\t * Draw the QRCode\r\n\t\t * \r\n\t\t * @param {QRCode} oQRCode\r\n\t\t */\r\n\t\tDrawing.prototype.draw = function (oQRCode) {\r\n            var _htOption = this._htOption;\r\n            var _el = this._el;\r\n\t\t\tvar nCount = oQRCode.getModuleCount();\r\n\t\t\tvar nWidth = Math.floor(_htOption.width / nCount);\r\n\t\t\tvar nHeight = Math.floor(_htOption.height / nCount);\r\n\t\t\tvar aHTML = ['<table style=\"border:0;border-collapse:collapse;\">'];\r\n\t\t\t\r\n\t\t\tfor (var row = 0; row < nCount; row++) {\r\n\t\t\t\taHTML.push('<tr>');\r\n\t\t\t\t\r\n\t\t\t\tfor (var col = 0; col < nCount; col++) {\r\n\t\t\t\t\taHTML.push('<td style=\"border:0;border-collapse:collapse;padding:0;margin:0;width:' + nWidth + 'px;height:' + nHeight + 'px;background-color:' + (oQRCode.isDark(row, col) ? _htOption.colorDark : _htOption.colorLight) + ';\"></td>');\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\taHTML.push('</tr>');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\taHTML.push('</table>');\r\n\t\t\t_el.innerHTML = aHTML.join('');\r\n\t\t\t\r\n\t\t\t// Fix the margin values as real size.\r\n\t\t\tvar elTable = _el.childNodes[0];\r\n\t\t\tvar nLeftMarginTable = (_htOption.width - elTable.offsetWidth) / 2;\r\n\t\t\tvar nTopMarginTable = (_htOption.height - elTable.offsetHeight) / 2;\r\n\t\t\t\r\n\t\t\tif (nLeftMarginTable > 0 && nTopMarginTable > 0) {\r\n\t\t\t\telTable.style.margin = nTopMarginTable + \"px \" + nLeftMarginTable + \"px\";\t\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\t\t/**\r\n\t\t * Clear the QRCode\r\n\t\t */\r\n\t\tDrawing.prototype.clear = function () {\r\n\t\t\tthis._el.innerHTML = '';\r\n\t\t};\r\n\t\t\r\n\t\treturn Drawing;\r\n\t})() : (function () { // Drawing in Canvas\r\n\t\tfunction _onMakeImage() {\r\n\t\t\tthis._elImage.src = this._elCanvas.toDataURL(\"image/png\");\r\n\t\t\tthis._elImage.style.display = \"block\";\r\n\t\t\tthis._elCanvas.style.display = \"none\";\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t// Android 2.1 bug workaround\r\n\t\t// http://code.google.com/p/android/issues/detail?id=5141\r\n\t\tif (this._android && this._android <= 2.1) {\r\n\t    \tvar factor = 1 / window.devicePixelRatio;\r\n\t        var drawImage = CanvasRenderingContext2D.prototype.drawImage; \r\n\t    \tCanvasRenderingContext2D.prototype.drawImage = function (image, sx, sy, sw, sh, dx, dy, dw, dh) {\r\n\t    \t\tif ((\"nodeName\" in image) && /img/i.test(image.nodeName)) {\r\n\t\t        \tfor (var i = arguments.length - 1; i >= 1; i--) {\r\n\t\t            \targuments[i] = arguments[i] * factor;\r\n\t\t        \t}\r\n\t    \t\t} else if (typeof dw == \"undefined\") {\r\n\t    \t\t\targuments[1] *= factor;\r\n\t    \t\t\targuments[2] *= factor;\r\n\t    \t\t\targuments[3] *= factor;\r\n\t    \t\t\targuments[4] *= factor;\r\n\t    \t\t}\r\n\t    \t\t\r\n\t        \tdrawImage.apply(this, arguments); \r\n\t    \t};\r\n\t\t}\r\n\t\t\r\n\t\t/**\r\n\t\t * Check whether the user's browser supports Data URI or not\r\n\t\t * \r\n\t\t * @private\r\n\t\t * @param {Function} fSuccess Occurs if it supports Data URI\r\n\t\t * @param {Function} fFail Occurs if it doesn't support Data URI\r\n\t\t */\r\n\t\tfunction _safeSetDataURI(fSuccess, fFail) {\r\n            var self = this;\r\n            self._fFail = fFail;\r\n            self._fSuccess = fSuccess;\r\n\r\n            // Check it just once\r\n            if (self._bSupportDataURI === null) {\r\n                var el = document.createElement(\"img\");\r\n                var fOnError = function() {\r\n                    self._bSupportDataURI = false;\r\n\r\n                    if (self._fFail) {\r\n                        self._fFail.call(self);\r\n                    }\r\n                };\r\n                var fOnSuccess = function() {\r\n                    self._bSupportDataURI = true;\r\n\r\n                    if (self._fSuccess) {\r\n                        self._fSuccess.call(self);\r\n                    }\r\n                };\r\n\r\n                el.onabort = fOnError;\r\n                el.onerror = fOnError;\r\n                el.onload = fOnSuccess;\r\n                el.src = \"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\"; // the Image contains 1px data.\r\n                return;\r\n            } else if (self._bSupportDataURI === true && self._fSuccess) {\r\n                self._fSuccess.call(self);\r\n            } else if (self._bSupportDataURI === false && self._fFail) {\r\n                self._fFail.call(self);\r\n            }\r\n\t\t};\r\n\t\t\r\n\t\t/**\r\n\t\t * Drawing QRCode by using canvas\r\n\t\t * \r\n\t\t * @constructor\r\n\t\t * @param {HTMLElement} el\r\n\t\t * @param {Object} htOption QRCode Options \r\n\t\t */\r\n\t\tvar Drawing = function (el, htOption) {\r\n    \t\tthis._bIsPainted = false;\r\n    \t\tthis._android = _getAndroid();\r\n\t\t\r\n\t\t\tthis._htOption = htOption;\r\n\t\t\tthis._elCanvas = document.createElement(\"canvas\");\r\n\t\t\tthis._elCanvas.width = htOption.width;\r\n\t\t\tthis._elCanvas.height = htOption.height;\r\n\t\t\tel.appendChild(this._elCanvas);\r\n\t\t\tthis._el = el;\r\n\t\t\tthis._oContext = this._elCanvas.getContext(\"2d\");\r\n\t\t\tthis._bIsPainted = false;\r\n\t\t\tthis._elImage = document.createElement(\"img\");\r\n\t\t\tthis._elImage.alt = \"Scan me!\";\r\n\t\t\tthis._elImage.style.display = \"none\";\r\n\t\t\tthis._el.appendChild(this._elImage);\r\n\t\t\tthis._bSupportDataURI = null;\r\n\t\t};\r\n\t\t\t\r\n\t\t/**\r\n\t\t * Draw the QRCode\r\n\t\t * \r\n\t\t * @param {QRCode} oQRCode \r\n\t\t */\r\n\t\tDrawing.prototype.draw = function (oQRCode) {\r\n            var _elImage = this._elImage;\r\n            var _oContext = this._oContext;\r\n            var _htOption = this._htOption;\r\n            \r\n\t\t\tvar nCount = oQRCode.getModuleCount();\r\n\t\t\tvar nWidth = _htOption.width / nCount;\r\n\t\t\tvar nHeight = _htOption.height / nCount;\r\n\t\t\tvar nRoundedWidth = Math.round(nWidth);\r\n\t\t\tvar nRoundedHeight = Math.round(nHeight);\r\n\r\n\t\t\t_elImage.style.display = \"none\";\r\n\t\t\tthis.clear();\r\n\t\t\t\r\n\t\t\tfor (var row = 0; row < nCount; row++) {\r\n\t\t\t\tfor (var col = 0; col < nCount; col++) {\r\n\t\t\t\t\tvar bIsDark = oQRCode.isDark(row, col);\r\n\t\t\t\t\tvar nLeft = col * nWidth;\r\n\t\t\t\t\tvar nTop = row * nHeight;\r\n\t\t\t\t\t_oContext.strokeStyle = bIsDark ? _htOption.colorDark : _htOption.colorLight;\r\n\t\t\t\t\t_oContext.lineWidth = 1;\r\n\t\t\t\t\t_oContext.fillStyle = bIsDark ? _htOption.colorDark : _htOption.colorLight;\t\t\t\t\t\r\n\t\t\t\t\t_oContext.fillRect(nLeft, nTop, nWidth, nHeight);\r\n\t\t\t\t\t\r\n\t\t\t\t\t//    \r\n\t\t\t\t\t_oContext.strokeRect(\r\n\t\t\t\t\t\tMath.floor(nLeft) + 0.5,\r\n\t\t\t\t\t\tMath.floor(nTop) + 0.5,\r\n\t\t\t\t\t\tnRoundedWidth,\r\n\t\t\t\t\t\tnRoundedHeight\r\n\t\t\t\t\t);\r\n\t\t\t\t\t\r\n\t\t\t\t\t_oContext.strokeRect(\r\n\t\t\t\t\t\tMath.ceil(nLeft) - 0.5,\r\n\t\t\t\t\t\tMath.ceil(nTop) - 0.5,\r\n\t\t\t\t\t\tnRoundedWidth,\r\n\t\t\t\t\t\tnRoundedHeight\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._bIsPainted = true;\r\n\t\t};\r\n\t\t\t\r\n\t\t/**\r\n\t\t * Make the image from Canvas if the browser supports Data URI.\r\n\t\t */\r\n\t\tDrawing.prototype.makeImage = function () {\r\n\t\t\tif (this._bIsPainted) {\r\n\t\t\t\t_safeSetDataURI.call(this, _onMakeImage);\r\n\t\t\t}\r\n\t\t};\r\n\t\t\t\r\n\t\t/**\r\n\t\t * Return whether the QRCode is painted or not\r\n\t\t * \r\n\t\t * @return {Boolean}\r\n\t\t */\r\n\t\tDrawing.prototype.isPainted = function () {\r\n\t\t\treturn this._bIsPainted;\r\n\t\t};\r\n\t\t\r\n\t\t/**\r\n\t\t * Clear the QRCode\r\n\t\t */\r\n\t\tDrawing.prototype.clear = function () {\r\n\t\t\tthis._oContext.clearRect(0, 0, this._elCanvas.width, this._elCanvas.height);\r\n\t\t\tthis._bIsPainted = false;\r\n\t\t};\r\n\t\t\r\n\t\t/**\r\n\t\t * @private\r\n\t\t * @param {Number} nNumber\r\n\t\t */\r\n\t\tDrawing.prototype.round = function (nNumber) {\r\n\t\t\tif (!nNumber) {\r\n\t\t\t\treturn nNumber;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn Math.floor(nNumber * 1000) / 1000;\r\n\t\t};\r\n\t\t\r\n\t\treturn Drawing;\r\n\t})();\r\n\t\r\n\t/**\r\n\t * Get the type by string length\r\n\t * \r\n\t * @private\r\n\t * @param {String} sText\r\n\t * @param {Number} nCorrectLevel\r\n\t * @return {Number} type\r\n\t */\r\n\tfunction _getTypeNumber(sText, nCorrectLevel) {\t\t\t\r\n\t\tvar nType = 1;\r\n\t\tvar length = _getUTF8Length(sText);\r\n\t\t\r\n\t\tfor (var i = 0, len = QRCodeLimitLength.length; i <= len; i++) {\r\n\t\t\tvar nLimit = 0;\r\n\t\t\t\r\n\t\t\tswitch (nCorrectLevel) {\r\n\t\t\t\tcase QRErrorCorrectLevel.L :\r\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][0];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase QRErrorCorrectLevel.M :\r\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][1];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase QRErrorCorrectLevel.Q :\r\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][2];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase QRErrorCorrectLevel.H :\r\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][3];\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (length <= nLimit) {\r\n\t\t\t\tbreak;\r\n\t\t\t} else {\r\n\t\t\t\tnType++;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (nType > QRCodeLimitLength.length) {\r\n\t\t\tthrow new Error(\"Too long data\");\r\n\t\t}\r\n\t\t\r\n\t\treturn nType;\r\n\t}\r\n\r\n\tfunction _getUTF8Length(sText) {\r\n\t\tvar replacedText = encodeURI(sText).toString().replace(/\\%[0-9a-fA-F]{2}/g, 'a');\r\n\t\treturn replacedText.length + (replacedText.length != sText ? 3 : 0);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @class QRCode\r\n\t * @constructor\r\n\t * @example \r\n\t * new QRCode(document.getElementById(\"test\"), \"http://jindo.dev.naver.com/collie\");\r\n\t *\r\n\t * @example\r\n\t * var oQRCode = new QRCode(\"test\", {\r\n\t *    text : \"http://naver.com\",\r\n\t *    width : 128,\r\n\t *    height : 128\r\n\t * });\r\n\t * \r\n\t * oQRCode.clear(); // Clear the QRCode.\r\n\t * oQRCode.makeCode(\"http://map.naver.com\"); // Re-create the QRCode.\r\n\t *\r\n\t * @param {HTMLElement|String} el target element or 'id' attribute of element.\r\n\t * @param {Object|String} vOption\r\n\t * @param {String} vOption.text QRCode link data\r\n\t * @param {Number} [vOption.width=256]\r\n\t * @param {Number} [vOption.height=256]\r\n\t * @param {String} [vOption.colorDark=\"#000000\"]\r\n\t * @param {String} [vOption.colorLight=\"#ffffff\"]\r\n\t * @param {QRCode.CorrectLevel} [vOption.correctLevel=QRCode.CorrectLevel.H] [L|M|Q|H] \r\n\t */\r\n\tQRCode = function (el, vOption) {\r\n\t\tthis._htOption = {\r\n\t\t\twidth : 256, \r\n\t\t\theight : 256,\r\n\t\t\ttypeNumber : 4,\r\n\t\t\tcolorDark : \"#000000\",\r\n\t\t\tcolorLight : \"#ffffff\",\r\n\t\t\tcorrectLevel : QRErrorCorrectLevel.H\r\n\t\t};\r\n\t\t\r\n\t\tif (typeof vOption === 'string') {\r\n\t\t\tvOption\t= {\r\n\t\t\t\ttext : vOption\r\n\t\t\t};\r\n\t\t}\r\n\t\t\r\n\t\t// Overwrites options\r\n\t\tif (vOption) {\r\n\t\t\tfor (var i in vOption) {\r\n\t\t\t\tthis._htOption[i] = vOption[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif (typeof el == \"string\") {\r\n\t\t\tel = document.getElementById(el);\r\n\t\t}\r\n\r\n\t\tif (this._htOption.useSVG) {\r\n\t\t\tDrawing = svgDrawer;\r\n\t\t}\r\n\t\t\r\n\t\tthis._android = _getAndroid();\r\n\t\tthis._el = el;\r\n\t\tthis._oQRCode = null;\r\n\t\tthis._oDrawing = new Drawing(this._el, this._htOption);\r\n\t\t\r\n\t\tif (this._htOption.text) {\r\n\t\t\tthis.makeCode(this._htOption.text);\t\r\n\t\t}\r\n\t};\r\n\t\r\n\t/**\r\n\t * Make the QRCode\r\n\t * \r\n\t * @param {String} sText link data\r\n\t */\r\n\tQRCode.prototype.makeCode = function (sText) {\r\n\t\tthis._oQRCode = new QRCodeModel(_getTypeNumber(sText, this._htOption.correctLevel), this._htOption.correctLevel);\r\n\t\tthis._oQRCode.addData(sText);\r\n\t\tthis._oQRCode.make();\r\n\t\tthis._el.title = sText;\r\n\t\tthis._oDrawing.draw(this._oQRCode);\t\t\t\r\n\t\tthis.makeImage();\r\n\t};\r\n\t\r\n\t/**\r\n\t * Make the Image from Canvas element\r\n\t * - It occurs automatically\r\n\t * - Android below 3 doesn't support Data-URI spec.\r\n\t * \r\n\t * @private\r\n\t */\r\n\tQRCode.prototype.makeImage = function () {\r\n\t\tif (typeof this._oDrawing.makeImage == \"function\" && (!this._android || this._android >= 3)) {\r\n\t\t\tthis._oDrawing.makeImage();\r\n\t\t}\r\n\t};\r\n\t\r\n\t/**\r\n\t * Clear the QRCode\r\n\t */\r\n\tQRCode.prototype.clear = function () {\r\n\t\tthis._oDrawing.clear();\r\n\t};\r\n\t\r\n\t/**\r\n\t * @name QRCode.CorrectLevel\r\n\t */\r\n\tQRCode.CorrectLevel = QRErrorCorrectLevel;\r\n\t\r\n\treturn QRCode;\r\n});\r\n\n","\ndefine('tpl!taoQtiPrint/runner/tpl/pageTest', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n<h3>\";\n  if (helper = helpers.uniqid) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.uniqid); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h3>\\r\\n\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n    <div class=\\\"logo\\\">\\r\\n        <img src=\\\"\";\n  if (helper = helpers.logo) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.logo); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" alt=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Logo\", options) : helperMissing.call(depth0, \"__\", \"Logo\", options)))\n    + \"\\\" />\\r\\n    </div>\\r\\n\";\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n    <h2>\";\n  if (helper = helpers.subtitle) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.subtitle); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h2>\\r\\n\";\n  return buffer;\n  }\n\nfunction program7(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n    <h3>\";\n  if (helper = helpers.date) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.date); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h3>\\r\\n\";\n  return buffer;\n  }\n\nfunction program9(depth0,data) {\n  \n  \n  return \"\\r\\n    <div class=\\\"qr-code\\\"></div>\\r\\n\";\n  }\n\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.uniqid), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.logo), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <h1>\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h1>\\r\\n\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.subtitle), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.date), {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.qrcode), {hash:{},inverse:self.noop,fn:self.program(9, program9, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiPrint/runner/tpl/pageSection', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n<div>\";\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</div>\\r\\n\";\n  return buffer;\n  }\n\n  buffer += \"<h2>\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h2>\\r\\n\";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.rubricBlock), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiPrint/runner/tpl/pageBlock', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<section class=\\\"grid-row \";\n  if (helper = helpers.type) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.type); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></section>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n * @author Jean-Sbastien Conan <jean-sebastien@taotesting.com>\r\n */\r\ndefine('taoQtiPrint/runner/testRenderers',[\r\n    'jquery',\r\n    'lodash',\r\n    'util/url',\r\n    'taoQtiPrint/runner/itemRunner',\r\n    'taoItems/assets/strategies',\r\n    'taoQtiPrint/lib/qrcode',\r\n    'tpl!taoQtiPrint/runner/tpl/pageTest',\r\n    'tpl!taoQtiPrint/runner/tpl/pageSection',\r\n    'tpl!taoQtiPrint/runner/tpl/pageBlock'\r\n], function ($,\r\n             _,\r\n             urlHelper,\r\n             itemRunner,\r\n             assetStrategies,\r\n             QRCode,\r\n             pageTestTpl,\r\n             pageSectionTpl) {\r\n    'use strict';\r\n\r\n    /**\r\n     * Defines renderers for each blocks in the printed test\r\n     * @typedef {testRenderers}\r\n     */\r\n    return {\r\n\r\n        /**\r\n         * Renders a block that represents a cover page\r\n         * @param {jQuery} $container - The container in which renders the block\r\n         * @param {Object} test - The test definition\r\n         * @param {Object} options - The print options\r\n         * @param {Function} done - A callback to call when the block is fully rendered\r\n         */\r\n        testPage: function testPage($container, test, options, done) {\r\n            var coverPageOptions = options && options.cover_page || {};\r\n\r\n            $(pageTestTpl({\r\n                title: coverPageOptions['title'] && test.title,\r\n                subtitle: coverPageOptions['description'] && options.description,\r\n                qrcode: coverPageOptions['qr_code'],\r\n                logo: coverPageOptions['logo'] && options.logo,\r\n                date: coverPageOptions['date'] && options.date,\r\n                uniqid: coverPageOptions['unique_id'] && options.unique_id\r\n            })).appendTo($container);\r\n\r\n            if (coverPageOptions['qr_code']) {\r\n                new QRCode($('.qr-code', $container).get(0), {\r\n                    text: coverPageOptions['qr_code_data'] || urlHelper.route('render', 'PrintTest', 'taoBooklet', {uri: options.uri}),\r\n                    width: 192,\r\n                    height: 192,\r\n                    colorDark: \"#000000\",\r\n                    colorLight: \"#ffffff\",\r\n                    correctLevel: QRCode.CorrectLevel.H\r\n                });\r\n            }\r\n\r\n            done();\r\n        },\r\n\r\n        /**\r\n         * Renders a block that represents a section of the test\r\n         * @param {jQuery} $container - The container in which renders the block\r\n         * @param {Object} section - The section definition\r\n         * @param {Function} done - A callback to call when the block is fully rendered\r\n         */\r\n        sectionPage: function sectionPage($container, section, done) {\r\n\r\n            $(pageSectionTpl({\r\n                title: section.title,\r\n                rubricBlock: section.rubricBlock\r\n            })).appendTo($container);\r\n\r\n            done();\r\n        },\r\n\r\n        /**\r\n         * Renders a block that represents an item of the test\r\n         * @param {jQuery} $container - The container in which renders the block\r\n         * @param {Object} itemRef - The item definition\r\n         * @param {Object} itemState - The responses of the item\r\n         * @param {String} uri - The URI of the item\r\n         * @param {Function} done - A callback to call when the block is fully rendered\r\n         */\r\n        itemPage: function itemPage($container, itemRef, itemState, uri, done) {\r\n            var item = itemRef.data;\r\n            var assets = itemRef.assets;\r\n            var baseUrl = itemRef.baseUrl || urlHelper.route('getFile', 'QtiCreator', 'taoQtiItem', {\r\n                uri: uri,\r\n                lang: 'en-US'\r\n            }) + '&relPath=';\r\n            var isDone = false;\r\n\r\n            /**\r\n             * @param [err]\r\n             */\r\n            function itemDone(err) {\r\n                if (!isDone) {\r\n                    isDone = true;\r\n                    done(err);\r\n                }\r\n            }\r\n\r\n            itemRunner('qtiprint', item, {\r\n                    renderer: itemRef.renderer,\r\n                    showResponseIdentifier: itemRef.showResponseIdentifier\r\n                })\r\n                .on('error', function (err) {\r\n                    itemDone(err);\r\n                })\r\n                .on('init', function () {\r\n                    if (itemState && _.isPlainObject(itemState)) {\r\n                        this.setState(itemState);\r\n                    }\r\n                    this.render($container);\r\n                })\r\n                .on('ready', function () {\r\n                    itemDone();\r\n                })\r\n                .assets([\r\n                    {\r\n                        name: 'base64package',\r\n                        handle: function handleBase64(url) {\r\n                            var id = url.file;\r\n                            var found = _.find(assets, function (assetsList) {\r\n                                var asset = assetsList[id];\r\n                                return !!(asset && urlHelper.isBase64(asset));\r\n                            });\r\n                            if (found) {\r\n                                return found[id];\r\n                            }\r\n                        }\r\n                    },\r\n                    assetStrategies.taomedia,\r\n                    assetStrategies.external,\r\n                    assetStrategies.baseUrl\r\n                ], {\r\n                    baseUrl: baseUrl\r\n                })\r\n                .init();\r\n        }\r\n    };\r\n});\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015-2017 (original work) Open Assessment Technologies SA;\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiPrint/runner/testRunner',[\r\n    'jquery',\r\n    'lodash',\r\n    'async',\r\n    'core/eventifier',\r\n    'taoQtiPrint/runner/testRenderers',\r\n    'tpl!taoQtiPrint/runner/tpl/pageBlock'\r\n], function ($,\r\n             _,\r\n             asyncLib,\r\n             eventifier,\r\n             testRenderers,\r\n             pageBlockTpl) {\r\n    'use strict';\r\n\r\n    /**\r\n     *\r\n     * Builds a brand new {@link TestRunner}.\r\n     *\r\n     * <strong>The factory is an internal mechanism to create encapsulated contexts.\r\n     *  I suggest you to use directly the name <i>testRunner</i> when you require this module.</strong>\r\n     *\r\n     *\r\n     * @exports testRunner\r\n     * @namespace testRunnerFactory\r\n     *\r\n     *\r\n     * @returns {testRunner}\r\n     */\r\n    var testRunnerFactory = function testRunnerFactory(testDefinitions, options) {\r\n        var layoutOptions = options && options.layout || {};\r\n        var $container;\r\n\r\n        /**\r\n         * Creates a container for a test block\r\n         * @param {String} type\r\n         * @returns {jQuery}\r\n         */\r\n        function createPage(type) {\r\n            var $pageBlock = $(pageBlockTpl({type: type}));\r\n            $container.append($pageBlock);\r\n            return $pageBlock;\r\n        }\r\n\r\n        if (!testDefinitions) {\r\n            throw new Error('Invalid test data structure');\r\n        }\r\n\r\n        if (!_.isArray(testDefinitions)) {\r\n            testDefinitions = [testDefinitions];\r\n        }\r\n\r\n        _.forEach(testDefinitions, function(testDefinition) {\r\n            if (!testDefinition) {\r\n                throw new Error('Invalid test data structure: definition is empty');\r\n            }\r\n            if (!testDefinition.data) {\r\n                throw new Error('Invalid test data structure: data is missing');\r\n            }\r\n            if (!testDefinition.items) {\r\n                throw new Error('Invalid test data structure: items is missing');\r\n            }\r\n        });\r\n\r\n        /**\r\n         * @typedef {testRunner}\r\n         */\r\n        return eventifier({\r\n            /**\r\n             * Makes the rendering of the full test.\r\n             *\r\n             * @param {HTMLElement|jQueryElement} elt - the DOM element that is going to contain the rendered test.\r\n             * @returns {testRunner} to chain calls\r\n             *\r\n             * @fires testRunner#ready\r\n             * @fires testRunner#render\r\n             * @fires testRunner#error if the elt isn't valid\r\n             */\r\n            render: function render(elt) {\r\n                var self = this;\r\n                var pageRenderers = [];\r\n\r\n                //check elt\r\n                if (!(elt instanceof HTMLElement) && !(elt instanceof $)) {\r\n                    return self.trigger('error', 'A valid HTMLElement (or a jquery element) at least is required to render the test');\r\n                }\r\n\r\n                //we keep a reference to the container\r\n                if (elt instanceof $) {\r\n                    $container = elt;\r\n                } else {\r\n                    $container = $(elt);\r\n                }\r\n                $container.empty();\r\n\r\n                //dummy rtl support from options\r\n                if (options && options.rtl === true) {\r\n                    $container.addClass('rtl').attr('dir', 'rtl');\r\n                }\r\n\r\n                //Build the pageRenderers array that contains each page to render\r\n                //Transform the functions of the renderer to fit the format required by async (partial with data and binding)\r\n                _.forEach(testDefinitions, function(testDefinition) {\r\n                    var testData = testDefinition.data || {};\r\n                    var items = testDefinition.items || {};\r\n                    var states = testDefinition.states || {};\r\n\r\n                    if (layoutOptions['cover_page']) {\r\n                        pageRenderers.push(\r\n                            _.partial(testRenderers.testPage, createPage('title'), testData, options)\r\n                        );\r\n                    }\r\n\r\n                    _.forEach(testData.testParts, function (testPart) {\r\n                        _.forEach(testPart.sections, function (section) {\r\n                            pageRenderers.push(\r\n                                _.partial(testRenderers.sectionPage, createPage('section'), section)\r\n                            );\r\n\r\n                            _.forEach(section.items, function (item) {\r\n                                var itemRef = items[item.href];\r\n                                var itemState = states[item.href];\r\n\r\n                                if (itemRef && itemRef.data) {\r\n                                    itemRef.renderer = 'booklet';\r\n\r\n                                    if(options.regular) {\r\n                                        itemRef.renderer = 'results';\r\n                                    }\r\n                                    else if(options.layout && options.layout.use_bubble_sheet) {\r\n                                        itemRef.renderer = 'bubbleSheet';\r\n                                    }\r\n\r\n                                    if(options && options.layout && options.layout.show_response_identifier){\r\n                                        itemRef.showResponseIdentifier = true;\r\n                                    }\r\n                                    pageRenderers.push(\r\n                                        _.partial(testRenderers.itemPage, createPage('item'), itemRef, itemState, item.href)\r\n                                    );\r\n                                }\r\n                            });\r\n                        });\r\n                    });\r\n                });\r\n\r\n                //then we call all the renderers in parallel\r\n                asyncLib.parallel(pageRenderers, function renderingDone(err) {\r\n                    if (err) {\r\n                        self.trigger('error', 'An error occurred while rendering a page :  ' + err);\r\n                    }\r\n\r\n                    /**\r\n                     * The test is rendered\r\n                     * @event TestRunner#render\r\n                     */\r\n                    self.trigger('render');\r\n\r\n                    /**\r\n                     * The test is ready.\r\n                     * Alias of {@link TestRunner#render}\r\n                     * @event TestRunner#ready\r\n                     */\r\n                    self.trigger('ready');\r\n                });\r\n\r\n                return this;\r\n            },\r\n\r\n            /**\r\n             * Clears the running test.\r\n             * @returns {testRunner}\r\n             *\r\n             * @fires testRunner#clear\r\n             */\r\n            clear: function clear() {\r\n\r\n                $container.empty();\r\n\r\n                /**\r\n                 * The test is ready.\r\n                 * @event TestRunner#clear\r\n                 */\r\n                this.trigger('clear');\r\n\r\n                return this;\r\n            }\r\n        });\r\n    };\r\n\r\n    return testRunnerFactory;\r\n});\r\n\n","\ndefine('tpl!taoBooklet/tpl/print', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<main class=\\\"tao-scope \";\n  if (helper = helpers.cls) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.cls); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></main>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015-2017 (original work) Open Assessment Technologies SA;\r\n */\r\n\r\n/**\r\n *\r\n * This controller renders a printable test in the current page.\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoBooklet/controller/PrintTest/render',[\r\n    'jquery',\r\n    'lodash',\r\n    'core/logger',\r\n    'taoQtiPrint/runner/testRunner',\r\n    'tpl!taoBooklet/tpl/print'\r\n], function ($, _, loggerFactory, testRunner, printTpl) {\r\n    'use strict';\r\n\r\n    var logger = loggerFactory('printTest/render');\r\n\r\n    /**\r\n     * Old school way to debug document, especially when generated in PDF.\r\n     * It appends the message to the body.\r\n     * @param {String} msg - the content to display\r\n     * @param {String} type - the type of message\r\n     */\r\n    function showMessage(msg, type) {\r\n        type = type || 'info';\r\n        $('body').append('<div class=\"feedback-' + type + '\">' + msg + '</div>');\r\n    }\r\n\r\n    /**\r\n     * Hack the current layout to match arbitrary rules\r\n     */\r\n    function printLayoutHacking($container) {\r\n\r\n        var threshold = 6000;   //this height seems to work - value is empirical and linked to the A4 page layout with 300 DPI\r\n        var pages = 2;          //start on page 2\r\n        var previous;           //keep a ref to the previous section\r\n\r\n        //add a blank page\r\n        var blankPage = function blankPage($section) {\r\n            $section.before('<div class=\"breaker\"></div>');\r\n            pages++;\r\n        };\r\n\r\n        //add pages based on the given height\r\n        var computePageFromHeight = function computePageFromHeight(height) {\r\n            if (height > threshold) {\r\n                pages += Math.ceil(height / threshold) - 1;\r\n            }\r\n        };\r\n\r\n        //browse direct section add apply the odd/even rules for section and items\r\n        $container.children('section').each(function () {\r\n            var $section = $(this);\r\n            var height;\r\n\r\n            if ($section.hasClass('section')) {\r\n\r\n                if (pages % 2 === 0) {\r\n                    blankPage($section);\r\n                }\r\n\r\n                computePageFromHeight($section.outerHeight());\r\n\r\n                previous = 'section';\r\n                pages++;\r\n            }\r\n            if ($section.hasClass('item')) {\r\n                if (previous !== 'item') {\r\n\r\n                    if (pages % 2 !== 0) {\r\n                        blankPage($section);\r\n                    }\r\n\r\n                    height = $section.outerHeight();\r\n                    $section.nextUntil('.section', '.item').each(function () {\r\n                        height += $(this).outerHeight();\r\n                    });\r\n                    computePageFromHeight(height);\r\n\r\n                    pages++;\r\n                }\r\n                previous = 'item';\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * The renderer controller\r\n     * @exports taoBooklet/controller/printTest/render\r\n     */\r\n    return {\r\n\r\n        /**\r\n         * Controller entry point\r\n         * @param {Object} testData - the packed test data required by the testRunner\r\n         * @param {Object} options\r\n         */\r\n        start: function start(testData, options) {\r\n\r\n            var layoutOptions = options && options.layout || {};\r\n            var layoutClasses = {\r\n                'one_page_item': 'one-item-per-page',\r\n                'one_page_section': 'one-section-per-page'\r\n            };\r\n\r\n            //this is just in case something went wrong, but we weren't able to catch it.\r\n            var timeout = setTimeout(function () {\r\n                showMessage(\"Something went wrong...\", 'error');\r\n                ready();\r\n            }, 45 * 1000);\r\n\r\n            //the content will be inserted in a detached element (to save time)\r\n            var $mainContainer = $(printTpl({\r\n                cls: _.reduce(layoutOptions, function (list, value, name) {\r\n                    if (value && layoutClasses[name]) {\r\n                        list.push(layoutClasses[name]);\r\n                    }\r\n                    return list;\r\n                }, []).join(' ')\r\n            }));\r\n\r\n            /**\r\n             * As the page can be called by an external tool and\r\n             * as we build the page in JS asynchronously, we need this hack\r\n             * to tell the 3rd part tool that the page is ready.\r\n             */\r\n            function ready() {\r\n                window.status = 'DONE';\r\n            }\r\n\r\n            //we attach the container to the DOM\r\n            $('body').append($mainContainer);\r\n\r\n            //instantiate the TestRunner\r\n            testRunner(testData, options)\r\n                .on('error', function (e) {\r\n                    logger.error(e);\r\n                    showMessage(e, 'error');\r\n                    ready();\r\n                })\r\n                .on('ready', function () {\r\n\r\n                    //hack layout calculation\r\n                    if (layoutOptions['add_blank_pages']) {\r\n                        printLayoutHacking($mainContainer);\r\n                    }\r\n\r\n                    clearTimeout(timeout);\r\n\r\n                    //we are done\r\n                    ready();\r\n                })\r\n                .render($mainContainer);\r\n        }\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\r\n */\r\n/**\r\n * @author Jean-Sbastien Conan <jean-sebastien@taotesting.com>\r\n */\r\ndefine('taoBooklet/component/taskQueue',[\r\n    'jquery',\r\n    'lodash',\r\n    'util/url',\r\n    'ui/taskQueue/table'\r\n], function ($, _, urlHelper, taskQueueTableFactory) {\r\n    'use strict';\r\n\r\n    var defaults = {\r\n        rows: 10,\r\n        dataUrl: urlHelper.route('getTasks', 'TaskQueueData', 'taoBooklet'),\r\n        statusUrl: urlHelper.route('getStatus', 'TaskQueueData', 'taoBooklet'),\r\n        removeUrl: urlHelper.route('archiveTask', 'TaskQueueData', 'taoBooklet')\r\n    };\r\n\r\n    /**\r\n     * Renders a booklet task queue table component\r\n     * @param {String} queueId\r\n     * @param {jQuery} $container\r\n     * @param {Object} [config]\r\n     * @returns {taskQueueTable}\r\n     */\r\n    function bookletTaskQueue(queueId, $container, config) {\r\n        var taskQueue = taskQueueTableFactory(_.merge({context: queueId}, config || {}, defaults));\r\n\r\n        taskQueue.init()\r\n            .render($container);\r\n\r\n        return taskQueue;\r\n    }\r\n\r\n    return bookletTaskQueue;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoBooklet/controller/Results/printWizard',[\r\n    'jquery',\r\n    'lodash',\r\n    'ui/hider',\r\n    'util/url',\r\n    'report',\r\n    'taoBooklet/component/taskQueue',\r\n    'jquery.fileDownload'\r\n], function ($, _, hider, urlHelper, report, taskQueueTableFactory) {\r\n    'use strict';\r\n\r\n    return {\r\n        start: function () {\r\n            var $header = $('header.section-header');\r\n            var $formContainer = $('.print-form');\r\n            var $reportContainer = $('.print-report');\r\n            var $form = $('form', $formContainer);\r\n            var $submitter = $('.form-submitter', $form);\r\n            var $sent = $(\":input[name='\" + $form.attr('name') + \"_sent']\", $form);\r\n            var asyncQueue = $header.data('async-queue');\r\n            var $containers = $('.main-container');\r\n\r\n            function switchContainer(purpose) {\r\n                hider.hide($containers);\r\n                hider.show($containers.filter('[data-purpose=\"' + purpose + '\"]'));\r\n            }\r\n\r\n            function refreshTree() {\r\n                $('.tree').trigger('refresh.taotree', [{\r\n                    uri : $header.data('select-node')\r\n                }]);\r\n            }\r\n\r\n            function displayReport(response) {\r\n                switchContainer('report');\r\n                $reportContainer.append(response);\r\n                $submitter.removeAttr('disabled');\r\n\r\n                // Fold action (show detailed report)\r\n                hider.toggle($('#fold', $reportContainer), response.nested);\r\n                $('#fold > input[type=\"checkbox\"]', $reportContainer).on('click', function() {\r\n                    report.fold();\r\n                });\r\n\r\n                // Continue button\r\n                $('#import-continue', $reportContainer).on('click', refreshTree);\r\n            }\r\n\r\n            switchContainer('form');\r\n\r\n            //overwrite the submit behaviour\r\n            $submitter.off('click').on('click', function (e) {\r\n                var params = {};\r\n                var instances = [];\r\n                var classes = [];\r\n\r\n                $submitter.attr('disabled', true);\r\n\r\n                e.preventDefault();\r\n                if (parseInt($sent.val(), 10)) {\r\n                    // prepare download params\r\n                    _.forEach($form.serializeArray(), function (param) {\r\n                        if (param.name.indexOf('instances_') === 0) {\r\n                            instances.push(param.value);\r\n                        } else if (param.name.indexOf('classes_') === 0) {\r\n                            classes.push(param.value);\r\n                        } else {\r\n                            params[param.name] = param.value;\r\n                        }\r\n                    });\r\n                    params.instances = encodeURIComponent(JSON.stringify(instances));\r\n                    params.classes = encodeURIComponent(JSON.stringify(classes));\r\n\r\n                    if (asyncQueue) {\r\n                        // display report after form submit\r\n                        $.ajax({\r\n                            url: $form.attr('action'),\r\n                            data: params,\r\n                            type: 'POST',\r\n                            dataType: \"text\"\r\n                        }).done(displayReport);\r\n                    } else {\r\n                        // download file after form submit\r\n                        $.fileDownload($form.attr('action'), {\r\n                            httpMethod: 'POST',\r\n                            data: params,\r\n                            failCallback: displayReport,\r\n                            successCallback: refreshTree\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n\r\n            if (asyncQueue) {\r\n                taskQueueTableFactory($header.data('queue'), $containers.filter('.print-tasks'), {\r\n                    downloadUrl: urlHelper.route('downloadTask', 'TaskQueueData', 'taoBooklet')\r\n                });\r\n            }\r\n        }\r\n    };\r\n});\r\n\n"]}