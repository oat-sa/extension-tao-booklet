{"version":3,"file":"routes.js","sources":["routes.js","Booklet/editBooklet.js","Booklet/preview.js","Booklet/wizard.js","../../taoItems/runner/api/itemRunner.js","../../taoQtiItem/qtiItem/core/qtiClasses.js","../../taoQtiItem/qtiItem/helper/util.js","../../taoQtiItem/qtiItem/helper/rendererConfig.js","../../taoQtiItem/qtiItem/core/Element.js","../../taoQtiItem/qtiItem/core/Loader.js","../../taoQtiItem/qtiItem/helper/interactionHelper.js","../../taoQtiItem/qtiRunner/core/Renderer.js","../../taoQtiPrint/qtiPrintRenderer/renderers/config.js","../../taoQtiPrintCss/qti!css","../../taoQtiPrint/qtiPrintRenderer/renderers/Renderer.js","../../taoQtiPrint/runner/provider/qtiprint.js","../../taoQtiPrint/runner/itemRunner.js","../../taoQtiPrint/lib/qrcode.js","../../taoQtiPrint/runner/testRunner.js","printtest/render.js"],"names":[],"mappings":"AAqBA,OAAA,kCAAA,WAGA,OACA,SACA,SACA,YAAA,iCACA,OAAA,4BACA,QAAA,kCCXA,OAAA,6CAAA,SAAA,SAAA,SAAA,UAAA,sBAAA,kBAAA,SAAA,EAAA,EAAA,OAAA,QAAA,uBAAA,SAOA,QAAA,iBAAA,YAEA,GAAA,aAAA,WAAA,OAEA,WAAA,SAAA,KACA,WAAA,OAAA,MAAA,YAAA,YAGA,OAAA,EAAA,UAAA,YAAA,eAAA,KAEA,YAAA,OAAA,OAAA,YAAA,OAEA,OAAA,GAAA,SAAA,SAAA,GACA,WAAA,EAAA,EAAA,QAAA;GAGA,GAAA,wBAAA,IAAA,YAAA,SAAA,QAAA,QAAA,KAAA,UAAA,cAAA,QACA,SAAA,YAAA,SACA,QAAA,YAAA,QACA,UACA,YAAA,YAAA,YACA,YAAA,YAAA,aAEA,aAAA,YAAA,aACA,kBACA,UAAA,YAAA,UACA,SAAA,YAAA,UAEA,aAAA,WACA,QACA,UACA,iBACA,QAAA,KAAA,cAAA,UAAA,eACA,IAAA,YAAA,eAGA,SAAA,KAIA,OACA,MAAA,WAEA,GAAA,aAAA,EAAA,aAAA,MACA,GAAA,QAAA,OAAA,aAEA,EAAA,iBAAA,GAAA,QAAA,SAAA,GACA,EAAA,gBACA;GAAA,OAAA,EAAA,EAAA,QAAA,QAAA,OAEA,aAAA,KAAA,MAAA,QAAA,KAAA,WAAA,UAAA,cACA,IAAA,MAAA,KAAA,qBAAA,MACA,SAAA,MAAA,KAAA,0BAAA,MACA,GAAA,MAAA,KAAA,oBAAA,WAIA,gBAAA,EAAA,yBC5DA,OAAA,yCAAA,UAAA,SAAA,GAGA,OACA,MAAA,WAGA,GAAA,QAAA,EAAA,iBACA,WAAA,OAAA,QAAA,qBACA,QAAA,IAAA,aAAA,WAAA,SAAA,GAAA,UCbA,OAAA,wCAAA,UAAA,SAAA,GAGA,OACA,MAAA,WAEA,GAAA,OAAA,EAAA,oBAAA,KAAA,QAEA,OAAA,EAAA,UAAA,MAAA,KAAA,mBAAA,MAAA,KACA;OAAA,GAAA,aACA,OAAA,OAAA,UAAA,KAAA,WAAA,OCNA,OAAA,kCAAA,SAAA,UAAA,SAAA,EAAA,GAiCA,GAAA,mBAAA,QAAA,mBAAA,aAAA,KAAA,SAGA,EAAA,cAAA,gBACA,KAAA,aACA,aAAA,QAEA,KAAA,QAGA,IAkBA,UAlBA,UAGA,MACA,MACA,MAAA,EACA,YAEA,QACA,MAAA,EACA,aASA,UAAA,kBAAA,SAGA,KAAA,WAAA,IAAA,EAAA,KAAA,WACA,KAAA,IAAA,OAAA,wBAaA,IAVA,EAAA,SAAA,eAAA,aAAA,OAAA,EACA,SAAA,UAAA,cACA,IAAA,EAAA,KAAA,aAGA,aAAA,EAAA,KAAA,WAAA,GACA,SAAA,UAAA,gBAIA,SACA,KAAA,IAAA,OAAA,sCAaA;GAAA,aAMA,UAAA,KAEA,QAAA,YASA,KAAA,SAAA,SACA,GAAA,MAAA,KAKA,SAAA,WAGA,KAAA,KAAA,QAAA,IACA,KAAA,KAAA,MAAA,EAEA,EAAA,QAAA,KAAA,KAAA,QAAA,SAAA,aACA,EAAA,WAAA,cACA,YAAA,KAAA,QAGA,KAAA,KAAA,YAOA,KAAA,QAAA,QAsBA,OAlBA,WACA,KAAA,EAAA,MAAA,KAAA,UAGA,EAAA,WAAA,SAAA,MAQA,SAAA,KAAA,KAAA,KAAA,KAAA,UAGA,WAGA,MAgBA,OAAA,SAAA,KACA,GAAA,MAAA,KAKA,WAAA,WAGA,KAAA,OAAA,QAAA,IACA,KAAA,OAAA,MAAA,EAEA,EAAA,QAAA,KAAA,OAAA,QAAA,SAAA,aACA,EAAA,WAAA,cACA,YAAA,KAAA,QAGA,KAAA,OAAA,YAOA,KAAA,QAAA,UAOA,KAAA,QAAA;CAIA,OAAA,eAAA,cAAA,cAAA,IAIA,KAAA,KAAA,QAAA,EACA,KAAA,KAAA,QAAA,KAAA,WACA,KAAA,OAAA,QAMA,KAAA,UADA,cAAA,GACA,IAAA,IAAA,GAEA,IAKA,EAAA,WAAA,SAAA,QAQA,SAAA,OAAA,KAAA,KAAA,KAAA,UAAA,YAGA,cAIA,MAjCA,KAAA,QAAA,QAAA,sFA0CA,MAAA,WACA,GAAA,MAAA,KAKA,UAAA,WAQA,KAAA,QAAA,SAgBA,OAdA,GAAA,WAAA,SAAA,OAQA,SAAA,MAAA,KAAA,KAAA,KAAA,UAAA,WAGA,YAGA,MAQA,SAAA,WACA,GAAA,OAAA,IAUA,OATA,GAAA,WAAA,SAAA,YAOA,MAAA,SAAA,SAAA,KAAA,OAEA;EAYA,SAAA,SAAA,OAEA,MAAA,GAAA,cAAA,QAKA,KAAA,OAAA,QAAA,EACA,KAAA,OAAA,QAAA,KAAA,WACA,KAAA,SAAA,SAIA,EAAA,WAAA,SAAA,WAOA,SAAA,SAAA,KAAA,KAAA,OAGA,MApBA,KAAA,QAAA,QAAA,6DAAA,OAAA,WA4BA,aAAA,WACA,GAAA,aAUA,OATA,GAAA,WAAA,SAAA,gBAOA,UAAA,UAAA,OAAA,SAAA,aAAA,KAAA,QAEA,WAiBA,GAAA,SAAA,KAAA,SAKA,MAJA,GAAA,SAAA,OAAA,EAAA,WAAA,WACA,OAAA,MAAA,OAAA,UACA,OAAA,MAAA,KAAA,UAEA,MAWA,IAAA,SAAA,MAIA,MAHA,GAAA,SAAA,QACA,OAAA,UAEA;EAYA,QAAA,SAAA,KAAA,MACA,GAAA,MAAA,IAMA,OALA,GAAA,SAAA,OAAA,EAAA,QAAA,OAAA,QACA,EAAA,QAAA,OAAA,MAAA,SAAA,OACA,MAAA,KAAA,KAAA,QAGA,MAIA,OAAA,YAgCA,OAbA,mBAAA,SAAA,SAAA,KAAA,UAEA,IAAA,EAAA,SAAA,OAAA,KAAA,QAAA,EACA,KAAA,IAAA,WAAA,kDAEA,KAAA,EAAA,cAAA,YAAA,EAAA,WAAA,SAAA,QAAA,EAAA,WAAA,SAAA,QACA,KAAA,IAAA,WAAA,wFAGA,MAAA,UAAA,KAAA,cACA,KAAA,UAAA,MAAA,UAGA,oBAGA,OCtdA,wCAAA,WACA,OACA,WAAA,oCACA,eAAA,+BACA,mBAAA,6CACA,oBAAA,sDACA,WAAA,qCACA,KAAA,+BACA,IAAA,8BACA,OAAA,iCACA,mBAAA,uDACA,oBAAA,wDACA,YAAA,sCACA,kBAAA,oDACA,IAAA,sCACA,OAAA,yCACA,QAAA,0CACA,cAAA,gDACA,QAAA,0CACA,aAAA,+CACA,uBAAA,yDACA,aAAA,+CACA,qBAAA,4DACA,kBAAA,yDACA,sBAAA,6DACA,wBAAA,+DACA,oBAAA,2DACA,4BAAA,mEACA,2BAAA,kEACA,wBAAA,+DACA,mBAAA,0DACA,mBAAA,0DACA,wBAAA,+DACA,iBAAA,wDACA,iBAAA,wDACA,iBAAA,wDACA,OAAA,8CACA,uBAAA,8DACA,kBAAA,yDACA,qBAAA,4DACA,kBAAA,yDACA,cAAA,kDACA,eAAA,mDACA,cAAA,kDACA,kBAAA,yDACA,YAAA;GC1CA,OAAA,kCAAA,UAAA,SAAA,GACA,GAAA,OACA,YAAA,SAAA,QAGA,IAAA,GAFA,IAAA,QAAA,GACA,MAAA,uCACA,EAAA,EAAA,GAAA,EAAA,IACA,IAAA,MAAA,OAAA,KAAA,MAAA,KAAA,SAAA,MAAA,QAEA,OAAA,KAEA,SAAA,SAAA,IAAA,SAmBA,MAjBA,KAAA,KAAA,GACA,QAAA,SAAA,GAEA,MAEA,IAAA,IAAA,QAAA,MAAA,IAEA,IAAA,MAAA,YAEA,UAAA,QAAA,MAAA,SACA,SAAA,KAGA,IAAA,QAAA,MAIA,KAEA,iBAAA,SAAA,QAAA,gBAAA,gBAEA,GAAA,OAAA,IAMA,IAJA,EAAA,SAAA,mBACA,iBAAA,mBAGA,EAAA,QAAA,iBAoCA,KAAA,IAAA,OAAA,kEAGA;MArCA,GAAA,KAAA,gBAAA,SAAA,gBAGA,GAAA,YAAA,OACA,GAAA,KAAA,eAAA,MAAA,KAAA,SAAA,WACA,WAAA,WAAA,YAEA,IAAA,KAAA,WAAA,eAEA,OAAA,MACA,OAAA,OAAA,QAAA,QAAA,MACA,IAIA,EAAA,KAAA,WAAA,SAAA,KAEA,MAAA,GAAA,WAAA,IAAA,QACA,MAAA,IAAA,KAAA,kBAEA,EAHA,SASA,OACA,EADA,UAWA,OAEA,mBAAA,SAAA,OAAA,IACA,MAAA,IACA,OAAA,OAAA,QAAA,gCAAA,MAAA,GAAA,YAGA,QAGA,uBAAA,SAAA,QACA,MAAA,QAAA,QAAA,wBAAA,WAEA,wBAAA,SAAA,QACA,GAAA,cAKA;MAJA,QAAA,QAAA,wBAAA,SAAA,SAAA,MAAA,GAAA,MAEA,MADA,YAAA,KAAA,IACA,IAAA,MAAA,KAAA,MAEA,EAAA,KAAA,aAIA,OAAA,QCxGA,OD0GA,4CAAA,SAAA,UAAA,SAAA,EAAA,GCxGA,GAAA,wBA8BA,OA5BA,sBAAA,wBAAA,SAAA,MAEA,GAAA,UACA,QACA,YAAA,KACA,SAAA,GACA,SAAA,KAmBA,OAhBA,GAAA,KAAA,KAAA,SAAA,KACA,MACA,IAAA,WACA,QAAA,SAAA,IACA,cAAA,IAAA,IAAA,OACA,QAAA,YAAA,IACA,EAAA,SAAA,KACA,QAAA,SAAA,IACA,EAAA,cAAA,KACA,QAAA,KAAA,IAEA,QAAA,IAAA,cAAA,IAAA,SAKA,SAGA;GChCA,ODmCA,mCAAA,SAAA,QAAA,SAAA,iCAAA,4CAAA,SAAA,EAAA,MAAA,EAAA,KAAA,gBCjCA,GAAA,eAEA,QAAA,MAAA,QACA,SAAA,GACA,OAAA,GACA,YAAA,KACA,KAAA,SAAA,OAAA,YAkBA,GAfA,KAAA,cAGA,KAAA,YAGA,gBAAA,UACA,WAAA,OACA,OAAA,IAGA,SACA,OAAA,KAAA,YAAA,KAAA,SAAA,MAGA,SAAA,gBAAA,UAAA,OAAA,MAAA,kBACA,KAAA,+BAAA,QAAA,KAAA,MAGA,IAAA,WAAA,QAKA,KAAA,qDAAA,MAJA,YAAA,QAAA,KACA,KAAA,OAAA,OACA,KAAA,cAAA,gBAKA,kBAAA,MAAA,eACA,KAAA,cAAA,UAAA,IAAA,IAEA,kBAAA,MAAA,YACA,KAAA;EAGA,GAAA,SAAA,UACA,MAAA,YAAA,KAAA,UAEA,YAAA,WACA,MAAA,KAAA,KAAA,OAAA,MAEA,UAAA,WACA,MAAA,MAAA,QAEA,mBAAA,WACA,GAAA,YACA,KAAA,KAAA,sBACA,KAAA,GAAA,KAAA,MAAA,CACA,GAAA,KAAA,KAAA,GACA,GAAA,IAAA,KAAA,aACA,MAEA,QAAA,IAAA,KAGA,MAAA,UAEA,KAAA,SAAA,KAAA,OACA,GAAA,KACA,GAAA,SAAA,MACA,KAAA,WAAA,MAAA,UAEA,IAAA,gBAAA,MACA,IAAA,GAAA,QAAA,MACA,KAAA,KAAA,KAAA,KAAA,WAEA,IAAA,gBAAA,MACA,MAAA,UAAA,KAAA,WAAA,MACA,OAEA,KAAA,WAAA,KAKA,OAAA,OAEA,KAAA,SAAA,KAAA,OACA,GAAA,KACA,GAAA,SAAA,MACA,KAAA,SAAA,MAAA,MACA,EAAA,UAAA,QAAA,yBAAA,QAAA,KAAA,IAAA,KAAA,MAAA;IAEA,IAAA,gBAAA,MACA,IAAA,GAAA,QAAA,MACA,KAAA,KAAA,KAAA,KAAA,WAEA,IAAA,gBAAA,MACA,MAAA,UAAA,KAAA,SAAA,MACA,OAEA,KAAA,SAAA,KAKA,OAAA,OAEA,WAAA,SAAA,MAEA,aADA,MAAA,SAAA,MACA,MAEA,WAAA,SAAA,MACA,MAAA,MAAA,iBAAA,OAEA,cAAA,SAAA,YAEA,MADA,MAAA,WAAA,WACA,MAEA,cAAA,WACA,MAAA,GAAA,MAAA,KAAA,aAEA,iBAAA,SAAA,WACA,gBAAA,aACA,WAAA,WAEA,KAAA,GAAA,KAAA,iBACA,MAAA,WAAA,UAAA,GAEA,OAAA,OAEA,qBAAA,WAEA,QAAA,QAAA,SACA,KAAA,QAAA,aAAA,QACA,KAAA,EAAA,OAAA,KAAA,QAAA;CAHA,GAAA,QAsBA,OAjBA,kBAAA,MAAA,eACA,OAAA,KAAA,WAEA,kBAAA,MAAA,YACA,OAAA,KAAA,aAEA,EAAA,KAAA,KAAA,SAAA,SAAA,GACA,QAAA,IAAA,EAAA,cACA,OAAA,GACA,EAAA,QAAA,IACA,EAAA,KAAA,EAAA,SAAA,GACA,QAAA,IAAA,EAAA,eACA,OAAA,OAKA,MAEA,eAAA,WAEA,GAAA,MAAA,KAAA,UACA,cAAA,KAAA,sBAMA,OAJA,GAAA,KAAA,cAAA,SAAA,KACA,IAAA,KAAA,IAAA,YAGA,EAAA,KAAA,MAEA,KAAA,SAAA,QAEA,GAAA,OAAA,IAEA,IAAA,kBAAA,MAAA,WAAA,CACA,GAAA,QAAA,KAAA,WACA,QAAA,SAAA,SACA,OAAA,OAAA,KAAA,QAAA,OAAA,SAAA,WAQA,MAJA,QAAA,kBAAA,MAAA,gBACA,MAAA,KAAA,UAAA,KAAA,OAAA,OAGA;EAEA,OAAA,WACA,GAAA,MAAA,KAAA,gBACA,IAAA,KAAA,CACA,GAAA,OAAA,KAAA,KAAA,KAAA,YACA,IAAA,MACA,MAAA,OAAA,OAGA,MAAA,OAEA,eAAA,SAAA,KAAA,WAIA,GAFA,UAAA,mBAAA,YAAA,EAAA,UAEA,QAAA,IAAA,KAAA,kBAAA,CACA,KAAA,YAAA,IACA,IAAA,eAAA,KAAA,sBACA,KAAA,GAAA,KAAA,eACA,cAAA,GAAA,eAAA,MAAA,KAKA,eAAA,WACA,GAAA,KAAA,IAIA,OAHA,SAAA,IAAA,KAAA,YAAA,oBACA,IAAA,KAAA,aAEA,KAEA,YAAA,SAAA,UACA,IAAA,WAAA,SAAA,WAOA,KAAA,8BANA,MAAA,SAAA,QACA,IAAA,MAAA,KAAA,sBACA;IAAA,GAAA,UAAA,MACA,KAAA,QAAA,YAAA,WAMA,YAAA,WACA,MAAA,MAAA,UAEA,OAAA,WAEA,GAAA,MAAA,eAAA,wBAAA,WACA,SAAA,KAAA,UAAA,KAAA,cAEA,WACA,aACA,IAAA,KAAA,SACA,OAAA,KAAA,OACA,WAAA,KAAA,gBAGA,KAAA,SACA,KAAA,6CAAA,KAAA,SAAA,IAAA,KAAA,MAGA,mBAAA,MAAA,gBACA,YAAA,KAAA,KAAA,UAAA,OAAA,WAEA,kBAAA,MAAA,aACA,YAAA,QACA,WAAA,KAAA,OAAA,iBAEA,YAAA,OAAA,WAAA,KAAA,SAAA,eAAA,KAAA,OAAA,KAAA,UAGA,QAAA,EAAA,MAAA,YAAA,KAAA,UACA,QAAA,SAAA,QAAA,KAAA,QAAA,KAAA,SACA;GAAA,WAAA,SAAA,UAAA,KAAA,QAAA,KAAA,SAKA,OAJA,MAAA,aACA,KAAA,YAAA,YAAA,WAGA,WAEA,WAAA,SAAA,KAAA,aAAA,UASA,GAPA,SAAA,UAAA,KAAA,cAEA,kBAAA,MAAA,eAEA,KAAA,UAAA,cAAA,GAAA,UAGA,SACA,MAAA,UAAA,WAAA,KAAA,KAAA,aAEA,MAAA,iDAAA,KAAA,SAAA,IAAA,KAAA,QAGA,aAAA,SAAA,OAAA,UACA,GAAA,UAAA,KAAA,aACA,IAAA,SACA,MAAA,UAAA,aAAA,KAAA,OAAA,SAEA,MAAA,mDAAA,KAAA,SAAA,IAAA,KAAA;EAGA,QAAA,WACA,GAAA,MACA,OAAA,KAAA,OACA,KAAA,KAAA,SACA,WAAA,KAAA,gBAUA,OAPA,kBAAA,MAAA,gBACA,IAAA,KAAA,KAAA,UAAA,WAEA,kBAAA,MAAA,aACA,IAAA,OAAA,KAAA,OAAA,WAGA,KAEA,QAAA,WAEA,OAAA,GAEA,SAAA,SAAA,WACA,GAAA,OAAA,KAAA,KAAA,UAAA,EACA,eAAA,MAAA,YACA,KAAA,KAAA,QAAA,OAAA,MAAA,OAAA,IAAA,IAAA,YAGA,SAAA,SAAA,WACA,MAAA,eAAA,KAAA,KAAA,SAAA,YAEA,YAAA,SAAA,WAEA,GAAA,OAAA,KAAA,KAAA,UAAA,EACA,IAAA,MAAA,CACA,GAAA,OAAA,GAAA,QAAA,YAAA,UAAA,YAAA,GACA,OAAA,MAAA,QAAA,MAAA,IAAA,QAAA,OAAA,IACA,MACA,KAAA,KAAA,QAAA,OAEA,KAAA,WAAA;GAIA,MAAA,WACA,MAAA,SAAA,aAAA,KAAA,SAEA,MAAA,WACA,MAAA,SAAA,aAAA,KAAA,WAIA,cAAA,SAAA,YAAA,WACA,GAAA,OAAA,GAAA,QAAA,YAAA,UAAA,YAAA,GACA,OAAA,cAAA,MAAA,KAAA,aAsCA,OAlCA,SAAA,IAAA,SAAA,WAAA,UACA,MAAA,sBAAA,UAAA,WAAA,GAAA,WAGA,QAAA,mBAAA,SAAA,QACA,MAAA,YAAA,SAGA,QAAA,aAAA,SAAA,QACA,QAAA,WAAA,SAQA,QAAA,aAAA,SAAA,QAEA,GAAA,SAAA,QAAA,mBAAA,OAEA,IAAA,QAAA,CAEA,GAAA,mBAAA,QAAA,sBAMA;MALA,GAAA,KAAA,kBAAA,SAAA,WACA,YAAA,IAAA,gBAEA,YAAA,QAAA,SAEA,EAEA,OAAA,GAGA,UCvXA,OAAA,kCAAA,SAAA,QAAA,qCAAA,mCAAA,SAAA,EAAA,MAAA,WAAA,SA2WA,QAAA,+BAAA,gBAAA,MACA,gBAAA,eAAA,KAAA,eACA,gBAAA,OAAA,KAAA,OACA,gBAAA,WAAA,KAAA,WACA,gBAAA,WAAA,KAAA,WACA,gBAAA,UAAA,KAAA,UA9WA,GAAA,QAAA,MAAA,QACA,KAAA,SAAA,KAAA,iBAEA,KAAA,OACA,KAAA,mBAEA,KAAA,KAAA,MAAA,KACA,KAAA,mBAAA,iBAAA;EAEA,mBAAA,SAAA,YAEA,MADA,GAAA,OAAA,KAAA,gBAAA,YACA,MAEA,mBAAA,SAAA,MACA,GAAA,OACA,KAAA,GAAA,KAAA,MACA,aAAA,GAAA,eAAA,KAAA,IAAA,gBAAA,EACA,IAAA,KAAA,KAAA,IACA,gBAAA,MAAA,IAAA,kBAAA,IACA,IAAA,EAAA,MAAA,IAAA,KAAA,mBAAA,KAAA,KAGA,OAAA,MAEA,oBAAA,SAAA,KAAA,SAAA,QAEA,GAAA,iBAAA,KAAA,mBAAA,KAAA,QAAA,WAEA,KAAA,GAAA,KAAA,iBAAA,CACA,GAAA,eAAA,gBAAA,EACA,KAAA,KAAA,gBAAA,eAGA,KAAA,IAAA,OAAA,4CAAA,cAFA,UAAA,KAAA,KAAA,gBAAA;CAMA,GAAA,OAAA,IACA,SAAA,SAAA,WACA,EAAA,KAAA,UAAA,SAAA,UACA,MAAA,IAAA,SAAA,UAAA,UAAA,WAEA,SAAA,KAAA,MAAA,MAAA,QAGA,iBAAA,WACA,MAAA,GAAA,KAAA,KAAA,MAEA,aAAA,SAAA,KAAA,UAEA,GAAA,OAAA,IACA,OAAA,oBAAA,KAAA,SAAA,KACA,GAAA,EACA,IAAA,gBAAA,OAAA,mBAAA,KAAA,SAAA,CAGA,KAAA,QACA,QAAA,aAAA,KAAA,QAGA,MAAA,KAAA,GAAA,KAAA,eAAA,KAAA,OAAA,KAAA,gBACA,MAAA,cAAA,MAAA,KAAA,UAAA,KAAA,KAEA,KAAA,IAAA,MAAA,SAAA,CACA,GAAA,SAAA,MAAA,aAAA,KAAA,SAAA,GACA,UACA,MAAA,KAAA,sBAAA;CAGA,IAAA,IAAA,MAAA,UAAA,CACA,GAAA,UAAA,MAAA,aAAA,KAAA,UAAA,GACA,WACA,MAAA,KAAA,iBAAA,UAGA,IAAA,IAAA,MAAA,YAAA,CACA,GAAA,YAAA,MAAA,aAAA,KAAA,YAAA,GACA,aACA,MAAA,KAAA,cAAA,YAKA,IAAA,IAAA,MAAA,UAAA,CACA,GAAA,UAAA,MAAA,cAAA,KAAA,UAAA,GACA,IAAA,SAAA,CACA,MAAA,KAAA,uBAAA,SAEA,IAAA,eAAA,KAAA,UAAA,GAAA,aACA,gBACA,EAAA,MAAA,cAAA,SAAA,OAAA,QACA,SAAA,cAAA,QAAA,MAAA,wBAAA,WAMA,KAAA,oBACA,MAAA,KAAA,sBAAA,MAAA,wBAAA,KAAA,qBAEA,MAAA,KAAA,cAAA,KAAA;CAGA,kBAAA,WACA,SAAA,KAAA,MAAA,MAAA,SAIA,YAAA,SAAA,KAAA,UAEA,GAAA,OAAA,IAEA,OAAA,oBAAA,KAAA,WAEA,GAAA,SAAA,MAAA,aAAA,KAEA,mBAAA,WACA,SAAA,KAAA,MAAA,YAYA,aAAA,SAAA,KAAA,UAEA,GAAA,OAAA,IAEA,KAAA,MAAA,KAqBA,KAAA,gDAnBA,MAAA,oBAAA,KAAA,WAEA,GAAA,aAAA,MAAA,KAAA,sBAEA,KAAA,GAAA,KAAA,MAAA,CACA,GAAA,aAAA,KAAA,EACA,cAAA,YAAA,UAAA,YAAA,QAEA,YAAA,YAAA,SACA,MAAA,gBAAA,YAAA,YAAA,QAAA,aAKA,kBAAA,WACA,SAAA,KAAA,MAAA,MAAA;IAQA,cAAA,SAAA,MAEA,GAAA,UAAA,KAAA,aAAA,KAgBA,OAdA,UAAA,SAAA,KAAA,UAAA,KACA,SAAA,aAAA,KAAA,cAAA,KACA,SAAA,gBAAA,KAAA,kBAAA,KAGA,SAAA,WADA,EAAA,KAAA,KAAA,SACA,KAAA,QACA,EAAA,KAAA,KAAA,aACA,KAAA,eAKA,SAAA,kBAAA,KAAA,sBAEA,UAEA,wBAAA,SAAA,MAEA,GAAA,cAAA,KAAA,aAAA,KAcA,OAZA,MAAA,YACA,aAAA,UAAA,KAAA,WAEA,KAAA,gBACA,aAAA,cAAA,KAAA,eAGA,aAAA,gBAAA,KAAA,KAAA,UAAA,KAAA,kBAAA,KACA,aAAA,gBAAA,KAAA,KAAA,SAAA,KAAA,kBAAA,KACA,aAAA,aAAA,KAAA,KAAA,eAAA,KAAA,eAAA,KACA,aAAA,aAAA,KAAA,KAAA,eAAA,KAAA,eAAA,KAEA;EAEA,aAAA,SAAA,MACA,GAAA,SAAA,KAAA,aAAA,KAEA,OADA,SAAA,aAAA,KAAA,cAAA,KACA,SAEA,wBAAA,SAAA,MACA,GAAA,IAAA,KAAA,aAAA,KASA,OARA,OAAA,KAAA,iBACA,WAAA,KAAA,gBACA,GAAA,IAAA,KAAA,KACA,GAAA,eAAA,UAEA,GAAA,eAAA,kBAGA,IAEA,cAAA,SAAA,WAAA,UACA,IAAA,QAAA,IAAA,WAAA,cACA,KAAA,oCAGA,KAAA,UAAA,gBAAA,UAAA,MAAA,eAAA,UAAA,UAAA,gBAAA,UAAA,SAWA,KAAA,uBAVA,KAAA,GAAA,UAAA,UAAA,SAAA,CACA,GAAA,SAAA,SAAA,SAAA,QAEA,QAAA,KAAA,aAAA,QACA;SACA,WAAA,WAAA,QAAA,SAAA,MAGA,WAAA,KAAA,SAAA,OAKA,aAAA,SAAA,aACA,GAAA,KAAA,IACA,MAAA,aAAA,YAAA,UAAA,YAAA,QASA,KAAA,0BARA,IAAA,WAAA,YAAA,QACA,KAAA,KAAA,IAAA,WAIA,KAAA,yCAAA,SAKA,OARA,KAAA,GAAA,MAAA,IAAA,WAAA,YAAA,QACA,KAAA,gBAAA,IAAA,aAOA,KAEA,gBAAA,SAAA,QAAA,MA0BA,MAxBA,SAAA,cAAA,EAAA,MAAA,KAAA,iBAEA,QAAA,MAAA,KAAA,MACA,QAAA,KACA,KAAA,cAAA,QAAA,UAAA,KAAA,MAIA,QAAA,QAAA,KAAA,QACA,QAAA,QACA,KAAA,eAAA,QAAA,OAAA,KAAA,QAIA,QAAA,IAAA,QAAA,eACA,KAAA,oBAAA,QAAA,MACA,QAAA,IAAA,QAAA,UACA,KAAA,eAAA,QAAA,MACA,QAAA,IAAA,QAAA,QACA,KAAA,aAAA,QAAA,MACA,QAAA,IAAA,QAAA,gBACA,KAAA,YAAA,QAAA,MAGA;EAEA,oBAAA,SAAA,YAAA,MACA,QAAA,IAAA,YAAA,qBACA,KAAA,QACA,KAAA,cAAA,YAAA,OAAA,UAAA,KAAA,QAIA,KAAA,wBAAA,YAAA,MAEA,QAAA,IAAA,YAAA,sBACA,KAAA,YAAA,YAAA,OAGA,wBAAA,SAAA,YAAA,MAGA,GAAA,KAAA,QAAA,CACA,GAAA,QAAA,IAAA,YAAA,oBACA,IAAA,GAAA,KAAA,EAAA,EAAA,IAAA,MAAA,CACA,IAAA,KAAA,QAAA,KACA,KAAA,sBAAA,GAEA,IAAA,UAAA,KAAA,QAAA,IACA,KAAA,GAAA,UAAA,UAAA,CACA,GAAA,QAAA,KAAA,aAAA,SAAA,QACA,SACA,YAAA,UAAA,OAAA,UAKA,KAAA,GAAA,UAAA,MAAA,QAAA,CACA,GAAA,QAAA,KAAA,aAAA,KAAA,QAAA,QACA;QACA,YAAA,UAAA,QAKA,GAAA,QAAA,IAAA,YAAA,+BACA,KAAA,QACA,IAAA,GAAA,UAAA,MAAA,QAAA,CACA,GAAA,QAAA,KAAA,aAAA,KAAA,QAAA,QACA,SACA,YAAA,UAAA,WASA,eAAA,SAAA,OAAA,MACA,QAAA,IAAA,OAAA,sBACA,OAAA,IAAA,KAAA,MACA,QAAA,IAAA,OAAA,WAEA,QAAA,IAAA,OAAA,oBAIA,eAAA,SAAA,OAAA,MACA,OAAA,cAAA,KAAA,YAEA,KAAA,OAEA,OAAA,KADA,WAAA,KAAA,KAAA,SACA,OAAA,aAAA,KAAA,MAEA,KAAA,OAIA,aAAA,SAAA,KAAA,MACA,KAAA,GAAA,KAAA,OACA,KAAA,UAAA,KAAA,QAAA,IACA,KAAA,YAAA,KAAA;EAEA,YAAA,SAAA,IAAA,MACA,8BAAA,IAAA,OAEA,YAAA,SAAA,IAAA,MACA,8BAAA,IAAA,QAYA,OAAA,UCjXA,OAAA,+CAAA,SAAA,mCAAA,SAAA,EAAA,SACA,OACA,eAAA,SAAA,QAAA,YAEA,GAAA,QAAA,MAAA,IAoBA,OAlBA,GAAA,KAAA,QAAA,SAAA,GACA,GAAA,QAAA,IAAA,EAAA,UACA,OAAA,YACA,IAAA,SACA,IAAA,KAAA,EAAA,YACA,MACA,KAAA,aACA,IAAA,KAAA,EAAA,KACA,MACA,SACA,IAAA,KAAA,OAGA,GAAA,QAAA,IACA,IAAA,KAAA,MAAA,eAAA,EAAA,eAIA,KAEA,YAAA,SAAA,YAAA,QAAA,WAEA,GAAA,QAAA,MAAA,IAyBA;MAvBA,GAAA,KAAA,QAAA,SAAA,GACA,GAAA,OACA,GAAA,SAAA,GACA,WAAA,WACA,OAAA,YAAA,UAAA,GACA,QACA,IAAA,KAAA,SAEA,eAAA,WACA,OAAA,YAAA,sBAAA,GACA,QACA,IAAA,KAAA,SAGA,IAAA,KAAA,GAGA,IAAA,KADA,EAAA,QAAA,GACA,MAAA,YAAA,YAAA,EAAA,WAEA,KAIA,KAEA,eAAA,SAAA,SACA,GAAA,MACA,KACA,EAAA,CAEA,KAAA,GAAA,KAAA,SAAA,CACA,IAAA,QAAA,IAAA,QAAA,GAAA,UAQA,KAAA,+CAPA,IAAA,QAAA,QAAA,EACA,QAAA,KAAA,WACA,EAAA,GAAA,QAEA,EAAA,KAAA,QACA,IAMA,IAAA,GAAA,GAAA,EAAA,EAAA,EAAA,OAAA,EAAA,IACA,IAAA,EAAA,GAAA,CAGA,GAAA,GAAA,EACA,GACA,GAAA,EAAA,KAAA,MAAA,KAAA,UAAA,EAAA,OAAA,UACA,EAAA,GACA;GAAA,KAAA,EAAA,EACA,GAAA,GAAA,EAAA,GACA,EAAA,GAAA,IAGA,MAAA,IAEA,mBAAA,SAAA,YAAA,cACA,GAAA,QAAA,YAAA,UAAA,aACA,OAAA,QACA,OAAA,KAEA,OCvEA,OAAA,sCACA,SACA,SACA,aACA,kCACA,+CACA,SAAA,EAAA,EAAA,WAAA,QAAA,mBA6GA,QAAA,sBACA,MAAA,QAAA,SAAA,SAAA,KAAA,OAAA,SAAA,KAAA,OAAA,SAAA,SAAA,QAAA,YAAA,IA3GA,GAAA,kBAAA,SAAA,UAEA,GAAA,QAAA,CAEA,IAAA,gBAAA,UACA,OAAA,CAGA,IAAA,eAAA,CACA,IAAA,SAAA,SACA,GAAA,EAAA,QAAA,mBAAA,SAAA,WAAA,EACA,cAAA;IACA,CACA,GAAA,KAAA,SAAA,SAAA,QAAA,IACA,IAAA,IAAA,EAAA,CACA,GAAA,UAAA,SAAA,SAAA,MAAA,EAAA,KACA,SAAA,SAAA,SAAA,MAAA,IAAA,EACA,uBAAA,WAAA,EAAA,QAAA,sBAAA,UAAA,WAAA,IACA,cAAA,IAKA,IAAA,aAEA,KADA,QAAA,EACA,GAAA,OAAA,oDAAA,SAAA,SAGA,KAAA,SAAA,SAEA,KADA,QAAA,EACA,GAAA,OAAA,8CAAA,SAAA,SAGA,OAAA,QAGA,oBACA,aACA,iBACA,aACA,sBACA,qBACA,qBACA,sBACA,MACA,OACA,SACA,gBACA,cACA,uBACA,oBACA,0BACA,sBACA,8BACA,6BACA,0BACA,qBACA,qBACA,0BACA,mBACA,mBACA,mBACA,yBACA,oBACA,uBACA,oBACA,wBACA,oBACA,SACA,oBACA,MACA,SACA,UACA,gBACA,UACA,eACA,yBACA,eACA,eAGA,eACA,gBAAA,aAAA,aAAA,SAAA,iBACA,aAAA,cACA,sBAAA,0BACA,mBAAA,gBACA,qBAAA,MAAA,WACA,6BAAA,qBACA,4BAAA,oBAAA,UACA,yBAAA,iBACA,oBAAA,iBACA,oBAAA,WACA,yBAAA,gBACA,kBAAA,0BACA,kBAAA,iBAGA,uBACA,wBAAA,uBAAA,oBACA,cAAA,oBAAA,qBAmBA,SAAA,SAAA,SAEA,QAAA,YAEA,KAAA,YAAA,EACA,KAAA,KAAA,GACA,KAAA,eAAA,SAAA,QAAA,eAAA,QAAA,gBAAA,EAGA,KAAA,kBAKA;GAAA,eAKA,cAMA,kBAAA,SAAA,UACA,GAAA,KAAA,IACA,IAAA,WAAA,UACA,IAAA,WAAA,cACA,CACA,GAAA,KAAA,SAAA,QAAA,IACA,KAAA,IACA,SAAA,SAAA,MAAA,EAAA,KACA,WAAA,YACA,IAAA,WAAA,YAIA,MAAA,KASA,MAAA,UAAA,SAAA,IAAA,OAIA,MAHA,gBAAA,OACA,QAAA,KAAA,OAEA,MAQA,KAAA,WAAA,SAAA,MAEA,MADA,GAAA,OAAA,QAAA,MACA,MAQA,KAAA,UAAA,SAAA,KACA,MAAA,gBAAA,MAAA,QAAA,KACA,QAAA,KAEA,MAWA,KAAA,UAAA,SAAA,QAAA,KAAA,aAEA,GAAA,KACA,IAAA,GAEA,SAAA,aAAA,QAAA,SACA,SAAA,kBAAA,UACA,WAAA,KAAA,UAAA,aAEA;IAAA,WAAA,EAAA,WAAA,SAAA,UACA,KAAA,IAAA,OAAA,sDAAA,SAoCA,OAhCA,GAAA,SAAA,aAAA,EAAA,WAAA,WAAA,UAQA,IAAA,WAAA,OAAA,QAAA,aACA,EAAA,SAAA,OACA,KAAA,MAKA,KAAA,SAAA,SAAA,MAIA,EAAA,SAAA,aAAA,EAAA,WAAA,WAAA,SAQA,IAAA,WAAA,MAAA,QAAA,aACA,EAAA,SAAA,OACA,KAAA,MAGA,KAGA,KAAA,QAAA,SAAA,QAAA,KAAA,aAEA,GAAA,KAAA,KACA,SAAA,aAAA,QAAA,SACA,SAAA,kBAAA,SAQA,OANA,WACA,kBAAA,UAAA,UACA,IAAA,SAAA,QAAA,KAAA,KAAA,QAAA,OAIA;EAGA,KAAA,aAAA,SAAA,IAAA,MACA,MAAA,YAAA,QAAA,KAAA,OAGA,KAAA,aAAA,SAAA,WAAA,OAAA,aAEA,GAAA,KAAA,KACA,SAAA,aAAA,WAAA,SACA,SAAA,kBAAA,SAEA,KAAA,SAGA,KAAA,qCAAA,WAAA,QAEA,OAJA,KAAA,SAAA,aAAA,WAAA,SAOA,KAAA,WAAA,SAAA,WAAA,KAAA,aAEA,GAAA,MAAA,EACA,SAAA,aAAA,WAAA,SACA,SAAA,kBAAA,SASA,OAPA,WACA,kBAAA,UAAA,SACA,IAAA,SAAA,OAAA,KAAA,KAAA,WAAA,OAKA,KAGA,KAAA,YAAA,SAAA,eAAA,SAAA,aAEA,GAAA,MAAA,EACA,SAAA,aAAA,eAAA,SACA,SAAA,kBAAA,SAEA;IAAA,SASA,KAAA,2CAAA,QARA,IAAA,kBAAA,UAAA,YAAA,CACA,IAAA,SAAA,YAAA,KAAA,KAAA,eAAA,SACA,IAAA,YAAA,SAAA,aAAA,KAAA,KAAA,eACA,sBAAA,IAAA,WAAA,QACA,WAAA,QAAA,eAAA,eAAA,WAMA,MAAA,MAGA,KAAA,YAAA,SAAA,eAAA,aAEA,GAAA,MAAA,EACA,SAAA,aAAA,eAAA,SACA,SAAA,kBAAA,SAEA,KAAA,SAKA,KAAA,2CAAA,QAEA,OANA,kBAAA,UAAA,cACA,IAAA,SAAA,YAAA,KAAA,KAAA,iBAKA;EAGA,KAAA,cAAA,SAAA,eAAA,aAEA,GAAA,MAAA,EACA,SAAA,aAAA,eAAA,SACA,SAAA,kBAAA,SAEA,KAAA,SAKA,KAAA,2CAAA,QAEA,OANA,kBAAA,UAAA,gBACA,IAAA,SAAA,cAAA,KAAA,KAAA,iBAKA,KAaA,KAAA,SAAA,SAAA,eAAA,aAEA,GAAA,MAAA,EACA,SAAA,aAAA,eAAA,SACA,SAAA,kBAAA,SAEA,KAAA,SAOA,KAAA,2CAAA,QAEA,OAPA,KADA,EAAA,WAAA,SAAA,UACA,SAAA,SAAA,KAAA,KAAA,gBAEA,SAAA,YAAA,KAAA,KAAA;EAkBA,KAAA,SAAA,SAAA,eAAA,MAAA,aAEA,GAAA,UAAA,aAAA,eAAA,SACA,SAAA,kBAAA,SAEA,KAAA,SAQA,KAAA,2CAAA,QAPA,GAAA,WAAA,SAAA,UACA,SAAA,SAAA,KAAA,KAAA,eAAA,QAEA,SAAA,cAAA,KAAA,KAAA,gBACA,SAAA,YAAA,KAAA,KAAA,eAAA,SAaA,KAAA,QAAA,SAAA,eAAA,aAEA,GAAA,MAAA,EACA,SAAA,aAAA,eAAA,SACA,SAAA,kBAAA,SAEA,KAAA,SAKA,KAAA,2CAAA,QAEA,OANA,GAAA,WAAA,SAAA,WACA,IAAA,SAAA,QAAA,KAAA,KAAA,iBAKA;EAGA,KAAA,mBAAA,WACA,MAAA,aAGA,KAAA,SAAA,SAAA,oBACA,EAAA,OAAA,WAAA,qBAGA,KAAA,KAAA,SAAA,SAAA,iBACA,GAAA,MAAA,KACA,WACA,IAAA,gBAAA,CACA,IAAA,EAAA,QAAA,iBAqCA,KAAA,IAAA,OAAA,iEAlCA,iBAAA,EAAA,aAAA,gBAAA,oBAGA,EAAA,KAAA,gBAAA,SAAA,UACA,GAAA,MAAA,cAAA,SACA,QACA,gBAAA,EAAA,MAAA,gBAAA,SAIA,EAAA,QAAA,gBAAA,SAAA,UAEA,GAAA,sBAAA,UAAA,CACA,GAAA,oBAAA,EAAA,aAAA,gBAAA,sBAAA,UACA;EAAA,KAAA,mBAAA,SAAA,UACA,GAAA,WAAA,SAAA,IAAA,UACA,SAAA,KAAA,WAAA,SAAA,IAAA,eACA,CAAA,IAAA,WAAA,UAGA,KAAA,IAAA,OAAA,KAAA,KAAA,8CAAA,SAAA,eAAA,SAFA,UAAA,KAAA,WAAA,kBAMA,IAAA,WAAA,aAAA,EACA,WAAA,WAAA,MACA,CAAA,IAAA,WAAA,UAGA,KAAA,IAAA,OAAA,KAAA,KAAA,8CAAA,SAFA,UAAA,KAAA,WAAA,kBAWA,UAAA,EAAA,OAAA,WAGA,IAAA,OAAA,IAcA,OAbA,SAAA,SAAA,WAEA,EAAA,KAAA,UAAA,SAAA,OACA,iBAAA,SACA,WAAA,MAAA,UAAA;GAIA,kBAAA,WACA,SAAA,KAAA,MAAA,cAIA,MAUA,KAAA,mBAAA,SAAA,YAAA,QAAA,oBACA,QAAA,IAAA,YAAA,iBACA,KAAA,gBAAA,YAAA,aAAA,EAAA,MAAA,kBAAA,YAAA,YAAA,QAAA,oBAAA,YAYA,KAAA,mBAAA,SAAA,YAAA,UAAA,cACA,GAEA,QAAA,EAFA,UAIA,IAAA,QAAA,IAAA,YAAA,eAAA,CAIA,GAHA,OAAA,YAAA,aAGA,KAAA,gBAAA,SAAA,UACA,GAAA,QAAA,IAAA,YAAA,oBAEA,IADA,KAAA,gBAAA,WACA,EAAA,EAAA,EAAA,EAAA,IACA,QAAA,GAAA,kBAAA,eAAA,YAAA,WAAA,IACA,KAAA,gBAAA,QAAA,GAAA,EAAA,MAAA,QAAA,GAAA;IAGA,SAAA,kBAAA,eAAA,YAAA,cACA,KAAA,gBAAA,QAAA,EAAA,MAAA,QAAA,cAKA,SAAA,IAAA,YAAA,oBACA,EAAA,QAAA,QAAA,SAAA,OAAA,OACA,EAAA,OACA,EAAA,QAAA,KAAA,gBAAA,QAAA,GAAA,SAAA,cACA,OAAA,KAAA,YAAA,UAAA,mBAKA,EAAA,QAAA,KAAA,gBAAA,QAAA,SAAA,cACA,QAAA,KAAA,YAAA,UAAA,gBAMA,OAAA,WAAA,cAAA,eAAA,aACA,kBAAA,eAAA,QAAA,cAIA,EAAA,MAAA,SAGA,UAGA,KAAA,aAAA,WACA,MAAA,aAGA,KAAA,aAAA,WACA,MAAA;EAGA,KAAA,eAAA,SAAA,QAGA,GAAA,KAAA,UAAA,mBACA,MAAA,QAAA,QAAA,SAAA,GAGA,IAAA,kBAAA,KAAA,QAEA,MAAA,OAGA,IAAA,QAAA,GACA,iBAAA,KAAA,UAAA,mBAWA,IATA,kBAAA,EAAA,KAAA,mBACA,EAAA,MAAA,iBAAA,SAAA,gBAAA,gBACA,MAAA,KAAA,OAAA,QAAA,iBACA,OAAA,OAAA,QAAA,eAAA,kBACA,GAFA,SAOA,OACA,MAAA,OAEA,IAAA,SAAA,KAAA,UAAA,YAAA,oBACA,OAAA,SAAA,QAOA,QACA,MAAA,SAAA,mBAAA,KAAA,gBACA,GAAA,aAAA,WACA,SAAA,MAAA,KAAA,WACA,KAAA,SAAA,oBACA,KAAA,KAAA,MAAA,GACA,gBACA,KAAA,WAAA;CAIA,OADA,aAAA,UAAA,SAAA,UACA,gBC7nBA,OAAA,mDAAA,WAMA,OACA,KAAA,gBACA,WACA,eAAA,8CACA,WAAA,mDACA,WAAA,oDACA,IAAA,6CACA,YAAA,qDACA,OAAA,gDACA,OAAA,6DACA,kBAAA,wEACA,wBAAA,8EACA,qBAAA,2EACA,iCAAA,gFAGA,qBAAA,EACA,oBAAA,EACA,qBAAA,EACA,oBAAA,EACA,eAAA,EAGA,kBAAA,EACA,sBAAA,EACA,kBAAA,EACA,mBAAA,EACA,iCAAA,EACA,SAAA,EACA,KAAA,EACA,SAAA,EACA,2CAAA,EACA,+CAAA,EACA,oBAAA,EACA,oBAAA,EACA,qBAAA,EACA,yBAAA,EACA,cAAA,EACA,wBAAA,EACA,yBAAA,EACA,kBAAA,EACA,mBAAA,EACA,4BAAA,EACA,QAAA,EACA,6BAAA,EACA,mBAAA,EACA,aAAA,EACA,uBAAA;GC5EA,OAAA,4BAAA,cCsBA,OAAA,mDACA,qCACA,gDACA,8BACA,SAAA,SAAA,QAOA,MAAA,UAAA,MAAA,OAAA,UAAA,OAAA,QCXA,OAAA,wCACA,UACA,iCACA,mDACA,SAAA,QAAA,UAAA,aAMA,GAAA,yBAEA,KAAA,SAAA,SAAA,MACA,GAAA,MAAA,IAGA,MAAA,UAAA,GAAA,cACA,QAAA,QAAA,KAAA,UAAA,aAAA,cAAA,IAAA,KAAA,QAAA,IAAA,KAAA,UAAA,eAGA,GAAA,YAAA,aAAA,SAAA,SAAA,MACA,IAAA,KACA,MAAA,MAAA,QAAA,QAAA,2CAGA;KAAA,MAAA,IACA,KACA,KAAA,UAAA,KAAA,WACA,KAAA,MAAA,YAAA,MAEA,QACA,KAAA,oBACA,MAAA,GACA,KAAA,QAAA,QAAA,+BAAA,OAMA,OAAA,SAAA,IAAA,MACA,GAAA,MAAA,IACA,IAAA,KAAA,MAAA,CACA,IACA,IAAA,UAAA,KAAA,MAAA,WACA,MAAA,GACA,QAAA,MAAA,GACA,KAAA,QAAA,QAAA,iCAAA,GAEA,IACA,KAAA,MAAA,aACA,MAAA,GACA,QAAA,MAAA,GACA,KAAA,QAAA,QAAA,6BAAA,GAEA,SAIA,MAAA,SAAA,IAAA,MACA,QAGA,SAAA,WACA,UAGA,SAAA,aAEA,aAAA,WACA,UAIA,OAAA,0BC1EA,OAAA,iCACA,iCACA,wCACA,SAAA,WAAA,oBAUA,MANA,YAAA,SAAA,WAAA,oBAMA;GCzBA,OAAA,4BAAA,WAkBA,QAAA,YAAA,MACA,KAAA,KAAA,OAAA,eACA,KAAA,KAAA,KACA,KAAA,aAGA,KAAA,GAAA,GAAA,EAAA,EAAA,KAAA,KAAA,OAAA,EAAA,EAAA,IAAA,CACA,GAAA,cACA,KAAA,KAAA,KAAA,WAAA,EAEA,MAAA,OACA,UAAA,GAAA,KAAA,QAAA,QAAA,GACA,UAAA,GAAA,KAAA,OAAA,QAAA,GACA,UAAA,GAAA,KAAA,KAAA,QAAA,EACA,UAAA,GAAA,IAAA,GAAA,MACA,KAAA,MACA,UAAA,GAAA,KAAA,MAAA,QAAA,GACA,UAAA,GAAA,KAAA,KAAA,QAAA,EACA,UAAA,GAAA,IAAA,GAAA,MACA,KAAA,KACA,UAAA,GAAA,KAAA,KAAA,QAAA,EACA,UAAA,GAAA,IAAA,GAAA,MAEA,UAAA,GAAA,KAGA,KAAA,WAAA,KAAA,WAGA,KAAA,WAAA,MAAA,UAAA,OAAA,SAAA,KAAA,YAEA,KAAA,WAAA,QAAA,KAAA,KAAA,SACA,KAAA,WAAA,QAAA,KACA,KAAA,WAAA,QAAA,KACA,KAAA,WAAA,QAAA;CAeA,QAAA,aAAA,WAAA,mBACA,KAAA,WAAA,WACA,KAAA,kBAAA,kBACA,KAAA,QAAA,KACA,KAAA,YAAA,EACA,KAAA,UAAA,KACA,KAAA,YAuDA,QAAA,cAAA,IAAA,OAAA,GAAA,QAAA,IAAA,OAAA,KAAA,IAAA,OAAA,IAAA,OAAA,IAAA,MACA,KAAA,GAAA,QAAA,EAAA,OAAA,IAAA,QAAA,GAAA,IAAA,SAAA,QACA,MAAA,IAAA,GAAA,OAAA,IAAA,OAAA,OAAA,MAAA,KAAA,GAAA,GAAA,EAAA,EAAA,IAAA,OAAA,OAAA,IAAA,KAAA,IAAA,GAAA,IAAA,EAAA,QAKA,QAAA,WAAA,WAAA,WAAA,KAAA,WAAA,WAAA,KAAA,UAAA,UAGA,QAAA,eAAA,KAAA,UAAA,KAAA,OAAA,EAKA,QAAA,oBACA,MAAA,mBAAA;CAIA,QAAA,eACA,GAAA,UAAA,EACA,OAAA,UAAA,SAEA,IAAA,WAAA,KAAA,QAAA,CACA,SAAA,CACA,IAAA,MAAA,OAAA,WAAA,MAAA,0BAEA,OAAA,KAAA,KACA,QAAA,WAAA,KAAA,KAIA,MAAA,SAySA,QAAA,gBAAA,MAAA,eAIA,IAAA,GAHA,OAAA,EACA,OAAA,eAAA,OAEA,EAAA,EAAA,IAAA,kBAAA,OAAA,KAAA,EAAA,IAAA,CACA,GAAA,QAAA,CAEA,QAAA,eACA,IAAA,qBAAA,EACA,OAAA,kBAAA,GAAA,EACA,MACA,KAAA,qBAAA,EACA,OAAA,kBAAA,GAAA,EACA,MACA,KAAA,qBAAA,EACA,OAAA,kBAAA,GAAA,EACA,MACA,KAAA,qBAAA,EACA,OAAA,kBAAA,GAAA,GAIA,GAAA,QAAA,OACA,KAEA;QAIA,GAAA,MAAA,kBAAA,OACA,KAAA,IAAA,OAAA,gBAGA,OAAA,OAGA,QAAA,gBAAA,OACA,GAAA,cAAA,UAAA,OAAA,WAAA,QAAA,oBAAA,IACA,OAAA,cAAA,QAAA,aAAA,QAAA,MAAA,EAAA,GA/eA,GAAA,OAuDA,YAAA,WACA,UAAA,WACA,MAAA,MAAA,WAAA,QAEA,MAAA,SAAA,QACA,IAAA,GAAA,GAAA,EAAA,EAAA,KAAA,WAAA,OAAA,EAAA,EAAA,IACA,OAAA,IAAA,KAAA,WAAA,GAAA,KAcA,YAAA,WAAA,QAAA,SAAA,MAAA,GAAA,SAAA,GAAA,YAAA,KAAA,MAAA,SAAA,KAAA,SAAA,KAAA,UAAA,MAAA,OAAA,SAAA,IAAA,KAAA,GAAA,EAAA,KAAA,KAAA,aAAA,KAAA,EAAA,KAAA,KAAA,aAAA,IAAA,KAAA,IAAA,OAAA,IAAA,IAAA,IACA;MAAA,MAAA,QAAA,KAAA,MAAA,eAAA,WAAA,MAAA,MAAA,aAAA,KAAA,WAAA,KAAA,UAAA,EAAA,KAAA,uBAAA,SAAA,SAAA,KAAA,aAAA,KAAA,YAAA,EAAA,KAAA,WAAA,GAAA,KAAA,QAAA,GAAA,OAAA,KAAA,YAAA,KAAA,GAAA,KAAA,EAAA,IAAA,KAAA,YAAA,MAAA,CAAA,KAAA,QAAA,KAAA,GAAA,OAAA,KAAA,YAAA,KAAA,GAAA,KAAA,EAAA,IAAA,KAAA,YAAA,MAAA,KAAA,QAAA,KAAA,KAAA,KACA,KAAA,0BAAA,EAAA,GAAA,KAAA,0BAAA,KAAA,YAAA,EAAA,GAAA,KAAA,0BAAA,EAAA,KAAA,YAAA,GAAA,KAAA,6BAAA,KAAA,qBAAA,KAAA,cAAA,KAAA,aAAA,KAAA,YAAA,GAAA,KAAA,gBAAA,MACA,MAAA,KAAA,YAAA,KAAA,UAAA,YAAA,WAAA,KAAA,WAAA,KAAA,kBAAA,KAAA,WACA,KAAA,QAAA,KAAA,UAAA;EAAA,0BAAA,SAAA,IAAA,KAAA,IAAA,GAAA,GAAA,GAAA,GAAA,EAAA,IAAA,KAAA,IAAA,IAAA,GAAA,KAAA,aAAA,IAAA,GAAA,IAAA,GAAA,GAAA,GAAA,GAAA,EAAA,IAAA,IAAA,IAAA,GAAA,KAAA,aAAA,IAAA,IAAA,KAAA,QAAA,IAAA,GAAA,IAAA,GAAA,GAAA,GAAA,GAAA,IAAA,GAAA,GAAA,GAAA,IAAA,GAAA,GAAA,GAAA,IAAA,GAAA,GAAA,GAAA,IAAA,GAAA,GAAA,GAAA,GAAA,GAAA,GAAA,GAAA,GAAA,GAAA,IAAA,mBAAA,WAAA,IAAA,GAAA,cAAA,EAAA,QAAA,EAAA,EAAA,EAAA,EAAA,EAAA,IAAA,CAAA,KAAA,UAAA,EAAA,EAAA,IAAA,WAAA,OAAA,aAAA,OAAA,GAAA,GAAA,aAAA,aAAA,aAAA,UAAA,QAAA,GACA,MAAA,UAAA,gBAAA,SAAA,UAAA,cAAA,OAAA,GAAA,OAAA,UAAA,qBAAA,cAAA,OAAA,GAAA,CAAA,MAAA,MAAA,KAAA,GAAA,KAAA,EAAA,IAAA,KAAA,QAAA,OAAA,MAAA,IAAA,GAAA,GAAA,IAAA,GAAA,IAAA,EAAA,IAAA,KAAA,QAAA,KAAA,OAAA,MAAA,CAAA,GAAA,GAAA,IAAA,GAAA,KAAA,KAAA,QAAA,KAAA,IAAA;OAAA,MAAA,UAAA,EAAA,KAAA,MAAA,OAAA,EAAA,GAAA,MAAA,OAAA,EAAA,GAAA,GAAA,MAAA,OAAA,EAAA,GAAA,EAAA,IAAA,MAAA,OAAA,EAAA,EAAA,IAAA,MAAA,WACA,MAAA,QAAA,mBAAA,WAAA,IAAA,GAAA,GAAA,EAAA,EAAA,KAAA,YAAA,EAAA,IAAA,MAAA,KAAA,QAAA,GAAA,KACA,KAAA,QAAA,GAAA,GAAA,EAAA,GAAA,EACA,KAAA,GAAA,GAAA,EAAA,EAAA,KAAA,YAAA,EAAA,IAAA,MAAA,KAAA,QAAA,GAAA,KACA,KAAA,QAAA,GAAA,GAAA,EAAA,GAAA,IAAA,2BAAA,WAAA,IAAA,GAAA,KAAA,OAAA,mBAAA,KAAA,YAAA,EAAA,EAAA,EAAA,IAAA,OAAA,IAAA,IAAA,GAAA,GAAA,EAAA,EAAA,IAAA,OAAA,IAAA,CAAA,GAAA,KAAA,IAAA,GAAA,IAAA,IAAA,EAAA,IAAA,MAAA,KAAA,QAAA,KAAA,KACA,IAAA,GAAA,GAAA,GAAA,GAAA,EAAA,IAAA,IAAA,GAAA,GAAA,GAAA,GAAA,EAAA,IAAA,KAAA,QAAA,IAAA,GAAA,IAAA,GAAA,IAAA,GAAA,GAAA,GAAA,IAAA,GAAA,GAAA,GAAA,GAAA,GAAA,GAAA,GAAA,GAAA;GAAA,gBAAA,SAAA,MAAA,IAAA,GAAA,MAAA,OAAA,iBAAA,KAAA,YAAA,EAAA,EAAA,GAAA,EAAA,IAAA,CAAA,GAAA,MAAA,MAAA,IAAA,MAAA,EAAA,EAAA,MAAA,QAAA,KAAA,MAAA,EAAA,IAAA,EAAA,EAAA,KAAA,YAAA,EAAA,GAAA,IACA,IAAA,GAAA,GAAA,EAAA,GAAA,EAAA,IAAA,CAAA,GAAA,MAAA,MAAA,IAAA,MAAA,EAAA,EAAA,MAAA,QAAA,EAAA,EAAA,KAAA,YAAA,EAAA,GAAA,KAAA,MAAA,EAAA,IAAA,MAAA,cAAA,SAAA,KAAA,aAAA,IAAA,GAAA,MAAA,KAAA,mBAAA,EAAA,YAAA,KAAA,OAAA,eAAA,MAAA,EAAA,EAAA,GAAA,EAAA,IAAA,CAAA,GAAA,MAAA,MAAA,IAAA,MAAA,EAAA,EAAA,GAAA,EAAA,KAAA,QAAA,GAAA,GAAA,IAAA,EAAA,EAAA,KAAA,QAAA,EAAA,GAAA,GAAA,IAAA,KAAA,QAAA,KAAA,YAAA,GAAA,GAAA,GAAA,IACA,IAAA,GAAA,GAAA,EAAA,GAAA,EAAA,IAAA,CAAA,GAAA,MAAA,MAAA,IAAA,MAAA,EAAA,EAAA,GAAA,EAAA,KAAA,QAAA,GAAA,KAAA,YAAA,EAAA,GAAA,IAAA,EAAA,EAAA,KAAA,QAAA,GAAA,GAAA,EAAA,EAAA,GAAA,IAAA,KAAA,QAAA,GAAA,GAAA,EAAA,GAAA;CACA,KAAA,QAAA,KAAA,YAAA,GAAA,IAAA,MAAA,QAAA,SAAA,KAAA,aAAA,IAAA,GAAA,KAAA,GAAA,IAAA,KAAA,YAAA,EAAA,SAAA,EAAA,UAAA,EAAA,IAAA,KAAA,YAAA,EAAA,IAAA,EAAA,KAAA,EAAA,IAAA,GAAA,KAAA,QAAA,CAAA,IAAA,GAAA,GAAA,EAAA,EAAA,EAAA,IAAA,GAAA,MAAA,KAAA,QAAA,KAAA,IAAA,GAAA,CAAA,GAAA,OAAA,CAAA,WAAA,KAAA,SAAA,KAAA,IAAA,KAAA,aAAA,SAAA,GACA,IAAA,MAAA,OAAA,QAAA,YAAA,IAAA,IAAA,EAAA,QAAA,MAAA,MACA,KAAA,QAAA,KAAA,IAAA,GAAA,KAAA,WAAA,IAAA,WAAA,YAAA,SAAA,GACA,GAAA,KAAA,IAAA,EAAA,KAAA,KAAA,aAAA,IAAA,CAAA,KAAA,IAAA,KAAA,GAAA,WAAA,YAAA,KAAA,IAAA,YAAA,KAAA,GAAA,YAAA,WAAA,SAAA,WAAA,kBAAA,UAAA,IAAA,GAAA,UAAA,UAAA,YAAA,WAAA,mBAAA,OAAA,GAAA,aAAA,EAAA,EAAA,EAAA,SAAA,OAAA,IAAA,CAAA,GAAA,MAAA,SAAA,EAAA;OAAA,IAAA,KAAA,KAAA,GAAA,OAAA,IAAA,KAAA,YAAA,OAAA,gBAAA,KAAA,KAAA,aAAA,KAAA,MAAA,QACA,IAAA,GAAA,gBAAA,EAAA,EAAA,EAAA,EAAA,SAAA,OAAA,IAAA,gBAAA,SAAA,GAAA,SACA,IAAA,OAAA,kBAAA,EAAA,eAAA,KAAA,IAAA,OAAA,0BACA,OAAA,kBACA,IACA,EAAA,eACA,IAEA,KADA,OAAA,kBAAA,GAAA,EAAA,gBAAA,OAAA,IAAA,EAAA,GACA,OAAA,kBAAA,GAAA,GAAA,OAAA,QAAA,EACA,QAAA,CAAA,GAAA,OAAA,mBAAA,EAAA,eAAA,KACA,IAAA,OAAA,IAAA,YAAA,KAAA,GAAA,OAAA,mBAAA,EAAA,eAAA,KACA,QAAA,IAAA,YAAA,KAAA,GACA,MAAA,aAAA,YAAA,OAAA;EAAA,YAAA,YAAA,SAAA,OAAA,UAAA,IAAA,GAAA,QAAA,EAAA,WAAA,EAAA,WAAA,EAAA,OAAA,GAAA,OAAA,SAAA,QAAA,OAAA,GAAA,OAAA,SAAA,QAAA,EAAA,EAAA,EAAA,SAAA,OAAA,IAAA,CAAA,GAAA,SAAA,SAAA,GAAA,UAAA,QAAA,SAAA,GAAA,WAAA,OAAA,YAAA,KAAA,IAAA,WAAA,SAAA,WAAA,KAAA,IAAA,WAAA,SAAA,OAAA,GAAA,GAAA,OAAA,QAAA,KAAA,GAAA,GAAA,EAAA,EAAA,OAAA,GAAA,OAAA,IAAA,OAAA,GAAA,GAAA,IAAA,OAAA,OAAA,EAAA,OACA,SAAA,OAAA,IAAA,QAAA,OAAA,0BAAA,SAAA,QAAA,GAAA,cAAA,OAAA,GAAA,OAAA,YAAA,GAAA,QAAA,QAAA,IAAA,OAAA,QAAA,GAAA,GAAA,OAAA,OAAA,YAAA,EAAA,KAAA,GAAA,GAAA,EAAA,EAAA,OAAA,GAAA,OAAA,IAAA,CAAA,GAAA,UAAA,EAAA,QAAA,YAAA,OAAA,GAAA,MAAA;OAAA,GAAA,GAAA,UAAA,EAAA,QAAA,IAAA,UAAA,GACA,IAAA,GAAA,gBAAA,EAAA,EAAA,EAAA,EAAA,SAAA,OAAA,IAAA,gBAAA,SAAA,GAAA,UACA,KAAA,GAAA,MAAA,GAAA,OAAA,gBAAA,MAAA,EAAA,EAAA,EAAA,WAAA,EAAA,IAAA,IAAA,GAAA,GAAA,EAAA,EAAA,SAAA,OAAA,IAAA,EAAA,OAAA,GAAA,SAAA,KAAA,SAAA,OAAA,GAAA,GACA,KAAA,GAAA,GAAA,EAAA,WAAA,EAAA,IAAA,IAAA,GAAA,GAAA,EAAA,EAAA,SAAA,OAAA,IAAA,EAAA,OAAA,GAAA,SAAA,KAAA,SAAA,OAAA,GAAA,GACA,OAAA,MAgBA,KAAA,GAhBA,SAAA,YAAA,EAAA,eAAA,EAAA,eAAA,EAAA,WAAA,GAAA,qBAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,GAAA,eAAA,WAAA,EAAA,WAAA,EAAA,WAAA,EAAA,WAAA,EAAA,WAAA,EAAA,WAAA,EAAA,WAAA,EAAA,WAAA,GAAA,QAAA,4BAAA,EAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,MAAA,EAAA,GAAA,GAAA,GAAA,MAAA,EAAA,GAAA,GAAA,GAAA,MAAA,EAAA,GAAA,GAAA,GAAA,MAAA,EAAA,GAAA,GAAA,GAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,MAAA,EAAA,GAAA,GAAA,GAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,IAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,IAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,IAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,IAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,IAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,IAAA,IAAA,MAAA,IAAA,KAAA,IAAA,KAAA,SAAA,MAAA,eAAA,SAAA,MAAA,IAAA,GAAA,GAAA,MAAA,GAAA,OAAA,YAAA,GAAA,OAAA,YAAA,OAAA,MAAA,GAAA,GAAA,OAAA,KAAA,OAAA,YAAA,GAAA,OAAA,YAAA,OAAA,IACA;OAAA,MAAA,GAAA,GAAA,OAAA,UAAA,iBAAA,SAAA,MAAA,IAAA,GAAA,GAAA,MAAA,GAAA,OAAA,YAAA,GAAA,OAAA,YAAA,OAAA,MAAA,GAAA,GAAA,OAAA,KAAA,OAAA,YAAA,GAAA,OAAA,YAAA,OAAA,IACA,OAAA,OAAA,GAAA,GAAA,YAAA,SAAA,MAAA,IAAA,GAAA,OAAA,EAAA,GAAA,MAAA,QAAA,QAAA,CACA,OAAA,QAAA,mBAAA,SAAA,YAAA,MAAA,QAAA,uBAAA,WAAA,IAAA,QAAA,SAAA,YAAA,EAAA,GAAA,OAAA,aAAA,IAAA,eAAA,WAAA,OAAA,EAAA,GAAA,GAAA,CAAA,KAAA,eAAA,WAAA,MAAA,GAAA,GAAA,CAAA,KAAA,eAAA,WAAA,MAAA,GAAA,GAAA,CAAA,KAAA,eAAA,WAAA,OAAA,EAAA,GAAA,GAAA,CAAA,KAAA,eAAA,WAAA,OAAA,KAAA,MAAA,EAAA,GAAA,KAAA,MAAA,EAAA,IAAA,GAAA,CAAA;IAAA,eAAA,WAAA,MAAA,GAAA,EAAA,EAAA,EAAA,EAAA,GAAA,CAAA,KAAA,eAAA,WAAA,OAAA,EAAA,EAAA,EAAA,EAAA,EAAA,GAAA,GAAA,CAAA,KAAA,eAAA,WAAA,OAAA,EAAA,EAAA,GAAA,EAAA,GAAA,GAAA,GAAA,CAAA,SAAA,KAAA,IAAA,OAAA,mBAAA,eAAA,0BAAA,SAAA,oBAAA,IAAA,GAAA,GAAA,GAAA,eAAA,GAAA,GAAA,EAAA,EAAA,mBAAA,EAAA,IAAA,EAAA,EAAA,SAAA,GAAA,eAAA,EAAA,OAAA,KAAA,IAAA,GACA,OAAA,IAAA,gBAAA,SAAA,KAAA,MAAA,GAAA,MAAA,GAAA,GAAA,KAAA,OAAA,MAAA,IAAA,QAAA,YAAA,MAAA,GAAA,KAAA,QAAA,eAAA,MAAA,EAAA,KAAA,QAAA,eAAA,MAAA,EAAA,KAAA,QAAA,WAAA,MAAA,EAAA,SAAA,KAAA,IAAA,OAAA,QAAA,UAAA,IAAA,GAAA,KAAA,OAAA,MAAA,IAAA,QAAA,YAAA,MAAA,GAAA;IAAA,QAAA,eAAA,MAAA,GAAA,KAAA,QAAA,eAAA,MAAA,GAAA,KAAA,QAAA,WAAA,MAAA,GAAA,SAAA,KAAA,IAAA,OAAA,QAAA,UAAA,CAAA,KAAA,GAAA,MAAA,KAAA,IAAA,OAAA,QAAA,KAAA,QAAA,MAAA,IAAA,QAAA,YAAA,MAAA,GAAA,KAAA,QAAA,eAAA,MAAA,GAAA,KAAA,QAAA,eAAA,MAAA,GAAA,KAAA,QAAA,WAAA,MAAA,GAAA,SAAA,KAAA,IAAA,OAAA,QAAA,SAAA,aAAA,SAAA,QAAA,IAAA,GAAA,aAAA,OAAA,iBAAA,UAAA,EAAA,IAAA,EAAA,YAAA,IAAA,MAAA,IAAA,GAAA,KAAA,EAAA,YAAA,IAAA,MAAA,CAAA,IAAA,GAAA,WAAA,EAAA,KAAA,OAAA,OAAA,IAAA,KAAA,EAAA,GAAA,GAAA,EAAA,IAAA,KAAA,EAAA,IAAA,GAAA,IAAA,GAAA,aACA,IAAA,GAAA,GAAA,GAAA,GAAA,EAAA,IAAA,EAAA,IAAA,GAAA,IAAA,GAAA,cACA,GAAA,GAAA,GAAA,IACA,MAAA,OAAA,OAAA,IAAA,EAAA,IAAA,IAAA,WACA;UAAA,IAAA,WAAA,EAAA,UAAA,GACA,IAAA,GAAA,KAAA,EAAA,YAAA,EAAA,IAAA,MAAA,IAAA,GAAA,KAAA,EAAA,YAAA,EAAA,IAAA,MAAA,CAAA,GAAA,OAAA,CAAA,QAAA,OAAA,IAAA,MAAA,QAAA,OAAA,OAAA,IAAA,EAAA,MAAA,QAAA,OAAA,OAAA,IAAA,IAAA,IAAA,QAAA,OAAA,OAAA,IAAA,EAAA,IAAA,IAAA,SAAA,GAAA,OAAA,GAAA,SAAA,WAAA,GACA,IAAA,GAAA,KAAA,EAAA,YAAA,IAAA,MAAA,IAAA,GAAA,KAAA,EAAA,YAAA,EAAA,IAAA,MAAA,OAAA,OAAA,IAAA,OAAA,OAAA,OAAA,IAAA,IAAA,IAAA,OAAA,OAAA,IAAA,IAAA,IAAA,OAAA,OAAA,IAAA,IAAA,IAAA,OAAA,OAAA,IAAA,IAAA,KAAA,OAAA,OAAA,IAAA,IAAA,IAAA,OAAA,OAAA,IAAA,IAAA,KAAA,WAAA,GACA,KAAA,GAAA,KAAA,EAAA,YAAA,IAAA,MAAA,IAAA,GAAA,KAAA,EAAA,YAAA,EAAA,IAAA,MAAA,OAAA,OAAA,IAAA,OAAA,OAAA,OAAA,IAAA,EAAA,MAAA,OAAA,OAAA,IAAA,EAAA,MAAA,OAAA,OAAA,IAAA,EAAA,MAAA,OAAA,OAAA,IAAA,EAAA,OAAA,OAAA,OAAA,IAAA,EAAA,MAAA,OAAA,OAAA,IAAA,EAAA,OAAA,WAAA,GACA;IAAA,GAAA,WAAA,EAAA,IAAA,EAAA,YAAA,IAAA,MAAA,IAAA,GAAA,KAAA,EAAA,YAAA,IAAA,MAAA,OAAA,OAAA,IAAA,MAAA,WACA,IAAA,OAAA,KAAA,IAAA,IAAA,UAAA,YAAA,YAAA,IAAA,CAAA,OAAA,YAAA,GAAA,QAAA,QAAA,KAAA,SAAA,GAAA,GAAA,EAAA,EAAA,KAAA,IAAA,OAAA,QAAA,EAAA,IACA,OAAA,QAAA,UAAA,IAAA,KAAA,SAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GACA,MAAA,GAAA,KAAA,GAAA,GACA,OAAA,QAAA,UAAA,IAAA,UAAA,GAAA,OAAA,KAAA,UAAA,GAAA,OAAA,MAAA,EAAA,EAAA,EAAA,EAAA,IAAA,OAAA,UAAA,GAAA,GAAA,CACA,KAAA,GAAA,GAAA,EAAA,IAAA,EAAA,IAAA,OAAA,UAAA,GAAA,OAAA,UAAA,EAAA,GAAA,OAAA,UAAA,EAAA,GAAA,OAAA,UAAA,EAAA,GAAA,OAAA,UAAA,EAAA,EACA,KAAA,GAAA,GAAA,EAAA,IAAA,EAAA,IAAA,OAAA,UAAA,OAAA,UAAA,IAAA,CAIA,cAAA,WAAA,IAAA,SAAA,OAAA,MAAA,MAAA,IAAA;EAAA,UAAA,WAAA,MAAA,MAAA,IAAA,QAAA,SAAA,SAAA,GAAA,IAAA,GAAA,KAAA,GAAA,OAAA,KAAA,YAAA,EAAA,YAAA,GAAA,EAAA,EAAA,EAAA,KAAA,YAAA,IAAA,IAAA,GAAA,GAAA,EAAA,EAAA,EAAA,YAAA,IAAA,IAAA,EAAA,IAAA,OAAA,KAAA,OAAA,KAAA,KAAA,IAAA,IAAA,OAAA,KAAA,EAAA,IAAA,IACA,OAAA,IAAA,cAAA,IAAA,IAAA,IAAA,SAAA,GAAA,GAAA,KAAA,YAAA,EAAA,YAAA,EAAA,MAAA,KACA,KAAA,GAAA,OAAA,OAAA,KAAA,KAAA,IAAA,IAAA,OAAA,KAAA,EAAA,IAAA,IAAA,IAAA,GAAA,OAAA,KAAA,aAAA,EAAA,EAAA,EAAA,KAAA,YAAA,IAAA,IAAA,GAAA,KAAA,IAAA,EACA,KAAA,GAAA,GAAA,EAAA,EAAA,EAAA,YAAA,IAAA,IAAA,IAAA,OAAA,KAAA,OAAA,KAAA,EAAA,IAAA,IAAA,MACA,OAAA,IAAA,cAAA,IAAA,GAAA,IAAA,KACA,UAAA,iBAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,IAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,IAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,GAAA,EAAA,IAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,GAAA,EAAA,IAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,KAAA,EAAA,IAAA,GAAA,EAAA,IAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,GAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,GAAA,IAAA,MAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,MAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,GAAA,IAAA,MAAA,EAAA,GAAA,GA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","sourcesContent":["/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n *\n */\n\n//@see http://forge.taotesting.com/projects/tao/wiki/Front_js\ndefine('taoBooklet/controller/routes',[],function () {\n    'use strict';\n\n    return {\n        'Booklet': {\n            'actions': {\n                'editBooklet' : 'controller/Booklet/editBooklet',\n                'wizard'      : 'controller/Booklet/wizard',\n                'preview'     : 'controller/Booklet/preview'\n            }\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n */\ndefine('taoBooklet/controller/Booklet/editBooklet',['jquery', 'lodash', 'module', 'helpers', 'generis.tree.select', 'layout/section'], function ($, _, module, helpers, GenerisTreeSelectClass, section) {\n    'use strict';\n\n    /**\n     * Builds group tree inside target container\n     * @param {jQueryElement} $container\n     */\n    function buildGroupsTree($container) {\n\n        var treeOptions = $container.data();\n\n        var toggleTree = function(val) {\n            $container.toggle(val !== treeOptions.anonymous);\n        };\n\n        var $radio = $('[name=\"' + treeOptions.anonymousClass + '\"]');\n\n        toggleTree($radio.filter(':checked').val());\n\n        $radio.on('change', function (e) {\n            toggleTree($(e.target).val());\n        });\n\n        new GenerisTreeSelectClass('#' + treeOptions.actionId + '-tree', helpers._url('getData', 'GenerisTree', 'tao'), {\n            actionId: treeOptions.actionId,\n            saveUrl: treeOptions.saveUrl,\n            saveData: {\n                resourceUri: treeOptions.resourceUri,\n                propertyUri: treeOptions.propertyUri\n            },\n            checkedNodes: treeOptions.checkedNodes,\n            serverParameters: {\n                openNodes: treeOptions.openNodes,\n                rootNode: treeOptions.rootNode\n            },\n            saveCallback: function () {\n                section\n                    .current()\n                    .loadContentBlock(\n                    helpers._url('editBooklet', 'Booklet', 'taoBooklet'),\n                    {uri: treeOptions.resourceUri}\n                );\n            },\n            paginate: 10\n        });\n    }\n\n    return {\n        start: function () {\n\n            var $downloader = $('<iframe/>').hide();\n            $('form').append($downloader);\n\n            $('.btn-download').on('click', function (e) {\n                e.preventDefault();\n                var $form = $(e.target).closest('form');\n\n                $downloader.attr('src', helpers._url('download', 'Booklet', 'taoBooklet', {\n                    uri: $form.find('input[name=\"uri\"]').val(),\n                    classUri: $form.find('input[name=\"classUri\"]').val(),\n                    id: $form.find('input[name=\"id\"]').val()\n                }));\n            });\n\n            buildGroupsTree($('.group-container'));\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n *\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoBooklet/controller/Booklet/preview',['jquery'], function ($) {\n    'use strict';\n\n    return {\n        start: function () {\n\n            //resize the frame to it's container height\n            var $frame = $('.preview-test');\n            var $container  = $frame.closest('.content-container');\n            $frame.css('min-height', ($container.height() - 50) + 'px' );\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n */\ndefine('taoBooklet/controller/Booklet/wizard',['jquery'], function ($) {\n    'use strict';\n\n    return {\n        start: function () {\n\n            var $form = $('.main-container ').find('form');\n\n            var $radio = $('[name=\"' + $form.find('#anonymousClass').val() + '\"]');\n            if (!$radio.is(':checked')) {\n                $radio.filter(':first').attr('checked', true);\n            }\n\n        }\n    };\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\n *\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoItems/runner/api/itemRunner',['jquery', 'lodash'], function($, _){\n    'use strict';\n\n     /**\n     *\n     * Builds a brand new {@link ItemRunner}.\n     *\n     * <strong>The factory is an internal mechanism to create encapsulated contexts.\n     *  I suggest you to use directly the name <i>itemRunner</i> when you require this module.</strong>\n     *\n     * @example require(['itemRunner'], function(itemRunner){\n                    itemRunner({itemId : 12})\n     *                    .on('statechange', function(state){\n     *\n     *                    })\n     *                    .on('ready', function(){\n     *\n     *                    })\n     *                    .on('response', function(){\n     *\n     *                    })\n     *                   .init()\n     *                   .render($('.item-container'));\n     *          });\n     *\n     * @exports itemRunner\n     * @namespace itemRunnerFactory\n     *\n     * @param {String} [providerName] - the name of a provider previously registered see {@link itemRunnerFactory#register}\n     * @param {Object} [data] - the data of the item to run\n     *\n     * @returns {ItemRunner}\n     */\n    var itemRunnerFactory = function itemRunnerFactory(providerName, data, options){\n\n        //optional params based on type\n        if(_.isPlainObject(providerName)){\n            data = providerName;\n            providerName = undefined;\n        }\n        data = data || {};\n\n        //contains the bound events.\n        var events = {};\n\n        //flow structure to manage sync calls in an async context.\n        var flow = {\n            init : {\n                done: false,\n                pending : []\n            },\n            render : {\n                done: false,\n                pending : []\n            }\n        };\n\n        /*\n         * Select the provider\n         */\n\n        var provider;\n        var providers = itemRunnerFactory.providers;\n\n        //check a provider is available\n        if(!providers || _.size(providers) === 0){\n            throw new Error('No provider regitered');\n        }\n\n        if(_.isString(providerName) && providerName.length > 0){\n            provider = providers[providerName];\n        } else if(_.size(providers) === 1) {\n\n            //if there is only one provider, then we take this one\n            providerName = _.keys(providers)[0];\n            provider = providers[providerName];\n        }\n\n        //now we should have a provider\n        if(!provider){\n            throw new Error('No candidate found for the provider');\n        }\n\n\n       /**\n        * The ItemRunner\n        * @typedef {Object} ItemRunner\n        */\n\n        /**\n        * @type {ItemRunner}\n        * @lends itemRunnerFactory\n        */\n        var ItemRunner = {\n\n            /**\n             * Items container\n             * @type {HTMLElement}\n             */\n            container : null,\n\n            options   : options || {},\n\n            /**\n             * Initialize the runner.\n             * @param {Object} [newData] - just in case you want to change item data (it should not occurs in most case)\n             * @returns {ItemRunner} to chain calls\n             *\n             * @fires ItemRunner#init\n             */\n            init : function(newData){\n                var self = this;\n\n                /**\n                 * Call back when init is done\n                 */\n                var initDone = function initDone(){\n\n                   //manage pending tasks the first time\n                    if(flow.init.done === false){\n                        flow.init.done = true;\n\n                        _.forEach(flow.init.pending, function(pendingTask){\n                            if(_.isFunction(pendingTask)){\n                                pendingTask.call(self);\n                            }\n                        });\n                        flow.init.pending = [];\n                    }\n\n                    /**\n                     * the runner has initialized correclty the item\n                     * @event ItemRunner#init\n                     */\n                    self.trigger('init');\n                };\n\n                //merge data\n                if(newData){\n                    data = _.merge(data, newData);\n                }\n\n                if(_.isFunction(provider.init)){\n\n                    /**\n                     * Calls provider's initialization with item data.\n                     * @callback InitItemProvider\n                     * @param {Object} data - the item data\n                     * @param {Function} done - call once the initialization is done\n                     */\n                    provider.init.call(this, data, initDone);\n\n                } else {\n                    initDone();\n                }\n\n                return this;\n            },\n\n            /**\n             * Initialize the current item.\n             *\n             * @param {HTMLElement|jQueryElement} elt - the DOM element that is going to contain the rendered item.\n             * @returns {ItemRunner} to chain calls\n             *\n             * @fires ItemRunner#ready\n             * @fires ItemRunner#render\n             * @fires ItemRunner#error if the elt isn't valid\n             *\n             * @fires ItemRunner#statechange the provider is reponsible to trigger this event\n             * @fires ItemRunner#responsechange  the provider is reponsible to trigger this event\n             */\n           render : function(elt){\n                var self = this;\n\n                /**\n                 * Call back when render is done\n                 */\n                var renderDone = function renderDone (){\n\n                    //manage pending tasks the first time\n                    if(flow.render.done === false){\n                        flow.render.done = true;\n\n                        _.forEach(flow.render.pending, function(pendingTask){\n                            if(_.isFunction(pendingTask)){\n                                pendingTask.call(self);\n                            }\n                        });\n                        flow.render.pending = [];\n                    }\n\n                    /**\n                     * The item is rendered\n                     * @event ItemRunner#render\n                     */\n                    self.trigger('render');\n\n                    /**\n                     * The item is ready.\n                     * Alias of {@link ItemRunner#render}\n                     * @event ItemRunner#ready\n                     */\n                    self.trigger('ready');\n                };\n\n                //check elt\n                if( !(elt instanceof HTMLElement) && !(elt instanceof $) ){\n                    return self.trigger('error', 'A valid HTMLElement (or a jquery element) at least is required to render the item');\n                }\n\n                if(flow.init.done === false){\n                    flow.init.pending.push(function(){\n                        this.render(elt);\n                    });\n                } else {\n\n                    //we keep a reference to the container\n                    if(elt instanceof $){\n                        this.container = elt.get(0);\n                    } else {\n                        this.container = elt;\n                    }\n\n                    //the state will be applied only when the rendering is made\n\n                    if(_.isFunction(provider.render)){\n\n                        /**\n                         * Calls the provider's render\n                         * @callback RendertItemProvider\n                         * @param {HTMLElement} elt - the element to render inside\n                         * @param {Function} done - call once the render is done\n                         */\n                        provider.render.call(this, this.container, renderDone);\n\n                    } else {\n                        renderDone();\n                    }\n                }\n\n                return this;\n           },\n\n           /**\n            * Clear the running item.\n            * @returns {ItemRunner}\n            *\n            * @fires ItemRunner#clear\n            */\n           clear : function(){\n                var self = this;\n\n                /**\n                 * Call back when clear is done\n                 */\n                var clearDone = function clearDone (){\n\n                    //events = {};\n\n                    /**\n                     * The item is ready.\n                     * @event ItemRunner#clear\n                     */\n                    self.trigger('clear');\n                };\n                if(_.isFunction(provider.clear)){\n\n                    /**\n                     * Calls the provider's clear\n                     * @callback ClearItemProvider\n                     * @param {HTMLElement} elt - item's container\n                     * @param {Function} done - call once the initialization is done\n                     */\n                    provider.clear.call(this, this.container, clearDone);\n\n                } else {\n                    clearDone();\n                }\n\n                return this;\n           },\n\n           /**\n            * Get the current state of the running item.\n            *\n            * @returns {Object|Null} state\n            */\n           getState : function(){\n                var state = null;\n                if(_.isFunction(provider.getState)){\n\n                    /**\n                     * Calls the provider's getState\n                     * @callback GetStateItemProvider\n                     * @returns {Object} the state\n                     */\n                    state = provider.getState.call(this);\n                }\n                return state;\n           },\n\n           /**\n            * Set the current state of the running item.\n            * This should have the effect to restore the item state.\n            *\n            * @param {Object} state - the new state\n            * @returns {ItemRunner}\n            *\n            * @fires ItemRunner#error if the state type doesn't match\n            */\n           setState : function(state){\n\n                if(!_.isPlainObject(state)){\n                    return this.trigger('error', \"The item's state must be a JavaScript Plain Object: \" + (typeof state) + ' given');\n                }\n\n                //the state will be applied only when the rendering is made\n                if(flow.render.done === false){\n                    flow.render.pending.push(function(){\n                        this.setState(state);\n                    });\n                } else {\n\n                    if(_.isFunction(provider.setState)){\n\n                        /**\n                         * Calls the provider's setState\n                         * @callback SetStateItemProvider\n                         * @param {Object} state -  the state to set\n                         */\n                        provider.setState.call(this, state);\n                    }\n                }\n                return this;\n           },\n\n           /**\n            * Get the responses of the running item.\n            *\n            * @returns {Array} the item's responses\n            */\n           getResponses : function(){\n                var responses = [];\n                if(_.isFunction(provider.getResponses)){\n\n                    /**\n                     * Calls the provider's getResponses\n                     * @callback GetResponsesItemProvider\n                     * @returns {Array} the responses\n                     */\n                    responses = responses.concat(provider.getResponses.call(this));\n                }\n                return responses;\n           },\n\n           /**\n            * Attach an event handler.\n            * Calling `on` with the same eventName multiple times add callbacks: they\n            * will all be executed.\n            *\n            * @example itemRunner()\n            *               .on('statechange', function(state){\n            *                   //state === this.getState()\n            *               });\n            *\n            * @param {String} name - the name of the event to listen\n            * @param {Function} handler - the callback to run once the event is triggered. It's executed with the current itemRunner context (ie. this\n            * @returns {ItemRunner}\n            */\n            on : function(name, handler){\n                if(_.isString(name) && _.isFunction(handler)){\n                    events[name] = events[name] || [];\n                    events[name].push(handler);\n                }\n                return this;\n            },\n\n            /**\n            * Remove handlers for an event.\n            *\n            * @example itemRunner().off('statechange');\n            *\n            * @param {String} name - the event name\n            * @returns {ItemRunner}\n            */\n            off : function(name){\n                if(_.isString(name)){\n                    events[name] = [];\n                }\n                return this;\n            },\n\n            /**\n            * Trigger an event manually.\n            *\n            * @example itemRunner().trigger('statechange', new State());\n            *\n            * @param {String} name - the name of the event to trigger\n            * @param {*} data - arguments given to the handlers\n            * @returns {ItemRunner}\n            */\n            trigger : function(name, data){\n                var self = this;\n                if(_.isString(name) && _.isArray(events[name])){\n                    _.forEach(events[name], function(event){\n                        event.call(self, data);\n                    });\n                }\n                return this;\n            }\n        };\n\n        return ItemRunner;\n    };\n\n    /**\n     * Register an <i>Item Runtime Provider</i> into the item runner.\n     * The provider provides the behavior required by the item runner.\n     *\n     * @param {String} name - the provider name will be used to select the provider while instantiating the runner\n     *\n     * @param {Object} provider - the Item Runtime Provider as a plain object. The itemRunner forwards encapsulate and delegate calls to the provider.\n     * @param {InitItemProvider} provider.init - the provider initializes the item from it's data, for example loading libraries, add some listeners, etc.\n     * @param {RenderItemProvider} provider.render - the provider renders the item within the given container element.\n     * @param {ClearItemProvider} [provider.clear] - the provider clears the item.\n     * @param {GetStateItemProvider} [provider.getState] - the provider get the item's state.\n     * @param {SetStateItemProvider} [provider.setState] - the provider restore the item to the given state.\n     * @param {GetRespnsesItemProvider} [provider.getResponses] - the provider gives the current responses.\n     *\n     * @throws TypeError when a wrong provider is given or an empty name.\n     */\n    itemRunnerFactory.register = function registerProvider(name, provider){\n        //type checking\n        if(!_.isString(name) || name.length <= 0){\n            throw new TypeError('It is required to give a name to your provider.');\n        }\n        if(!_.isPlainObject(provider) || (!_.isFunction(provider.init) && !_.isFunction(provider.render))){\n            throw new TypeError('A provider is an object that contains at least an init function or a render function.');\n        }\n\n        this.providers = this.providers || {};\n        this.providers[name] = provider;\n    };\n\n    return itemRunnerFactory;\n});\n\n","define('taoQtiItem/qtiItem/core/qtiClasses',[], function(){\n    return {\n        '_container' : 'taoQtiItem/qtiItem/core/Container',\n        'assessmentItem' : 'taoQtiItem/qtiItem/core/Item',\n        'responseProcessing' : 'taoQtiItem/qtiItem/core/ResponseProcessing',\n        '_simpleFeedbackRule' : 'taoQtiItem/qtiItem/core/response/SimpleFeedbackRule',\n        'stylesheet' : 'taoQtiItem/qtiItem/core/Stylesheet',\n        'math' : 'taoQtiItem/qtiItem/core/Math',\n        'img' : 'taoQtiItem/qtiItem/core/Img',\n        'object' : 'taoQtiItem/qtiItem/core/Object',\n        'outcomeDeclaration' : 'taoQtiItem/qtiItem/core/variables/OutcomeDeclaration',\n        'responseDeclaration' : 'taoQtiItem/qtiItem/core/variables/ResponseDeclaration',\n        'rubricBlock' : 'taoQtiItem/qtiItem/core/RubricBlock',\n        'associableHotspot' : 'taoQtiItem/qtiItem/core/choices/AssociableHotspot',\n        'gap' : 'taoQtiItem/qtiItem/core/choices/Gap',\n        'gapImg' : 'taoQtiItem/qtiItem/core/choices/GapImg',\n        'gapText' : 'taoQtiItem/qtiItem/core/choices/GapText',\n        'hotspotChoice' : 'taoQtiItem/qtiItem/core/choices/HotspotChoice',\n        'hottext' : 'taoQtiItem/qtiItem/core/choices/Hottext',\n        'inlineChoice' : 'taoQtiItem/qtiItem/core/choices/InlineChoice',\n        'simpleAssociableChoice' : 'taoQtiItem/qtiItem/core/choices/SimpleAssociableChoice',\n        'simpleChoice' : 'taoQtiItem/qtiItem/core/choices/SimpleChoice',\n        'associateInteraction' : 'taoQtiItem/qtiItem/core/interactions/AssociateInteraction',\n        'choiceInteraction' : 'taoQtiItem/qtiItem/core/interactions/ChoiceInteraction',\n        'endAttemptInteraction' : 'taoQtiItem/qtiItem/core/interactions/EndAttemptInteraction',\n        'extendedTextInteraction' : 'taoQtiItem/qtiItem/core/interactions/ExtendedTextInteraction',\n        'gapMatchInteraction' : 'taoQtiItem/qtiItem/core/interactions/GapMatchInteraction',\n        'graphicAssociateInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicAssociateInteraction',\n        'graphicGapMatchInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicGapMatchInteraction',\n        'graphicOrderInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicOrderInteraction',\n        'hotspotInteraction' : 'taoQtiItem/qtiItem/core/interactions/HotspotInteraction',\n        'hottextInteraction' : 'taoQtiItem/qtiItem/core/interactions/HottextInteraction',\n        'inlineChoiceInteraction' : 'taoQtiItem/qtiItem/core/interactions/InlineChoiceInteraction',\n        'matchInteraction' : 'taoQtiItem/qtiItem/core/interactions/MatchInteraction',\n        'mediaInteraction' : 'taoQtiItem/qtiItem/core/interactions/MediaInteraction',\n        'orderInteraction' : 'taoQtiItem/qtiItem/core/interactions/OrderInteraction',\n        'prompt' : 'taoQtiItem/qtiItem/core/interactions/Prompt',\n        'selectPointInteraction' : 'taoQtiItem/qtiItem/core/interactions/SelectPointInteraction',\n        'sliderInteraction' : 'taoQtiItem/qtiItem/core/interactions/SliderInteraction',\n        'textEntryInteraction' : 'taoQtiItem/qtiItem/core/interactions/TextEntryInteraction',\n        'uploadInteraction' : 'taoQtiItem/qtiItem/core/interactions/UploadInteraction',\n        'feedbackBlock' : 'taoQtiItem/qtiItem/core/feedbacks/FeedbackBlock',\n        'feedbackInline' : 'taoQtiItem/qtiItem/core/feedbacks/FeedbackInline',\n        'modalFeedback' : 'taoQtiItem/qtiItem/core/feedbacks/ModalFeedback',\n        'customInteraction' : 'taoQtiItem/qtiItem/core/interactions/CustomInteraction',\n        'infoControl' : 'taoQtiItem/qtiItem/core/PortableInfoControl'\n    };\n});\n","/**\n * Common basic util functions\n */\ndefine('taoQtiItem/qtiItem/helper/util',['lodash'], function(_){\n    var util = {\n        buildSerial : function buildSerial(prefix){\n            var id = prefix || '';\n            var chars = \"abcdefghijklmnopqrstuvwxyz0123456789\";\n            for(var i = 0; i < 22; i++){\n                id += chars.charAt(Math.floor(Math.random() * chars.length));\n            }\n            return id;\n        },\n        fullpath : function fullpath(src, baseUrl){\n\n            src = src || '';\n            baseUrl = baseUrl || '';\n\n            if(src){\n\n                src = src.replace(/^\\//, '');\n\n                if(!src.match(/^http/i)){\n\n                    if(baseUrl && !baseUrl.match(/\\/$/)){\n                        baseUrl += '/';\n                    }\n\n                    src = baseUrl + src;\n                }\n            }\n\n            return src;\n        },\n        findInCollection : function findInCollection(element, collectionNames, searchedSerial){\n\n            var found = null;\n\n            if(_.isString(collectionNames)){\n                collectionNames = [collectionNames];\n            }\n\n            if(_.isArray(collectionNames)){\n\n                _.each(collectionNames, function(collectionName){\n\n                    //get collection to search in (resolving case like interaction.choices.0\n                    var collection = element;\n                    _.each(collectionName.split('.'), function(nameToken){\n                        collection = collection[nameToken];\n                    });\n                    var elt = collection[searchedSerial];\n\n                    if(elt){\n                        found = {'parent' : element, 'element' : elt};\n                        return false;//break the each loop\n                    }\n\n                    //search inside each elements:\n                    _.each(collection, function(elt){\n\n                        if(_.isFunction(elt.find)){\n                            found = elt.find(searchedSerial);\n                            if(found){\n                                return false;//break the each loop\n                            }\n                        }\n\n                    });\n\n                    if(found){\n                        return false;//break the each loop\n                    }\n\n                });\n\n            }else{\n\n                throw new Error('invalid argument : collectionNames must be an array or a string');\n            }\n\n            return found;\n        },\n        addMarkupNamespace : function addMarkupNamespace(markup, ns){\n            if(ns) {\n                markup = markup.replace(/<(\\/)?([a-z]+)(\\s?)([^><]*)>/g, '<$1' + ns + ':$2$3$4>');\n                return markup;\n            }\n            return markup;\n\n        },\n        removeMarkupNamespaces : function removeMarkupNamespace(markup){\n            return markup.replace(/<(\\/)?(\\w*):([^>]*)>/g, '<$1$3>');\n        },\n        getMarkupUsedNamespaces : function getMarkupUsedNamespaces(markup){\n            var namespaces = [];\n            markup.replace(/<(\\/)?(\\w*):([^>]*)>/g, function(original, slash, ns, node){\n                namespaces.push(ns);\n                return '<'+slash+node+'>';\n            });\n            return _.uniq(namespaces);\n        }\n    };\n\n    return util;\n});\n","define('taoQtiItem/qtiItem/helper/rendererConfig',['lodash', 'jquery'], function(_, $){\n\n    var rendererConfigHelper = {};\n\n    rendererConfigHelper.getOptionsFromArguments = function(args){\n\n        var options = {\n            data : {},\n            placeholder : null,\n            subclass : '',\n            renderer : null\n        };\n        \n        _.each(args, function(arg){\n            if(arg){\n                if(arg.isRenderer){\n                    options.renderer = arg;\n                }else if(arg instanceof $ && arg.length){\n                    options.placeholder = arg;\n                }else if(_.isString(arg)){\n                    options.subclass = arg;\n                }else if(_.isPlainObject(arg)){\n                    options.data = arg;\n                }else{\n                    console.log('invalid arg', arg, args);\n                }\n            }\n        });\n        \n        return options;\n    };\n    \n    return rendererConfigHelper;\n});\n\n","define('taoQtiItem/qtiItem/core/Element',['jquery', 'class', 'lodash', 'taoQtiItem/qtiItem/helper/util', 'taoQtiItem/qtiItem/helper/rendererConfig'], function($, Class, _, util, rendererConfig){\n\n    var _instances = {};\n\n    var Element = Class.extend({\n        qtiClass : '',\n        serial : '',\n        relatedItem : null,\n        init : function(serial, attributes){\n\n            //init own attributes\n            this.attributes = {};\n\n            //system properties, for item creator internal use only\n            this.metaData = {};\n\n            //init call in the format init(attributes)\n            if(typeof (serial) === 'object'){\n                attributes = serial;\n                serial = '';\n            }\n\n            if(!serial){\n                serial = util.buildSerial(this.qtiClass + '_');\n            }\n\n            if(serial && (typeof serial !== 'string' || !serial.match(/^[a-z_0-9]*$/i))){\n                throw 'invalid QTI serial : (' + (typeof serial) + ') ' + serial;\n            }\n\n            if(!_instances[serial]){\n                _instances[serial] = this;\n                this.serial = serial;\n                this.setAttributes(attributes || {});\n            }else{\n                throw 'a QTI Element with the same serial already exists ' + serial;\n            }\n\n            if(typeof this.initContainer === 'function'){\n                this.initContainer(arguments[2] || '');\n            }\n            if(typeof this.initObject === 'function'){\n                this.initObject();\n            }\n        },\n        is : function(qtiClass){\n            return (qtiClass === this.qtiClass);\n        },\n        placeholder : function(){\n            return '{{' + this.serial + '}}';\n        },\n        getSerial : function(){\n            return this.serial;\n        },\n        getUsedIdentifiers : function(){\n            var usedIds = {};\n            var elts = this.getComposingElements();\n            for(var i in elts){\n                var elt = elts[i];\n                var id = elt.attr('identifier');\n                if(id){\n                    //warning: simplistic implementation, allow only one unique identifier in the item no matter the element class/type\n                    usedIds[id] = elt;\n                }\n            }\n            return usedIds;\n        },\n        attr : function(name, value){\n            if(name){\n                if(value !== undefined){\n                    this.attributes[name] = value;\n                }else{\n                    if(typeof (name) === 'object'){\n                        for(var prop in name){\n                            this.attr(prop, name[prop]);\n                        }\n                    }else if(typeof (name) === 'string'){\n                        if(this.attributes[name] === undefined){\n                            return undefined;\n                        }else{\n                            return this.attributes[name];\n                        }\n                    }\n                }\n            }\n            return this;\n        },\n        data : function(name, value){\n            if(name){\n                if(value !== undefined){\n                    this.metaData[name] = value;\n                    $(document).trigger('metaChange.qti-widget', {element : this, key : name, value : value});\n                }else{\n                    if(typeof (name) === 'object'){\n                        for(var prop in name){\n                            this.data(prop, name[prop]);\n                        }\n                    }else if(typeof (name) === 'string'){\n                        if(this.metaData[name] === undefined){\n                            return undefined;\n                        }else{\n                            return this.metaData[name];\n                        }\n                    }\n                }\n            }\n            return this;\n        },\n        removeData : function(name){\n            delete this.metaData[name];\n            return this;\n        },\n        removeAttr : function(name){\n            return this.removeAttributes(name);\n        },\n        setAttributes : function(attributes){\n            this.attributes = attributes;\n            return this;\n        },\n        getAttributes : function(){\n            return _.clone(this.attributes);\n        },\n        removeAttributes : function(attrNames){\n            if(typeof (attrNames) === 'string'){\n                attrNames = [attrNames];\n            }\n            for(var i in attrNames){\n                delete this.attributes[attrNames[i]];\n            }\n            return this;\n        },\n        getComposingElements : function(){\n            var elts = {};\n            function append(element){\n                elts[element.getSerial()] = element;//pass individual object by ref, instead of the whole list(object)\n                elts = _.extend(elts, element.getComposingElements());\n            }\n            if(typeof this.initContainer === 'function'){\n                append(this.getBody());\n            }\n            if(typeof this.initObject === 'function'){\n                append(this.getObject());\n            }\n            _.each(this.metaData, function(v){\n                if(Element.isA(v, '_container')){\n                    append(v);\n                }else if(_.isArray(v)){\n                    _.each(v, function(v){\n                        if(Element.isA(v, '_container')){\n                            append(v);\n                        }\n                    });\n                }\n            });\n            return elts;\n        },\n        getUsedClasses : function(){\n\n            var ret = [this.qtiClass],\n                composingElts = this.getComposingElements();\n\n            _.each(composingElts, function(elt){\n                ret.push(elt.qtiClass);\n            });\n\n            return _.uniq(ret);\n        },\n        find : function(serial){\n\n            var found = null;\n\n            if(typeof this.initObject === 'function'){\n                var object = this.getObject();\n                if(object.serial === serial){\n                    found = {'parent' : this, 'element' : object, 'location' : 'object'};\n                }\n            }\n\n            if(!found && typeof this.initContainer === 'function'){\n                found = this.getBody().find(serial, this);\n            }\n\n            return found;\n        },\n        parent : function(){\n            var item = this.getRelatedItem();\n            if(item){\n                var found = item.find(this.getSerial());\n                if(found){\n                    return found.parent;\n                }\n            }\n            return null;\n        },\n        setRelatedItem : function(item, recursive){\n\n            recursive = (typeof recursive === 'undefined') ? true : recursive;\n\n            if(Element.isA(item, 'assessmentItem')){\n                this.relatedItem = item;\n                var composingElts = this.getComposingElements();\n                for(var i in composingElts){\n                    composingElts[i].setRelatedItem(item, false);\n                }\n            }\n\n        },\n        getRelatedItem : function(){\n            var ret = null;\n            if(Element.isA(this.relatedItem, 'assessmentItem')){\n                ret = this.relatedItem;\n            }\n            return ret;\n        },\n        setRenderer : function(renderer){\n            if(renderer && renderer.isRenderer){\n                this.renderer = renderer;\n                var elts = this.getComposingElements();\n                for(var serial in elts){\n                    elts[serial].setRenderer(renderer);\n                }\n            }else{\n                throw 'invalid qti rendering engine';\n            }\n        },\n        getRenderer : function(){\n            return this.renderer;\n        },\n        render : function(){\n\n            var args = rendererConfig.getOptionsFromArguments(arguments);\n            var renderer = args.renderer || this.getRenderer();\n\n            var tplData = {},\n                defaultData = {\n                    'tag' : this.qtiClass,\n                    'serial' : this.serial,\n                    'attributes' : this.getAttributes()\n                };\n\n            if(!renderer){\n                throw 'render: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\n            }\n\n            if(typeof this.initContainer === 'function'){\n                defaultData.body = this.getBody().render(renderer);\n            }\n            if(typeof this.initObject === 'function'){\n                defaultData.object = {\n                    attributes : this.object.getAttributes()\n                };\n                defaultData.object.attributes.data = renderer.getAbsoluteUrl(this.object.attr('data'));\n            }\n\n            tplData = _.merge(defaultData, args.data || {});\n            tplData = renderer.getData(this, tplData, args.subclass);\n            var rendering = renderer.renderTpl(this, tplData, args.subclass);\n            if(args.placeholder){\n                args.placeholder.replaceWith(rendering);\n            }\n\n            return rendering;\n        },\n        postRender : function(data, altClassName, renderer){\n\n            renderer = renderer || this.getRenderer();\n\n            if(typeof this.initContainer === 'function'){\n                //post render body element\n                this.getBody().postRender({}, '', renderer);\n            }\n\n            if(renderer){\n                return renderer.postRender(this, data, altClassName);\n            }else{\n                throw 'postRender: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\n            }\n        },\n        getContainer : function($scope, subclass){\n            var renderer = this.getRenderer();\n            if(renderer){\n                return renderer.getContainer(this, $scope, subclass);\n            }else{\n                throw 'getContainer: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\n            }\n        },\n        toArray : function(){\n            var arr = {\n                serial : this.serial,\n                type : this.qtiClass,\n                attributes : this.getAttributes()\n            };\n\n            if(typeof this.initContainer === 'function'){\n                arr.body = this.getBody().toArray();\n            }\n            if(typeof this.initObject === 'function'){\n                arr.object = this.object.toArray();\n            }\n\n            return arr;\n        },\n        isEmpty : function(){\n            //tells whether the element should be considered empty or not, from the rendering point of view\n            return false;\n        },\n        addClass : function(className){\n            var clazz = this.attr('class') || '';\n            if(!_containClass(clazz, className)){\n                this.attr('class', clazz + (clazz.length ? ' ' : '') + className);\n            }\n        },\n        hasClass : function(className){\n            return _containClass(this.attr('class'), className);\n        },\n        removeClass : function(className){\n\n            var clazz = this.attr('class') || '';\n            if(clazz){\n                var regex = new RegExp('(?:^|\\\\s)' + className + '(?:\\\\s|$)', '');\n                clazz = clazz.replace(regex, '').replace(/^\\s+/, '');\n                if(clazz){\n                    this.attr('class', clazz);\n                }else{\n                    this.removeAttr('class');\n                }\n            }\n        },\n        isset : function(){\n            return Element.issetElement(this.serial);\n        },\n        unset : function(){\n            return Element.unsetElement(this.serial);\n        }\n    });\n\n    var _containClass = function(allClassStr, className){\n        var regex = new RegExp('(?:^|\\\\s)' + className + '(?:\\\\s|$)', '');\n        return allClassStr && regex.test(allClassStr);\n    };\n\n    //helpers\n    Element.isA = function(qtiElement, qtiClass){\n        return (qtiElement instanceof Element && qtiElement.is(qtiClass));\n    };\n\n    Element.getElementBySerial = function(serial){\n        return _instances[serial];\n    };\n\n    Element.issetElement = function(serial){\n        return !!_instances[serial];\n    };\n   \n    /**\n     * Unset a registered element from it's serial\n     * @param {String} serial - the element serial\n     * @returns {Boolean} true if unset\n     */ \n    Element.unsetElement = function(serial){\n\n        var element = Element.getElementBySerial(serial);\n\n        if(element){\n\n            var composingElements = element.getComposingElements();\n            _.each(composingElements, function(elt){\n                delete _instances[elt.serial];\n            });\n            delete _instances[element.serial];\n            \n            return true;\n        }\n        return false;\n    };\n\n    return Element;\n});\n\n\n\n","//@todo : move this to the ../helper directory\ndefine('taoQtiItem/qtiItem/core/Loader',['lodash', 'class', 'taoQtiItem/qtiItem/core/qtiClasses', 'taoQtiItem/qtiItem/core/Element'], function(_, Class, qtiClasses, Element){\n\n    var Loader = Class.extend({\n        init : function(item, classesLocation){\n\n            this.qti = {}; //loaded qti classes are store here\n            this.classesLocation = {};\n\n            this.item = item || null;//starts either from scratch or with an existing item object\n            this.setClassesLocation(classesLocation || qtiClasses);//load default location for qti classes model\n        },\n        setClassesLocation : function(qtiClasses){\n            _.extend(this.classesLocation, qtiClasses);\n            return this;\n        },\n        getRequiredClasses : function(data){\n            var ret = [];\n            for(var i in data){\n                if(i === 'qtiClass' && data[i] !== '_container' && i !== 'relatedItem'){//although a _container is a concrete class in TAO, it is not defined in QTI standard\n                    ret.push(data[i]);\n                }else if(typeof(data[i]) === 'object' && i !== 'responseRules'){    //responseRules should'nt be part of the parsing\n                    ret = _.union(ret, this.getRequiredClasses(data[i]));\n                }\n            }\n            return ret;\n        },\n        loadRequiredClasses : function(data, callback, reload){\n\n            var requiredClasses = this.getRequiredClasses(data, reload), required = [];\n\n            for(var i in requiredClasses){\n                var requiredClass = requiredClasses[i];\n                if(this.classesLocation[requiredClass]){\n                    required.push(this.classesLocation[requiredClass]);\n                }else{\n                    throw new Error('missing qti class location declaration : ' + requiredClass);\n                }\n            }\n\n            var _this = this;\n            require(required, function(){\n                _.each(arguments, function(QtiClass){\n                    _this.qti[QtiClass.prototype.qtiClass] = QtiClass;\n                });\n                callback.call(_this, _this.qti);\n            });\n        },\n        getLoadedClasses : function(){\n            return _.keys(this.qti);\n        },\n        loadItemData : function(data, callback){\n\n            var _this = this;\n            _this.loadRequiredClasses(data, function(Qti){\n                var i;\n                if(typeof(data) === 'object' && data.qtiClass === 'assessmentItem'){\n\n                    //unload an item from it's serial (in case of a reload)\n                    if(data.serial){\n                        Element.unsetElement(data.serial);\n                    }\n\n                    _this.item = new Qti.assessmentItem(data.serial, data.attributes || {});\n                    _this.loadContainer(_this.item.getBody(), data.body);\n\n                    for(i in data.outcomes){\n                        var outcome = _this.buildOutcome(data.outcomes[i]);\n                        if(outcome){\n                            _this.item.addOutcomeDeclaration(outcome);\n                        }\n                    }\n                    for(i in data.feedbacks){\n                        var feedback = _this.buildElement(data.feedbacks[i]);\n                        if(feedback){\n                            _this.item.addModalFeedback(feedback);\n                        }\n                    }\n                    for(i in data.stylesheets){\n                        var stylesheet = _this.buildElement(data.stylesheets[i]);\n                        if(stylesheet){\n                            _this.item.addStylesheet(stylesheet);\n                        }\n                    }\n\n                    //important : build responses after all modal feedbacks and outcomes has been loaded, because the simple feedback rules need to reference them\n                    for(i in data.responses){\n                        var response = _this.buildResponse(data.responses[i]);\n                        if(response){\n                            _this.item.addResponseDeclaration(response);\n\n                            var feedbackRules = data.responses[i].feedbackRules;\n                            if(feedbackRules){\n                                _.forIn(feedbackRules, function(fbData, serial){\n                                    response.feedbackRules[serial] = _this.buildSimpleFeedbackRule(fbData);\n                                });\n                            }\n                        }\n                    }\n\n                    if(data.responseProcessing){\n                        _this.item.setResponseProcessing(_this.buildResponseProcessing(data.responseProcessing));\n                    }\n                    _this.item.setNamespaces(data.namespaces);\n                }\n\n                if(typeof(callback) === 'function'){\n                    callback.call(_this, _this.item);\n                }\n            });\n        },\n        loadElement : function(data, callback){\n\n            var _this = this;\n\n            _this.loadRequiredClasses(data, function(Qti){\n\n                var element = _this.buildElement(data);\n\n                if(typeof(callback) === 'function'){\n                    callback.call(_this, element);\n                }\n            });\n        },\n        /**\n         * Load ALL given elements into existing loaded item\n         *\n         * @todo to be renamed to loadItemElements\n         * @param {object} data\n         * @param {function} callback\n         * @returns {undefined}\n         */\n        loadElements : function(data, callback){\n\n            var _this = this;\n\n            if(_this.item){\n\n                this.loadRequiredClasses(data, function(){\n\n                    var allElements = _this.item.getComposingElements();\n\n                    for(var i in data){\n                        var elementData = data[i];\n                        if(elementData && elementData.qtiClass && elementData.serial){\n                            //find and update element\n                            if(allElements[elementData.serial]){\n                                _this.loadElementData(allElements[elementData.serial], elementData);\n                            }\n                        }\n                    }\n\n                    if(typeof(callback) === 'function'){\n                        callback.call(_this, _this.item);\n                    }\n                });\n            }else{\n                throw 'QtiLoader : cannot load elements in empty item';\n            }\n\n        },\n        buildResponse : function(data){\n\n            var response = this.buildElement(data);\n\n            response.template = data.howMatch || null;\n            response.defaultValue = data.defaultValue || null;\n            response.correctResponse = data.correctResponses || null;\n\n            if(_.size(data.mapping)){\n                response.mapEntries = data.mapping;\n            }else if(_.size(data.areaMapping)){\n                response.mapEntries = data.areaMapping;\n            }else{\n                response.mapEntries = {};\n            }\n\n            response.mappingAttributes = data.mappingAttributes || {};\n\n            return response;\n        },\n        buildSimpleFeedbackRule : function(data){\n\n            var feedbackRule = this.buildElement(data);\n\n            if(data.condition){\n                feedbackRule.condition = data.condition;\n            }\n            if(data.comparedValue){\n                feedbackRule.comparedValue = data.comparedValue;\n            }\n\n            feedbackRule.comparedOutcome = this.item.responses[data.comparedOutcome] || null;\n            feedbackRule.feedbackOutcome = this.item.outcomes[data.feedbackOutcome] || null;\n            feedbackRule.feedbackThen = this.item.modalFeedbacks[data.feedbackThen] || null;\n            feedbackRule.feedbackElse = this.item.modalFeedbacks[data.feedbackElse] || null;\n\n            return feedbackRule;\n        },\n        buildOutcome : function(data){\n            var outcome = this.buildElement(data);\n            outcome.defaultValue = data.defaultValue || null;\n            return outcome;\n        },\n        buildResponseProcessing : function(data){\n            var rp = this.buildElement(data);\n            if(data && data.processingType){\n                if(data.processingType === 'custom'){\n                    rp.xml = data.data;\n                    rp.processingType = 'custom';\n                }else{\n                    rp.processingType = 'templateDriven';\n                }\n            }\n            return rp;\n        },\n        loadContainer : function(bodyObject, bodyData){\n            if(!Element.isA(bodyObject, '_container')){\n                throw 'bodyObject must be a QTI Container';\n            }\n\n            if(bodyData && typeof bodyData.body === 'string' && (typeof bodyData.elements === 'array' || typeof bodyData.elements === 'object')){\n                for(var serial in bodyData.elements){\n                    var eltData = bodyData.elements[serial];\n                    //check if class is loaded:\n                    var element = this.buildElement(eltData);\n                    if(element){\n                        bodyObject.setElement(element, bodyData.body);\n                    }\n                }\n                bodyObject.body(bodyData.body);\n            }else{\n                throw 'wrong bodydata format';\n            }\n        },\n        buildElement : function(elementData){\n            var elt = null;\n            if(elementData && elementData.qtiClass && elementData.serial){\n                var className = elementData.qtiClass;\n                if(this.qti[className]){\n                    elt = new this.qti[className](elementData.serial);\n                    this.loadElementData(elt, elementData);\n                }else{\n                    throw 'the qti element class does not exist: ' + className;\n                }\n            }else{\n                throw 'wrong elementData format';\n            }\n            return elt;\n        },\n        loadElementData : function(element, data){\n\n            element.setAttributes(_.clone(data.attributes) || {});\n\n            if(element.body && data.body){\n                if(element.bdy){\n                    this.loadContainer(element.getBody(), data.body);\n                }\n            }\n\n            if(element.object && data.object){\n                if(element.object){\n                    this.loadObjectData(element.object, data.object);\n                }\n            }\n\n            if(Element.isA(element, 'interaction')){\n                this.loadInteractionData(element, data);\n            }else if(Element.isA(element, 'choice')){\n                this.loadChoiceData(element, data);\n            }else if(Element.isA(element, 'math')){\n                this.loadMathData(element, data);\n            }else if(Element.isA(element, 'infoControl')){\n                this.loadPicData(element, data);\n            }\n\n            return element;\n        },\n        loadInteractionData : function(interaction, data){\n            if(Element.isA(interaction, 'blockInteraction')){\n                if(data.prompt){\n                    this.loadContainer(interaction.prompt.getBody(), data.prompt);\n                }\n            }\n\n            this.buildInteractionChoices(interaction, data);\n\n            if(Element.isA(interaction, 'customInteraction')){\n                this.loadPciData(interaction, data);\n            }\n        },\n        buildInteractionChoices : function(interaction, data){\n\n            //note: Qti.ContainerInteraction (Qti.GapMatchInteraction and Qti.HottextInteraction) has already been parsed by builtElement(interacionData);\n            if(data.choices){\n                if(Element.isA(interaction, 'matchInteraction')){\n                    for(var set = 0; set < 2; set++){\n                        if(!data.choices[set]){\n                            throw 'missing match set #' + set;\n                        }\n                        var matchSet = data.choices[set];\n                        for(var serial in matchSet){\n                            var choice = this.buildElement(matchSet[serial]);\n                            if(choice){\n                                interaction.addChoice(choice, set);\n                            }\n                        }\n                    }\n                }else{\n                    for(var serial in data.choices){\n                        var choice = this.buildElement(data.choices[serial]);\n                        if(choice){\n                            interaction.addChoice(choice);\n                        }\n                    }\n                }\n\n                if(Element.isA(interaction, 'graphicGapMatchInteraction')){\n                    if(data.gapImgs){\n                        for(var serial in data.gapImgs){\n                            var gapImg = this.buildElement(data.gapImgs[serial]);\n                            if(gapImg){\n                                interaction.addGapImg(gapImg);\n                            }\n                        }\n                    }\n                }\n\n            }\n\n        },\n        loadChoiceData : function(choice, data){\n            if(Element.isA(choice, 'textVariableChoice')){\n                choice.val(data.text);\n            }else if(Element.isA(choice, 'gapImg')){\n                //has already been taken care of in buildElement()\n            }else if(Element.isA(choice, 'containerChoice')){\n                //has already been taken care of in buildElement()\n            }\n        },\n        loadObjectData : function(object, data){\n            object.setAttributes(data.attributes);\n            //@todo: manage object like a container\n            if(data._alt){\n                if(data._alt.qtiClass === 'object'){\n                    object._alt = Loader.buildElement(data._alt);\n                }else{\n                    object._alt = data._alt;\n                }\n            }\n        },\n        loadMathData : function(math, data){\n            math.ns = data.ns || {};\n            math.setMathML(data.mathML || '');\n            math.annotations = data.annotations || {};\n        },\n        loadPciData : function(pci, data){\n            loadPortableCustomElementData(pci, data);\n        },\n        loadPicData : function(pic, data){\n            loadPortableCustomElementData(pic, data);\n        }\n    });\n\n    function loadPortableCustomElementData(portableElement, data){\n        portableElement.typeIdentifier = data.typeIdentifier;\n        portableElement.markup = data.markup;\n        portableElement.entryPoint = data.entryPoint;\n        portableElement.properties = data.properties;\n        portableElement.libraries = data.libraries;\n    }\n\n    return Loader;\n});\n\n","/**\n * Common helper functions\n */\ndefine('taoQtiItem/qtiItem/helper/interactionHelper',['lodash', 'taoQtiItem/qtiItem/core/Element'], function(_, Element){\n    return {\n        convertChoices : function(choices, outputType){\n\n            var ret = [], _this = this;\n\n            _.each(choices, function(c){\n                if(Element.isA(c, 'choice')){\n                    switch(outputType){\n                        case 'serial':\n                            ret.push(c.getSerial());\n                            break;\n                        case 'identifier':\n                            ret.push(c.id());\n                            break;\n                        default:\n                            ret.push(c);\n                    }\n\n                }else if(_.isArray(c)){\n                    ret.push(_this.convertChoices(c, outputType));\n                }\n            });\n\n            return ret;\n        },\n        findChoices : function(interaction, choices, inputType){\n\n            var ret = [], _this = this;\n\n            _.each(choices, function(c){\n                var choice;\n                if(_.isString(c)){\n                    if(inputType === 'serial'){\n                        choice = interaction.getChoice(c);\n                        if(choice){\n                            ret.push(choice);\n                        }\n                    }else if(inputType === 'identifier'){\n                        choice = interaction.getChoiceByIdentifier(c);\n                        if(choice){\n                            ret.push(choice);\n                        }\n                    }else{\n                        ret.push(c);\n                    }\n                }else if(_.isArray(c)){\n                    ret.push(_this.findChoices(interaction, c, inputType));\n                }else{\n                    ret.push(c);\n                }\n            });\n\n            return ret;\n        },\n        shuffleChoices : function(choices){\n            var r = [], //returned array\n                f = {}, //fixed choices array\n                j = 0;\n\n            for(var i in choices){\n                if(Element.isA(choices[i], 'choice')){\n                    var choice = choices[i];\n                    if(choice.attr('fixed')){\n                        f[j] = choice;\n                    }\n                    r.push(choice);\n                    j++;\n                }else{\n                    throw 'invalid element in array: is not a qti choice';\n                }\n            }\n\n            for(var n = 0; n < r.length - 1; n++){\n                if(f[n]){\n                    continue;\n                }\n                var k = -1;\n                do{\n                    k = n + Math.floor(Math.random() * (r.length - n));\n                }while(f[k]);\n                var tmp = r[k];\n                r[k] = r[n];\n                r[n] = tmp;\n            }\n\n            return r;\n        },\n        serialToIdentifier : function(interaction, choiceSerial){\n            var choice = interaction.getChoice(choiceSerial);\n            if(choice){\n                return choice.id();\n            }else{\n                return '';\n            }\n        }\n    }\n});\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\n *\n */\n\n/**\n * A factory to create a QTI renderer.\n *\n * @author Sam Sipasseuth <sam@taotesting.com>\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiItem/qtiRunner/core/Renderer',[\n    'lodash',\n    'jquery',\n    'handlebars',\n    'taoQtiItem/qtiItem/core/Element',\n    'taoQtiItem/qtiItem/helper/interactionHelper'\n], function(_, $, Handlebars, Element, interactionHelper){\n    'use strict';\n\n    var _isValidRenderer = function(renderer){\n\n        var valid = true;\n\n        if(typeof (renderer) !== 'object'){\n            return false;\n        }\n\n        var classCorrect = false;\n        if(renderer.qtiClass){\n            if(_.indexOf(_renderableClasses, renderer.qtiClass) >= 0){\n                classCorrect = true;\n            }else{\n                var pos = renderer.qtiClass.indexOf('.');\n                if(pos > 0){\n                    var qtiClass = renderer.qtiClass.slice(0, pos);\n                    var subClass = renderer.qtiClass.slice(pos + 1);\n                    if(_renderableSubclasses[qtiClass] && _.indexOf(_renderableSubclasses[qtiClass], subClass) >= 0){\n                        classCorrect = true;\n                    }\n                }\n            }\n        }\n        if(!classCorrect){\n            valid = false;\n            throw new Error('invalid qti class name in renderer declaration : ' + renderer.qtiClass);\n        }\n\n        if(!renderer.template){\n            valid = false;\n            throw new Error('missing template in renderer declaration : ' + renderer.qtiClass);\n        }\n\n        return valid;\n    };\n\n    var _renderableClasses = [\n        '_container',\n        'assessmentItem',\n        'stylesheet',\n        'responseDeclaration',\n        'outcomeDeclaration',\n        'responseProcessing',\n        '_simpleFeedbackRule',\n        'img',\n        'math',\n        'object',\n        'modalFeedback',\n        'rubricBlock',\n        'associateInteraction',\n        'choiceInteraction',\n        'extendedTextInteraction',\n        'gapMatchInteraction',\n        'graphicAssociateInteraction',\n        'graphicGapMatchInteraction',\n        'graphicOrderInteraction',\n        'hotspotInteraction',\n        'hottextInteraction',\n        'inlineChoiceInteraction',\n        'matchInteraction',\n        'mediaInteraction',\n        'orderInteraction',\n        'selectPointInteraction',\n        'sliderInteraction',\n        'textEntryInteraction',\n        'uploadInteraction',\n        'endAttemptInteraction',\n        'customInteraction',\n        'prompt',\n        'associableHotspot',\n        'gap',\n        'gapImg',\n        'gapText',\n        'hotspotChoice',\n        'hottext',\n        'inlineChoice',\n        'simpleAssociableChoice',\n        'simpleChoice',\n        'infoControl'\n    ];\n\n    var _dependencies = {\n        assessmentItem : ['stylesheet', '_container', 'prompt', 'modalFeedback'],\n        rubricBlock : ['_container'],\n        associateInteraction : ['simpleAssociableChoice'],\n        choiceInteraction : ['simpleChoice'],\n        gapMatchInteraction : ['gap', 'gapText'],\n        graphicAssociateInteraction : ['associableHotspot'],\n        graphicGapMatchInteraction : ['associableHotspot', 'gapImg'],\n        graphicOrderInteraction : ['hotspotChoice'],\n        hotspotInteraction : ['hotspotChoice'],\n        hottextInteraction : ['hottext'],\n        inlineChoiceInteraction : ['inlineChoice'],\n        matchInteraction : ['simpleAssociableChoice'],\n        orderInteraction : ['simpleChoice']\n    };\n\n    var _renderableSubclasses = {\n        'simpleAssociableChoice' : ['associateInteraction', 'matchInteraction'],\n        'simpleChoice' : ['choiceInteraction', 'orderInteraction']\n    };\n\n    /**\n     * Get the location of the document, useful to define a baseUrl for the required context\n     * @returns {String}\n     */\n    function getDocumentBaseUrl(){\n        return window.location.protocol + '//' + window.location.host + window.location.pathname.replace(/([^\\/]*)$/, '');\n    }\n\n    /**\n     * The built Renderer class\n     * @constructor\n     * @param {Object} [options] - the renderer options\n     * @param {Object} [options.decorators] - to set up rendering decorator\n     * @param {preRenderDecorator} [options.decorators.before] - to set up a pre decorator\n     * @param {postRenderDecorator} [options.decorators.after] - to set up a post decorator\n     */\n    var Renderer = function(options){\n\n        options = options || {};\n\n        this.isRenderer = true;\n        this.name = '';\n        this.shuffleChoices = (options.shuffleChoices !== undefined) ? options.shuffleChoices : true;\n\n        //store shuffled choice here\n        this.shuffledChoices = [];\n\n        /**\n         * Store the registered renderer location\n         */\n        var _locations = {};\n\n        /**\n         * Store loaded renderers\n         */\n        var _renderers = {};\n\n        /**\n         * Get the actual renderer of the give qti class or subclass:\n         * e.g. simplceChoice, simpleChoice.choiceInteraction, simpleChoice.orderInteraction\n         */\n        var _getClassRenderer = function(qtiClass){\n            var ret = null;\n            if(_renderers[qtiClass]){\n                ret = _renderers[qtiClass];\n            }else{\n                var pos = qtiClass.indexOf('.');\n                if(pos > 0){\n                    qtiClass = qtiClass.slice(0, pos);\n                    if(_renderers[qtiClass]){\n                        ret = _renderers[qtiClass];\n                    }\n                }\n            }\n            return ret;\n        };\n\n        /**\n         * Set the renderer options\n         * @param {String} key - the name of the option\n         * @param {*} value - the option vallue\n         * @returns {Renderer} for chaining\n         */\n        this.setOption = function(key, value){\n            if(typeof (key) === 'string'){\n                options[key] = value;\n            }\n            return this;\n        };\n\n        /**\n         * Set the renderer options\n         * @param {Object} opts - the options\n         * @returns {Renderer} for chaining\n         */\n        this.setOptions = function(opts){\n            _.extend(options, opts);\n            return this;\n        };\n\n        /**\n         * Get the renderer option\n         * @param {String} key - the name of the option\n         * @returns {*|null} the option vallue\n         */\n        this.getOption = function(key){\n            if(typeof (key) === 'string' && options[key]){\n                return options[key];\n            }\n            return null;\n        };\n\n        /**\n         * Renders the template\n         * @param {Object} element - the QTI model element\n         * @param {Object} data - the data to give to the template\n         * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\n         * @returns {String} the template results\n         * @throws {Error} if the renderer is not set or has no template bound\n         */\n        this.renderTpl = function(element, data, qtiSubclass){\n\n            var res;\n            var ret        = '';\n            var tplFound   = false;\n            var qtiClass   = qtiSubclass || element.qtiClass;\n            var renderer   = _getClassRenderer(qtiClass);\n            var decorators = this.getOption('decorators');\n\n            if(!renderer && !_.isFunction(renderer.template)){\n                throw new Error('no renderer template loaded under the class name : ' + qtiClass);\n            }\n\n            //pre rendering decoration\n            if(_.isObject(decorators) && _.isFunction(decorators.before)){\n\n                /**\n                 * @callback preRenderDecoractor\n                 * @param {Object} element - the QTI model element\n                 * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\n                 * @returns {String} the decorator result\n                 */\n                res = decorators.before(element, qtiSubclass);\n                if(_.isString(res)){\n                    ret += res;\n                }\n            }\n\n            //render the template\n            ret += renderer.template(data);\n\n\n            //post rendering decoration\n            if(_.isObject(decorators) && _.isFunction(decorators.after)){\n\n                /**\n                 * @callback postRenderDecoractor\n                 * @param {Object} element - the QTI model element\n                 * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\n                 * @returns {String} the decorator result\n                 */\n                res = decorators.after(element, qtiSubclass);\n                if(_.isString(res)){\n                    ret += res;\n                }\n            }\n            return ret;\n        };\n\n        this.getData = function(element, data, qtiSubclass){\n\n            var ret = data,\n                qtiClass = qtiSubclass || element.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.getData) === 'function'){\n                    ret = renderer.getData.call(this, element, data);\n                }\n            }\n\n            return ret;\n        };\n\n        this.renderDirect = function(tpl, data){\n            return Handlebars.compile(tpl)(data);\n        };\n\n        this.getContainer = function(qtiElement, $scope, qtiSubclass){\n\n            var ret = null,\n                qtiClass = qtiSubclass || qtiElement.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                ret = renderer.getContainer(qtiElement, $scope);\n            }else{\n                throw 'no renderer found for the class : ' + qtiElement.qtiClass;\n            }\n            return ret;\n        };\n\n        this.postRender = function(qtiElement, data, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiElement.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.render) === 'function'){\n                    ret = renderer.render.call(this, qtiElement, data);\n                }\n                //postRendering is optional, log missing call of postRender?\n            }\n\n            return ret;\n        };\n\n        this.setResponse = function(qtiInteraction, response, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.setResponse) === 'function'){\n                    ret = renderer.setResponse.call(this, qtiInteraction, response);\n                    var $container = renderer.getContainer.call(this, qtiInteraction);\n                    if($container instanceof $ && $container.length){\n                        $container.trigger('responseSet', [qtiInteraction, response]);\n                    }\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        this.getResponse = function(qtiInteraction, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.getResponse) === 'function'){\n                    ret = renderer.getResponse.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        this.resetResponse = function(qtiInteraction, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.resetResponse) === 'function'){\n                    ret = renderer.resetResponse.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        /**\n         * Retrieve the state of the interaction.\n         * If the renderer has no state management, it falls back to the response management.\n         *\n         * @param {Object} qtiInteraction - the interaction\n         * @param {String} [qtiSubClass] - (not sure of the type and how it is used - Sam ? )\n         * @returns {Object} the interaction's state\n         *\n         * @throws {Error} if no renderer is registered\n         */\n        this.getState = function(qtiInteraction, qtiSubclass){\n\n            var ret = false;\n            var qtiClass = qtiSubclass || qtiInteraction.qtiClass;\n            var renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(_.isFunction(renderer.getState)){\n                    ret = renderer.getState.call(this, qtiInteraction);\n                } else {\n                    ret = renderer.getResponse.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        /**\n         * Retrieve the state of the interaction.\n         * If the renderer has no state management, it falls back to the response management.\n         *\n         * @param {Object} qtiInteraction - the interaction\n         * @param {Object} state - the interaction's state\n         * @param {String} [qtiSubClass] - (not sure of the type and how it is used - Sam ? )\n         *\n         * @throws {Error} if no renderer is found\n         */\n        this.setState =  function(qtiInteraction, state, qtiSubclass){\n\n            var qtiClass = qtiSubclass || qtiInteraction.qtiClass;\n            var renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(_.isFunction(renderer.setState)){\n                    renderer.setState.call(this, qtiInteraction, state);\n                } else {\n                    renderer.resetResponse.call(this, qtiInteraction);\n                    renderer.setResponse.call(this, qtiInteraction, state);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n        };\n\n        /**\n         * Calls the renderer destroy.\n         * Ask the renderer to run destroy if exists.\n         *\n         * @throws {Error} if no renderer is found\n         */\n        this.destroy = function(qtiInteraction, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(_.isFunction(renderer.destroy)){\n                    ret = renderer.destroy.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        this.getLoadedRenderers = function(){\n            return _renderers;\n        };\n\n        this.register = function(renderersLocations){\n            _.extend(_locations, renderersLocations);\n        };\n\n        this.load = function(callback, requiredClasses){\n           var self = this;\n            var required = [];\n            if(requiredClasses){\n                if(_.isArray(requiredClasses)){\n\n                    //exclude abstract classes\n                    requiredClasses = _.intersection(requiredClasses, _renderableClasses);\n\n                    //add dependencies\n                    _.each(requiredClasses, function(reqClass){\n                        var deps = _dependencies[reqClass];\n                        if(deps){\n                            requiredClasses = _.union(requiredClasses, deps);\n                        }\n                    });\n\n                    _.forEach(requiredClasses, function(qtiClass){\n\n                        if(_renderableSubclasses[qtiClass]){\n                            var requiredSubClasses = _.intersection(requiredClasses, _renderableSubclasses[qtiClass]);\n                            _.each(requiredSubClasses, function(subclass){\n                                if(_locations[qtiClass + '.' + subclass]){\n                                    required.push(_locations[qtiClass + '.' + subclass]);\n                                }else if(_locations[qtiClass]){\n                                    required.push(_locations[qtiClass]);\n                                }else{\n                                    throw new Error(self.name + ' : missing qti class location declaration: ' + qtiClass + ', subclass: ' + subclass);\n                                }\n                            });\n                        } else {\n                            if(_locations[qtiClass] === false){\n                                _renderers[qtiClass] = false;//mark this class as not renderable\n                            }else if(_locations[qtiClass]){\n                                required.push(_locations[qtiClass]);\n                            }else{\n                                throw new Error(self.name + ' : missing qti class location declaration: ' + qtiClass);\n                            }\n                        }\n                    });\n                } else {\n                    throw new Error('invalid argument type: expected array for arg \"requireClasses\"');\n                }\n\n            }else{\n                required = _.values(_locations);\n            }\n\n            var _this = this;\n            require(required, function(){\n\n                _.each(arguments, function(clazz){\n                    if(_isValidRenderer(clazz)){\n                        _renderers[clazz.qtiClass] = clazz;\n                    }\n                });\n\n                if(typeof (callback) === 'function'){\n                    callback.call(_this, _renderers);\n                }\n            });\n\n            return this;\n        };\n\n        /**\n         * Define the shuffling manually\n         *\n         * @param {Object} interaction - the interaction\n         * @param {Array} choices - the shuffled choices\n         * @param {String} identificationType -\n         */\n        this.setShuffledChoices = function(interaction, choices, identificationType){\n            if(Element.isA(interaction, 'interaction')){\n                this.shuffledChoices[interaction.getSerial()] = _.pluck(interactionHelper.findChoices(interaction, choices, identificationType), 'serial');\n            }\n        };\n\n        /**\n         * Get the choices shuffled for this interaction.\n         *\n         * @param {Object} interaction - the interaction\n         * @param {Boolean} reshuffle - by default choices are shuffled only once and store, but if true you can force shuffling again\n         * @param {String} returnedType - the choice type\n         * @returns {Array} the choices\n         */\n        this.getShuffledChoices = function(interaction, reshuffle, returnedType){\n            var choices = [];\n            var shuffled = [];\n            var serial, i;\n\n            if(Element.isA(interaction, 'interaction')){\n                serial = interaction.getSerial();\n\n                //1st time, we shuffle (or asked to force shuffling)\n                if(!this.shuffledChoices[serial] || reshuffle){\n                    if(Element.isA(interaction, 'matchInteraction')){\n                        this.shuffledChoices[serial] = [];\n                        for(i = 0; i < 2; i++){\n                            choices[i] = interactionHelper.shuffleChoices(interaction.getChoices(i));\n                            this.shuffledChoices[serial][i] = _.pluck(choices[i], 'serial');\n                        }\n                    } else {\n                        choices = interactionHelper.shuffleChoices(interaction.getChoices());\n                        this.shuffledChoices[serial] = _.pluck(choices, 'serial');\n                    }\n\n                //otherwise get the choices from the serials\n                } else {\n                    if(Element.isA(interaction, 'matchInteraction')){\n                        _.forEach(choices, function(choice, index){\n                            if(index < 2){\n                                _.forEach(this.shuffledChoices[serial][i], function(choiceSerial){\n                                    choice.push(interaction.getChoice(choiceSerial));\n                                });\n                            }\n                        });\n                    } else {\n                        _.forEach(this.shuffledChoices[serial], function(choiceSerial){\n                            choices.push(interaction.getChoice(choiceSerial));\n                        });\n                    }\n                }\n\n                //do some type convertion\n                if(returnedType === 'serial' || returnedType === 'identifier'){\n                    return interactionHelper.convertChoices(choices, returnedType);\n                }\n\n                //pass value only, not ref\n                return _.clone(choices);\n            }\n\n            return [];\n        };\n\n        this.getRenderers = function(){\n            return _renderers;\n        };\n\n        this.getLocations = function(){\n            return _locations;\n        };\n\n        this.getAbsoluteUrl = function(relUrl){\n\n            //allow relative url outpu only if explicitely said so\n            if(this.getOption('userRelativeUrl')){\n                return relUrl.replace(/^\\.?\\//, '');\n            }\n\n            if(/^http(s)?:\\/\\//i.test(relUrl)){\n                //already absolute\n                return relUrl;\n            }else{\n\n                var absUrl = '';\n                var runtimeLocations = this.getOption('runtimeLocations');\n\n                if(runtimeLocations && _.size(runtimeLocations)){\n                    _.forIn(runtimeLocations, function(runtimeLocation, typeIdentifier){\n                        if(relUrl.indexOf(typeIdentifier) === 0){\n                            absUrl = relUrl.replace(typeIdentifier, runtimeLocation);\n                            return false;//break\n                        }\n                    });\n                }\n\n                if(absUrl){\n                    return absUrl;\n                }else{\n                    var baseUrl = this.getOption('baseUrl') || getDocumentBaseUrl();\n                    return baseUrl + relUrl;\n                }\n\n            }\n        };\n    };\n\n    return {\n        build : function(renderersLocations, name, defaultOptions){\n            var NewRenderer = function(){\n                Renderer.apply(this, arguments);\n                this.register(renderersLocations);\n                this.name = name || '';\n                if(defaultOptions){\n                    this.setOptions(defaultOptions);\n                }\n            };\n            NewRenderer.prototype = Renderer.prototype;\n            return NewRenderer;\n        }\n    };\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n *\n */\n\n/**\n * The QTI Print renderer configuration\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiPrint/qtiPrintRenderer/renderers/config',[], function(){\n    'use strict';\n\n    /**\n     * @exports taoQtiPrint/qtiPrintRenderer/renderers/config\n     */\n    return {\n        name        : 'printRenderer',\n        locations   : {\n            'assessmentItem':                              'taoQtiPrint/qtiPrintRenderer/renderers/Item',\n            '_container':                                  'taoQtiPrint/qtiPrintRenderer/renderers/Container',\n            'stylesheet':                                  'taoQtiPrint/qtiPrintRenderer/renderers/Stylesheet',\n            'img':                                         'taoQtiPrint/qtiPrintRenderer/renderers/Img',\n            'rubricBlock':                                 'taoQtiPrint/qtiPrintRenderer/renderers/RubricBlock',\n            'object':                                      'taoQtiPrint/qtiPrintRenderer/renderers/Object',\n            'prompt':                                      'taoQtiPrint/qtiPrintRenderer/renderers/interactions/Prompt',\n            'choiceInteraction':                           'taoQtiPrint/qtiPrintRenderer/renderers/interactions/ChoiceInteraction',\n            'extendedTextInteraction':                     'taoQtiPrint/qtiPrintRenderer/renderers/interactions/ExtendedTextInteraction',\n            'textEntryInteraction':                        'taoQtiPrint/qtiPrintRenderer/renderers/interactions/TextEntryInteraction',\n            'simpleChoice.choiceInteraction':              'taoQtiPrint/qtiPrintRenderer/renderers/choices/SimpleChoice.ChoiceInteraction',\n\n//do not print\n            '_simpleFeedbackRule':                         false,\n            'outcomeDeclaration':                          false,\n            'responseDeclaration':                         false,\n            'responseProcessing':                          false,\n            'modalFeedback':                               false,\n\n//not implemented\n            'orderInteraction':                            false,\n            'associateInteraction':                        false,\n            'matchInteraction':                            false,\n            'sliderInteraction':                           false,\n            'simpleChoice.orderInteraction':               false,\n            'hottext':                                     false,\n            'gap':                                         false,\n            'gapText':                                     false,\n            'simpleAssociableChoice.matchInteraction':     false,\n            'simpleAssociableChoice.associateInteraction': false,\n            'hottextInteraction':                          false,\n            'hotspotInteraction':                          false,\n            'gapMatchInteraction':                         false,\n            'inlineChoiceInteraction':                     false,\n            'inlineChoice':                                false,\n            'selectPointInteraction':                      false,\n            'graphicOrderInteraction':                     false,\n            'mediaInteraction':                            false,\n            'uploadInteraction':                           false,\n            'graphicGapMatchInteraction':                  false,\n            'gapImg':                                      false,\n            'graphicAssociateInteraction':                 false,\n            'customInteraction':                           false,\n            'infoControl':                                 false,\n            'endAttemptInteraction':                       false,\n        }\n    };\n});\n\n","\ndefine('css!taoQtiPrintCss/qti',[],function(){});\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n\n/**\n * The QTI Print renderer built using the print config\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiPrint/qtiPrintRenderer/renderers/Renderer',[\n    'taoQtiItem/qtiRunner/core/Renderer',\n    'taoQtiPrint/qtiPrintRenderer/renderers/config',\n    'css!taoQtiPrintCss/qti.css'\n], function(Renderer, config){\n    'use strict';\n\n    /**\n     * Build and expost the printRenderer\n     * @exports taoQtiPrint/qtiPrintRenderer/renderers/config\n     */\n    return Renderer.build(config.locations, config.name);\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\n *\n */\n\n/**\n * Item Runner for printed items\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiPrint/runner/provider/qtiprint',[\n    'helpers',\n    'taoQtiItem/qtiItem/core/Loader',\n    'taoQtiPrint/qtiPrintRenderer/renderers/Renderer'],\nfunction(helpers, QtiLoader, QtiRenderer){\n    'use strict';\n\n    /**\n     * @exports taoQtiPrint/runner/provider/qtiprint\n     */\n    var qtiItemRuntimeProvider = {\n\n        init : function init (itemData, done){\n            var self = this;\n\n            //TODO configure the renderer URLs using an AssetManager\n            this._renderer = new QtiRenderer({\n                baseUrl : helpers._url('getFile', 'QtiCreator', 'taoQtiItem', {uri : this.options.uri, lang : 'en-US'}) + '&relPath='\n            });\n\n            new QtiLoader().loadItemData(itemData, function(item){\n                if(!item){\n                    return self.trigger('error', 'Unable to load item from the given data.');\n                }\n\n                self._item = item;\n                try{\n                    self._renderer.load(function(){\n                        self._item.setRenderer(this);\n\n                        done();\n                    }, this.getLoadedClasses());\n                } catch(e){\n                    self.trigger('error', 'Unable to render the item : ' + e);\n                }\n            });\n\n        },\n\n        render : function render (elt, done){\n            var self = this;\n            if(this._item){\n                try {\n                    elt.innerHTML = this._item.render({});\n                } catch(e){\n                    console.error(e);\n                    self.trigger('error', 'Error in template rendering : ' +  e);\n                }\n                try {\n                    this._item.postRender();\n                } catch(e){\n                    console.error(e);\n                    self.trigger('error', 'Error in post rendering : ' +  e);\n                }\n                done();\n            }\n        },\n\n        clear : function clear (elt, done){\n            done();\n        },\n\n        getState : function getState (){\n            return {};\n        },\n\n        setState : function setState (state){ },\n\n        getResponses : function getResponses (){\n            return [];\n        }\n    };\n\n    return qtiItemRuntimeProvider;\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\n *\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiPrint/runner/itemRunner',[\n    'taoItems/runner/api/itemRunner',\n    'taoQtiPrint/runner/provider/qtiprint'\n], function(itemRunner, qtiRuntimeProvider){\n    'use strict';\n\n    //register the QTI Provider\n    itemRunner.register('qtiprint', qtiRuntimeProvider);\n\n    /**\n     * Expose the itemRunner with the QTI provider registered\n     * @exports taoQtiPrint/runner/itemRunner\n     */\n    return itemRunner;\n});\n\n","/**\n * @fileoverview\n * - Using the 'QRCode for Javascript library'\n * - Fixed dataset of 'QRCode for Javascript library' for support full-spec.\n * - this library has no dependencies.\n * \n * @author davidshimjs\n * @see <a href=\"http://www.d-project.com/\" target=\"_blank\">http://www.d-project.com/</a>\n * @see <a href=\"http://jeromeetienne.github.com/jquery-qrcode/\" target=\"_blank\">http://jeromeetienne.github.com/jquery-qrcode/</a>\n */\n define('taoQtiPrint/lib/qrcode',[], function(){\nvar QRCode;\n\n\t//---------------------------------------------------------------------\n\t// QRCode for JavaScript\n\t//\n\t// Copyright (c) 2009 Kazuhiko Arase\n\t//\n\t// URL: http://www.d-project.com/\n\t//\n\t// Licensed under the MIT license:\n\t//   http://www.opensource.org/licenses/mit-license.php\n\t//\n\t// The word \"QR Code\" is registered trademark of \n\t// DENSO WAVE INCORPORATED\n\t//   http://www.denso-wave.com/qrcode/faqpatent-e.html\n\t//\n\t//---------------------------------------------------------------------\n\tfunction QR8bitByte(data) {\n\t\tthis.mode = QRMode.MODE_8BIT_BYTE;\n\t\tthis.data = data;\n\t\tthis.parsedData = [];\n\n\t\t// Added to support UTF-8 Characters\n\t\tfor (var i = 0, l = this.data.length; i < l; i++) {\n\t\t\tvar byteArray = [];\n\t\t\tvar code = this.data.charCodeAt(i);\n\n\t\t\tif (code > 0x10000) {\n\t\t\t\tbyteArray[0] = 0xF0 | ((code & 0x1C0000) >>> 18);\n\t\t\t\tbyteArray[1] = 0x80 | ((code & 0x3F000) >>> 12);\n\t\t\t\tbyteArray[2] = 0x80 | ((code & 0xFC0) >>> 6);\n\t\t\t\tbyteArray[3] = 0x80 | (code & 0x3F);\n\t\t\t} else if (code > 0x800) {\n\t\t\t\tbyteArray[0] = 0xE0 | ((code & 0xF000) >>> 12);\n\t\t\t\tbyteArray[1] = 0x80 | ((code & 0xFC0) >>> 6);\n\t\t\t\tbyteArray[2] = 0x80 | (code & 0x3F);\n\t\t\t} else if (code > 0x80) {\n\t\t\t\tbyteArray[0] = 0xC0 | ((code & 0x7C0) >>> 6);\n\t\t\t\tbyteArray[1] = 0x80 | (code & 0x3F);\n\t\t\t} else {\n\t\t\t\tbyteArray[0] = code;\n\t\t\t}\n\n\t\t\tthis.parsedData.push(byteArray);\n\t\t}\n\n\t\tthis.parsedData = Array.prototype.concat.apply([], this.parsedData);\n\n\t\tif (this.parsedData.length != this.data.length) {\n\t\t\tthis.parsedData.unshift(191);\n\t\t\tthis.parsedData.unshift(187);\n\t\t\tthis.parsedData.unshift(239);\n\t\t}\n\t}\n\n\tQR8bitByte.prototype = {\n\t\tgetLength: function (buffer) {\n\t\t\treturn this.parsedData.length;\n\t\t},\n\t\twrite: function (buffer) {\n\t\t\tfor (var i = 0, l = this.parsedData.length; i < l; i++) {\n\t\t\t\tbuffer.put(this.parsedData[i], 8);\n\t\t\t}\n\t\t}\n\t};\n\n\tfunction QRCodeModel(typeNumber, errorCorrectLevel) {\n\t\tthis.typeNumber = typeNumber;\n\t\tthis.errorCorrectLevel = errorCorrectLevel;\n\t\tthis.modules = null;\n\t\tthis.moduleCount = 0;\n\t\tthis.dataCache = null;\n\t\tthis.dataList = [];\n\t}\n\n\tQRCodeModel.prototype={addData:function(data){var newData=new QR8bitByte(data);this.dataList.push(newData);this.dataCache=null;},isDark:function(row,col){if(row<0||this.moduleCount<=row||col<0||this.moduleCount<=col){throw new Error(row+\",\"+col);}\n\treturn this.modules[row][col];},getModuleCount:function(){return this.moduleCount;},make:function(){this.makeImpl(false,this.getBestMaskPattern());},makeImpl:function(test,maskPattern){this.moduleCount=this.typeNumber*4+17;this.modules=new Array(this.moduleCount);for(var row=0;row<this.moduleCount;row++){this.modules[row]=new Array(this.moduleCount);for(var col=0;col<this.moduleCount;col++){this.modules[row][col]=null;}}\n\tthis.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();this.setupTypeInfo(test,maskPattern);if(this.typeNumber>=7){this.setupTypeNumber(test);}\n\tif(this.dataCache==null){this.dataCache=QRCodeModel.createData(this.typeNumber,this.errorCorrectLevel,this.dataList);}\n\tthis.mapData(this.dataCache,maskPattern);},setupPositionProbePattern:function(row,col){for(var r=-1;r<=7;r++){if(row+r<=-1||this.moduleCount<=row+r)continue;for(var c=-1;c<=7;c++){if(col+c<=-1||this.moduleCount<=col+c)continue;if((0<=r&&r<=6&&(c==0||c==6))||(0<=c&&c<=6&&(r==0||r==6))||(2<=r&&r<=4&&2<=c&&c<=4)){this.modules[row+r][col+c]=true;}else{this.modules[row+r][col+c]=false;}}}},getBestMaskPattern:function(){var minLostPoint=0;var pattern=0;for(var i=0;i<8;i++){this.makeImpl(true,i);var lostPoint=QRUtil.getLostPoint(this);if(i==0||minLostPoint>lostPoint){minLostPoint=lostPoint;pattern=i;}}\n\treturn pattern;},createMovieClip:function(target_mc,instance_name,depth){var qr_mc=target_mc.createEmptyMovieClip(instance_name,depth);var cs=1;this.make();for(var row=0;row<this.modules.length;row++){var y=row*cs;for(var col=0;col<this.modules[row].length;col++){var x=col*cs;var dark=this.modules[row][col];if(dark){qr_mc.beginFill(0,100);qr_mc.moveTo(x,y);qr_mc.lineTo(x+cs,y);qr_mc.lineTo(x+cs,y+cs);qr_mc.lineTo(x,y+cs);qr_mc.endFill();}}}\n\treturn qr_mc;},setupTimingPattern:function(){for(var r=8;r<this.moduleCount-8;r++){if(this.modules[r][6]!=null){continue;}\n\tthis.modules[r][6]=(r%2==0);}\n\tfor(var c=8;c<this.moduleCount-8;c++){if(this.modules[6][c]!=null){continue;}\n\tthis.modules[6][c]=(c%2==0);}},setupPositionAdjustPattern:function(){var pos=QRUtil.getPatternPosition(this.typeNumber);for(var i=0;i<pos.length;i++){for(var j=0;j<pos.length;j++){var row=pos[i];var col=pos[j];if(this.modules[row][col]!=null){continue;}\n\tfor(var r=-2;r<=2;r++){for(var c=-2;c<=2;c++){if(r==-2||r==2||c==-2||c==2||(r==0&&c==0)){this.modules[row+r][col+c]=true;}else{this.modules[row+r][col+c]=false;}}}}}},setupTypeNumber:function(test){var bits=QRUtil.getBCHTypeNumber(this.typeNumber);for(var i=0;i<18;i++){var mod=(!test&&((bits>>i)&1)==1);this.modules[Math.floor(i/3)][i%3+this.moduleCount-8-3]=mod;}\n\tfor(var i=0;i<18;i++){var mod=(!test&&((bits>>i)&1)==1);this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=mod;}},setupTypeInfo:function(test,maskPattern){var data=(this.errorCorrectLevel<<3)|maskPattern;var bits=QRUtil.getBCHTypeInfo(data);for(var i=0;i<15;i++){var mod=(!test&&((bits>>i)&1)==1);if(i<6){this.modules[i][8]=mod;}else if(i<8){this.modules[i+1][8]=mod;}else{this.modules[this.moduleCount-15+i][8]=mod;}}\n\tfor(var i=0;i<15;i++){var mod=(!test&&((bits>>i)&1)==1);if(i<8){this.modules[8][this.moduleCount-i-1]=mod;}else if(i<9){this.modules[8][15-i-1+1]=mod;}else{this.modules[8][15-i-1]=mod;}}\n\tthis.modules[this.moduleCount-8][8]=(!test);},mapData:function(data,maskPattern){var inc=-1;var row=this.moduleCount-1;var bitIndex=7;var byteIndex=0;for(var col=this.moduleCount-1;col>0;col-=2){if(col==6)col--;while(true){for(var c=0;c<2;c++){if(this.modules[row][col-c]==null){var dark=false;if(byteIndex<data.length){dark=(((data[byteIndex]>>>bitIndex)&1)==1);}\n\tvar mask=QRUtil.getMask(maskPattern,row,col-c);if(mask){dark=!dark;}\n\tthis.modules[row][col-c]=dark;bitIndex--;if(bitIndex==-1){byteIndex++;bitIndex=7;}}}\n\trow+=inc;if(row<0||this.moduleCount<=row){row-=inc;inc=-inc;break;}}}}};QRCodeModel.PAD0=0xEC;QRCodeModel.PAD1=0x11;QRCodeModel.createData=function(typeNumber,errorCorrectLevel,dataList){var rsBlocks=QRRSBlock.getRSBlocks(typeNumber,errorCorrectLevel);var buffer=new QRBitBuffer();for(var i=0;i<dataList.length;i++){var data=dataList[i];buffer.put(data.mode,4);buffer.put(data.getLength(),QRUtil.getLengthInBits(data.mode,typeNumber));data.write(buffer);}\n\tvar totalDataCount=0;for(var i=0;i<rsBlocks.length;i++){totalDataCount+=rsBlocks[i].dataCount;}\n\tif(buffer.getLengthInBits()>totalDataCount*8){throw new Error(\"code length overflow. (\"\n\t+buffer.getLengthInBits()\n\t+\">\"\n\t+totalDataCount*8\n\t+\")\");}\n\tif(buffer.getLengthInBits()+4<=totalDataCount*8){buffer.put(0,4);}\n\twhile(buffer.getLengthInBits()%8!=0){buffer.putBit(false);}\n\twhile(true){if(buffer.getLengthInBits()>=totalDataCount*8){break;}\n\tbuffer.put(QRCodeModel.PAD0,8);if(buffer.getLengthInBits()>=totalDataCount*8){break;}\n\tbuffer.put(QRCodeModel.PAD1,8);}\n\treturn QRCodeModel.createBytes(buffer,rsBlocks);};QRCodeModel.createBytes=function(buffer,rsBlocks){var offset=0;var maxDcCount=0;var maxEcCount=0;var dcdata=new Array(rsBlocks.length);var ecdata=new Array(rsBlocks.length);for(var r=0;r<rsBlocks.length;r++){var dcCount=rsBlocks[r].dataCount;var ecCount=rsBlocks[r].totalCount-dcCount;maxDcCount=Math.max(maxDcCount,dcCount);maxEcCount=Math.max(maxEcCount,ecCount);dcdata[r]=new Array(dcCount);for(var i=0;i<dcdata[r].length;i++){dcdata[r][i]=0xff&buffer.buffer[i+offset];}\n\toffset+=dcCount;var rsPoly=QRUtil.getErrorCorrectPolynomial(ecCount);var rawPoly=new QRPolynomial(dcdata[r],rsPoly.getLength()-1);var modPoly=rawPoly.mod(rsPoly);ecdata[r]=new Array(rsPoly.getLength()-1);for(var i=0;i<ecdata[r].length;i++){var modIndex=i+modPoly.getLength()-ecdata[r].length;ecdata[r][i]=(modIndex>=0)?modPoly.get(modIndex):0;}}\n\tvar totalCodeCount=0;for(var i=0;i<rsBlocks.length;i++){totalCodeCount+=rsBlocks[i].totalCount;}\n\tvar data=new Array(totalCodeCount);var index=0;for(var i=0;i<maxDcCount;i++){for(var r=0;r<rsBlocks.length;r++){if(i<dcdata[r].length){data[index++]=dcdata[r][i];}}}\n\tfor(var i=0;i<maxEcCount;i++){for(var r=0;r<rsBlocks.length;r++){if(i<ecdata[r].length){data[index++]=ecdata[r][i];}}}\n\treturn data;};var QRMode={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3};var QRErrorCorrectLevel={L:1,M:0,Q:3,H:2};var QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var QRUtil={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:(1<<10)|(1<<8)|(1<<5)|(1<<4)|(1<<2)|(1<<1)|(1<<0),G18:(1<<12)|(1<<11)|(1<<10)|(1<<9)|(1<<8)|(1<<5)|(1<<2)|(1<<0),G15_MASK:(1<<14)|(1<<12)|(1<<10)|(1<<4)|(1<<1),getBCHTypeInfo:function(data){var d=data<<10;while(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G15)>=0){d^=(QRUtil.G15<<(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G15)));}\n\treturn((data<<10)|d)^QRUtil.G15_MASK;},getBCHTypeNumber:function(data){var d=data<<12;while(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G18)>=0){d^=(QRUtil.G18<<(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G18)));}\n\treturn(data<<12)|d;},getBCHDigit:function(data){var digit=0;while(data!=0){digit++;data>>>=1;}\n\treturn digit;},getPatternPosition:function(typeNumber){return QRUtil.PATTERN_POSITION_TABLE[typeNumber-1];},getMask:function(maskPattern,i,j){switch(maskPattern){case QRMaskPattern.PATTERN000:return(i+j)%2==0;case QRMaskPattern.PATTERN001:return i%2==0;case QRMaskPattern.PATTERN010:return j%3==0;case QRMaskPattern.PATTERN011:return(i+j)%3==0;case QRMaskPattern.PATTERN100:return(Math.floor(i/2)+Math.floor(j/3))%2==0;case QRMaskPattern.PATTERN101:return(i*j)%2+(i*j)%3==0;case QRMaskPattern.PATTERN110:return((i*j)%2+(i*j)%3)%2==0;case QRMaskPattern.PATTERN111:return((i*j)%3+(i+j)%2)%2==0;default:throw new Error(\"bad maskPattern:\"+maskPattern);}},getErrorCorrectPolynomial:function(errorCorrectLength){var a=new QRPolynomial([1],0);for(var i=0;i<errorCorrectLength;i++){a=a.multiply(new QRPolynomial([1,QRMath.gexp(i)],0));}\n\treturn a;},getLengthInBits:function(mode,type){if(1<=type&&type<10){switch(mode){case QRMode.MODE_NUMBER:return 10;case QRMode.MODE_ALPHA_NUM:return 9;case QRMode.MODE_8BIT_BYTE:return 8;case QRMode.MODE_KANJI:return 8;default:throw new Error(\"mode:\"+mode);}}else if(type<27){switch(mode){case QRMode.MODE_NUMBER:return 12;case QRMode.MODE_ALPHA_NUM:return 11;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 10;default:throw new Error(\"mode:\"+mode);}}else if(type<41){switch(mode){case QRMode.MODE_NUMBER:return 14;case QRMode.MODE_ALPHA_NUM:return 13;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 12;default:throw new Error(\"mode:\"+mode);}}else{throw new Error(\"type:\"+type);}},getLostPoint:function(qrCode){var moduleCount=qrCode.getModuleCount();var lostPoint=0;for(var row=0;row<moduleCount;row++){for(var col=0;col<moduleCount;col++){var sameCount=0;var dark=qrCode.isDark(row,col);for(var r=-1;r<=1;r++){if(row+r<0||moduleCount<=row+r){continue;}\n\tfor(var c=-1;c<=1;c++){if(col+c<0||moduleCount<=col+c){continue;}\n\tif(r==0&&c==0){continue;}\n\tif(dark==qrCode.isDark(row+r,col+c)){sameCount++;}}}\n\tif(sameCount>5){lostPoint+=(3+sameCount-5);}}}\n\tfor(var row=0;row<moduleCount-1;row++){for(var col=0;col<moduleCount-1;col++){var count=0;if(qrCode.isDark(row,col))count++;if(qrCode.isDark(row+1,col))count++;if(qrCode.isDark(row,col+1))count++;if(qrCode.isDark(row+1,col+1))count++;if(count==0||count==4){lostPoint+=3;}}}\n\tfor(var row=0;row<moduleCount;row++){for(var col=0;col<moduleCount-6;col++){if(qrCode.isDark(row,col)&&!qrCode.isDark(row,col+1)&&qrCode.isDark(row,col+2)&&qrCode.isDark(row,col+3)&&qrCode.isDark(row,col+4)&&!qrCode.isDark(row,col+5)&&qrCode.isDark(row,col+6)){lostPoint+=40;}}}\n\tfor(var col=0;col<moduleCount;col++){for(var row=0;row<moduleCount-6;row++){if(qrCode.isDark(row,col)&&!qrCode.isDark(row+1,col)&&qrCode.isDark(row+2,col)&&qrCode.isDark(row+3,col)&&qrCode.isDark(row+4,col)&&!qrCode.isDark(row+5,col)&&qrCode.isDark(row+6,col)){lostPoint+=40;}}}\n\tvar darkCount=0;for(var col=0;col<moduleCount;col++){for(var row=0;row<moduleCount;row++){if(qrCode.isDark(row,col)){darkCount++;}}}\n\tvar ratio=Math.abs(100*darkCount/moduleCount/moduleCount-50)/5;lostPoint+=ratio*10;return lostPoint;}};var QRMath={glog:function(n){if(n<1){throw new Error(\"glog(\"+n+\")\");}\n\treturn QRMath.LOG_TABLE[n];},gexp:function(n){while(n<0){n+=255;}\n\twhile(n>=256){n-=255;}\n\treturn QRMath.EXP_TABLE[n];},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var i=0;i<8;i++){QRMath.EXP_TABLE[i]=1<<i;}\n\tfor(var i=8;i<256;i++){QRMath.EXP_TABLE[i]=QRMath.EXP_TABLE[i-4]^QRMath.EXP_TABLE[i-5]^QRMath.EXP_TABLE[i-6]^QRMath.EXP_TABLE[i-8];}\n\tfor(var i=0;i<255;i++){QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]]=i;}\n\tfunction QRPolynomial(num,shift){if(num.length==undefined){throw new Error(num.length+\"/\"+shift);}\n\tvar offset=0;while(offset<num.length&&num[offset]==0){offset++;}\n\tthis.num=new Array(num.length-offset+shift);for(var i=0;i<num.length-offset;i++){this.num[i]=num[i+offset];}}\n\tQRPolynomial.prototype={get:function(index){return this.num[index];},getLength:function(){return this.num.length;},multiply:function(e){var num=new Array(this.getLength()+e.getLength()-1);for(var i=0;i<this.getLength();i++){for(var j=0;j<e.getLength();j++){num[i+j]^=QRMath.gexp(QRMath.glog(this.get(i))+QRMath.glog(e.get(j)));}}\n\treturn new QRPolynomial(num,0);},mod:function(e){if(this.getLength()-e.getLength()<0){return this;}\n\tvar ratio=QRMath.glog(this.get(0))-QRMath.glog(e.get(0));var num=new Array(this.getLength());for(var i=0;i<this.getLength();i++){num[i]=this.get(i);}\n\tfor(var i=0;i<e.getLength();i++){num[i]^=QRMath.gexp(QRMath.glog(e.get(i))+ratio);}\n\treturn new QRPolynomial(num,0).mod(e);}};function QRRSBlock(totalCount,dataCount){this.totalCount=totalCount;this.dataCount=dataCount;}\n\tQRRSBlock.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];QRRSBlock.getRSBlocks=function(typeNumber,errorCorrectLevel){var rsBlock=QRRSBlock.getRsBlockTable(typeNumber,errorCorrectLevel);if(rsBlock==undefined){throw new Error(\"bad rs block @ typeNumber:\"+typeNumber+\"/errorCorrectLevel:\"+errorCorrectLevel);}\n\tvar length=rsBlock.length/3;var list=[];for(var i=0;i<length;i++){var count=rsBlock[i*3+0];var totalCount=rsBlock[i*3+1];var dataCount=rsBlock[i*3+2];for(var j=0;j<count;j++){list.push(new QRRSBlock(totalCount,dataCount));}}\n\treturn list;};QRRSBlock.getRsBlockTable=function(typeNumber,errorCorrectLevel){switch(errorCorrectLevel){case QRErrorCorrectLevel.L:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+0];case QRErrorCorrectLevel.M:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+1];case QRErrorCorrectLevel.Q:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+2];case QRErrorCorrectLevel.H:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+3];default:return undefined;}};function QRBitBuffer(){this.buffer=[];this.length=0;}\n\tQRBitBuffer.prototype={get:function(index){var bufIndex=Math.floor(index/8);return((this.buffer[bufIndex]>>>(7-index%8))&1)==1;},put:function(num,length){for(var i=0;i<length;i++){this.putBit(((num>>>(length-i-1))&1)==1);}},getLengthInBits:function(){return this.length;},putBit:function(bit){var bufIndex=Math.floor(this.length/8);if(this.buffer.length<=bufIndex){this.buffer.push(0);}\n\tif(bit){this.buffer[bufIndex]|=(0x80>>>(this.length%8));}\n\tthis.length++;}};var QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];\n\t\n\tfunction _isSupportCanvas() {\n\t\treturn typeof CanvasRenderingContext2D != \"undefined\";\n\t}\n\t\n\t// android 2.x doesn't support Data-URI spec\n\tfunction _getAndroid() {\n\t\tvar android = false;\n\t\tvar sAgent = navigator.userAgent;\n\t\t\n\t\tif (/android/i.test(sAgent)) { // android\n\t\t\tandroid = true;\n\t\t\tvar aMat = sAgent.toString().match(/android ([0-9]\\.[0-9])/i);\n\t\t\t\n\t\t\tif (aMat && aMat[1]) {\n\t\t\t\tandroid = parseFloat(aMat[1]);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn android;\n\t}\n\t\n\tvar svgDrawer = (function() {\n\n\t\tvar Drawing = function (el, htOption) {\n\t\t\tthis._el = el;\n\t\t\tthis._htOption = htOption;\n\t\t};\n\n\t\tDrawing.prototype.draw = function (oQRCode) {\n\t\t\tvar _htOption = this._htOption;\n\t\t\tvar _el = this._el;\n\t\t\tvar nCount = oQRCode.getModuleCount();\n\t\t\tvar nWidth = Math.floor(_htOption.width / nCount);\n\t\t\tvar nHeight = Math.floor(_htOption.height / nCount);\n\n\t\t\tthis.clear();\n\n\t\t\tfunction makeSVG(tag, attrs) {\n\t\t\t\tvar el = document.createElementNS('http://www.w3.org/2000/svg', tag);\n\t\t\t\tfor (var k in attrs)\n\t\t\t\t\tif (attrs.hasOwnProperty(k)) el.setAttribute(k, attrs[k]);\n\t\t\t\treturn el;\n\t\t\t}\n\n\t\t\tvar svg = makeSVG(\"svg\" , {'viewBox': '0 0 ' + String(nCount) + \" \" + String(nCount), 'width': '100%', 'height': '100%', 'fill': _htOption.colorLight});\n\t\t\tsvg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n\t\t\t_el.appendChild(svg);\n\n\t\t\tsvg.appendChild(makeSVG(\"rect\", {\"fill\": _htOption.colorLight, \"width\": \"100%\", \"height\": \"100%\"}));\n\t\t\tsvg.appendChild(makeSVG(\"rect\", {\"fill\": _htOption.colorDark, \"width\": \"1\", \"height\": \"1\", \"id\": \"template\"}));\n\n\t\t\tfor (var row = 0; row < nCount; row++) {\n\t\t\t\tfor (var col = 0; col < nCount; col++) {\n\t\t\t\t\tif (oQRCode.isDark(row, col)) {\n\t\t\t\t\t\tvar child = makeSVG(\"use\", {\"x\": String(row), \"y\": String(col)});\n\t\t\t\t\t\tchild.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\", \"#template\")\n\t\t\t\t\t\tsvg.appendChild(child);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tDrawing.prototype.clear = function () {\n\t\t\twhile (this._el.hasChildNodes())\n\t\t\t\tthis._el.removeChild(this._el.lastChild);\n\t\t};\n\t\treturn Drawing;\n\t})();\n\n\tvar useSVG = document.documentElement.tagName.toLowerCase() === \"svg\";\n\n\t// Drawing in DOM by using Table tag\n\tvar Drawing = useSVG ? svgDrawer : !_isSupportCanvas() ? (function () {\n\t\tvar Drawing = function (el, htOption) {\n\t\t\tthis._el = el;\n\t\t\tthis._htOption = htOption;\n\t\t};\n\t\t\t\n\t\t/**\n\t\t * Draw the QRCode\n\t\t * \n\t\t * @param {QRCode} oQRCode\n\t\t */\n\t\tDrawing.prototype.draw = function (oQRCode) {\n            var _htOption = this._htOption;\n            var _el = this._el;\n\t\t\tvar nCount = oQRCode.getModuleCount();\n\t\t\tvar nWidth = Math.floor(_htOption.width / nCount);\n\t\t\tvar nHeight = Math.floor(_htOption.height / nCount);\n\t\t\tvar aHTML = ['<table style=\"border:0;border-collapse:collapse;\">'];\n\t\t\t\n\t\t\tfor (var row = 0; row < nCount; row++) {\n\t\t\t\taHTML.push('<tr>');\n\t\t\t\t\n\t\t\t\tfor (var col = 0; col < nCount; col++) {\n\t\t\t\t\taHTML.push('<td style=\"border:0;border-collapse:collapse;padding:0;margin:0;width:' + nWidth + 'px;height:' + nHeight + 'px;background-color:' + (oQRCode.isDark(row, col) ? _htOption.colorDark : _htOption.colorLight) + ';\"></td>');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\taHTML.push('</tr>');\n\t\t\t}\n\t\t\t\n\t\t\taHTML.push('</table>');\n\t\t\t_el.innerHTML = aHTML.join('');\n\t\t\t\n\t\t\t// Fix the margin values as real size.\n\t\t\tvar elTable = _el.childNodes[0];\n\t\t\tvar nLeftMarginTable = (_htOption.width - elTable.offsetWidth) / 2;\n\t\t\tvar nTopMarginTable = (_htOption.height - elTable.offsetHeight) / 2;\n\t\t\t\n\t\t\tif (nLeftMarginTable > 0 && nTopMarginTable > 0) {\n\t\t\t\telTable.style.margin = nTopMarginTable + \"px \" + nLeftMarginTable + \"px\";\t\n\t\t\t}\n\t\t};\n\t\t\n\t\t/**\n\t\t * Clear the QRCode\n\t\t */\n\t\tDrawing.prototype.clear = function () {\n\t\t\tthis._el.innerHTML = '';\n\t\t};\n\t\t\n\t\treturn Drawing;\n\t})() : (function () { // Drawing in Canvas\n\t\tfunction _onMakeImage() {\n\t\t\tthis._elImage.src = this._elCanvas.toDataURL(\"image/png\");\n\t\t\tthis._elImage.style.display = \"block\";\n\t\t\tthis._elCanvas.style.display = \"none\";\t\t\t\n\t\t}\n\t\t\n\t\t// Android 2.1 bug workaround\n\t\t// http://code.google.com/p/android/issues/detail?id=5141\n\t\tif (this._android && this._android <= 2.1) {\n\t    \tvar factor = 1 / window.devicePixelRatio;\n\t        var drawImage = CanvasRenderingContext2D.prototype.drawImage; \n\t    \tCanvasRenderingContext2D.prototype.drawImage = function (image, sx, sy, sw, sh, dx, dy, dw, dh) {\n\t    \t\tif ((\"nodeName\" in image) && /img/i.test(image.nodeName)) {\n\t\t        \tfor (var i = arguments.length - 1; i >= 1; i--) {\n\t\t            \targuments[i] = arguments[i] * factor;\n\t\t        \t}\n\t    \t\t} else if (typeof dw == \"undefined\") {\n\t    \t\t\targuments[1] *= factor;\n\t    \t\t\targuments[2] *= factor;\n\t    \t\t\targuments[3] *= factor;\n\t    \t\t\targuments[4] *= factor;\n\t    \t\t}\n\t    \t\t\n\t        \tdrawImage.apply(this, arguments); \n\t    \t};\n\t\t}\n\t\t\n\t\t/**\n\t\t * Check whether the user's browser supports Data URI or not\n\t\t * \n\t\t * @private\n\t\t * @param {Function} fSuccess Occurs if it supports Data URI\n\t\t * @param {Function} fFail Occurs if it doesn't support Data URI\n\t\t */\n\t\tfunction _safeSetDataURI(fSuccess, fFail) {\n            var self = this;\n            self._fFail = fFail;\n            self._fSuccess = fSuccess;\n\n            // Check it just once\n            if (self._bSupportDataURI === null) {\n                var el = document.createElement(\"img\");\n                var fOnError = function() {\n                    self._bSupportDataURI = false;\n\n                    if (self._fFail) {\n                        self._fFail.call(self);\n                    }\n                };\n                var fOnSuccess = function() {\n                    self._bSupportDataURI = true;\n\n                    if (self._fSuccess) {\n                        self._fSuccess.call(self);\n                    }\n                };\n\n                el.onabort = fOnError;\n                el.onerror = fOnError;\n                el.onload = fOnSuccess;\n                el.src = \"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\"; // the Image contains 1px data.\n                return;\n            } else if (self._bSupportDataURI === true && self._fSuccess) {\n                self._fSuccess.call(self);\n            } else if (self._bSupportDataURI === false && self._fFail) {\n                self._fFail.call(self);\n            }\n\t\t};\n\t\t\n\t\t/**\n\t\t * Drawing QRCode by using canvas\n\t\t * \n\t\t * @constructor\n\t\t * @param {HTMLElement} el\n\t\t * @param {Object} htOption QRCode Options \n\t\t */\n\t\tvar Drawing = function (el, htOption) {\n    \t\tthis._bIsPainted = false;\n    \t\tthis._android = _getAndroid();\n\t\t\n\t\t\tthis._htOption = htOption;\n\t\t\tthis._elCanvas = document.createElement(\"canvas\");\n\t\t\tthis._elCanvas.width = htOption.width;\n\t\t\tthis._elCanvas.height = htOption.height;\n\t\t\tel.appendChild(this._elCanvas);\n\t\t\tthis._el = el;\n\t\t\tthis._oContext = this._elCanvas.getContext(\"2d\");\n\t\t\tthis._bIsPainted = false;\n\t\t\tthis._elImage = document.createElement(\"img\");\n\t\t\tthis._elImage.alt = \"Scan me!\";\n\t\t\tthis._elImage.style.display = \"none\";\n\t\t\tthis._el.appendChild(this._elImage);\n\t\t\tthis._bSupportDataURI = null;\n\t\t};\n\t\t\t\n\t\t/**\n\t\t * Draw the QRCode\n\t\t * \n\t\t * @param {QRCode} oQRCode \n\t\t */\n\t\tDrawing.prototype.draw = function (oQRCode) {\n            var _elImage = this._elImage;\n            var _oContext = this._oContext;\n            var _htOption = this._htOption;\n            \n\t\t\tvar nCount = oQRCode.getModuleCount();\n\t\t\tvar nWidth = _htOption.width / nCount;\n\t\t\tvar nHeight = _htOption.height / nCount;\n\t\t\tvar nRoundedWidth = Math.round(nWidth);\n\t\t\tvar nRoundedHeight = Math.round(nHeight);\n\n\t\t\t_elImage.style.display = \"none\";\n\t\t\tthis.clear();\n\t\t\t\n\t\t\tfor (var row = 0; row < nCount; row++) {\n\t\t\t\tfor (var col = 0; col < nCount; col++) {\n\t\t\t\t\tvar bIsDark = oQRCode.isDark(row, col);\n\t\t\t\t\tvar nLeft = col * nWidth;\n\t\t\t\t\tvar nTop = row * nHeight;\n\t\t\t\t\t_oContext.strokeStyle = bIsDark ? _htOption.colorDark : _htOption.colorLight;\n\t\t\t\t\t_oContext.lineWidth = 1;\n\t\t\t\t\t_oContext.fillStyle = bIsDark ? _htOption.colorDark : _htOption.colorLight;\t\t\t\t\t\n\t\t\t\t\t_oContext.fillRect(nLeft, nTop, nWidth, nHeight);\n\t\t\t\t\t\n\t\t\t\t\t//    \n\t\t\t\t\t_oContext.strokeRect(\n\t\t\t\t\t\tMath.floor(nLeft) + 0.5,\n\t\t\t\t\t\tMath.floor(nTop) + 0.5,\n\t\t\t\t\t\tnRoundedWidth,\n\t\t\t\t\t\tnRoundedHeight\n\t\t\t\t\t);\n\t\t\t\t\t\n\t\t\t\t\t_oContext.strokeRect(\n\t\t\t\t\t\tMath.ceil(nLeft) - 0.5,\n\t\t\t\t\t\tMath.ceil(nTop) - 0.5,\n\t\t\t\t\t\tnRoundedWidth,\n\t\t\t\t\t\tnRoundedHeight\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis._bIsPainted = true;\n\t\t};\n\t\t\t\n\t\t/**\n\t\t * Make the image from Canvas if the browser supports Data URI.\n\t\t */\n\t\tDrawing.prototype.makeImage = function () {\n\t\t\tif (this._bIsPainted) {\n\t\t\t\t_safeSetDataURI.call(this, _onMakeImage);\n\t\t\t}\n\t\t};\n\t\t\t\n\t\t/**\n\t\t * Return whether the QRCode is painted or not\n\t\t * \n\t\t * @return {Boolean}\n\t\t */\n\t\tDrawing.prototype.isPainted = function () {\n\t\t\treturn this._bIsPainted;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Clear the QRCode\n\t\t */\n\t\tDrawing.prototype.clear = function () {\n\t\t\tthis._oContext.clearRect(0, 0, this._elCanvas.width, this._elCanvas.height);\n\t\t\tthis._bIsPainted = false;\n\t\t};\n\t\t\n\t\t/**\n\t\t * @private\n\t\t * @param {Number} nNumber\n\t\t */\n\t\tDrawing.prototype.round = function (nNumber) {\n\t\t\tif (!nNumber) {\n\t\t\t\treturn nNumber;\n\t\t\t}\n\t\t\t\n\t\t\treturn Math.floor(nNumber * 1000) / 1000;\n\t\t};\n\t\t\n\t\treturn Drawing;\n\t})();\n\t\n\t/**\n\t * Get the type by string length\n\t * \n\t * @private\n\t * @param {String} sText\n\t * @param {Number} nCorrectLevel\n\t * @return {Number} type\n\t */\n\tfunction _getTypeNumber(sText, nCorrectLevel) {\t\t\t\n\t\tvar nType = 1;\n\t\tvar length = _getUTF8Length(sText);\n\t\t\n\t\tfor (var i = 0, len = QRCodeLimitLength.length; i <= len; i++) {\n\t\t\tvar nLimit = 0;\n\t\t\t\n\t\t\tswitch (nCorrectLevel) {\n\t\t\t\tcase QRErrorCorrectLevel.L :\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][0];\n\t\t\t\t\tbreak;\n\t\t\t\tcase QRErrorCorrectLevel.M :\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase QRErrorCorrectLevel.Q :\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][2];\n\t\t\t\t\tbreak;\n\t\t\t\tcase QRErrorCorrectLevel.H :\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][3];\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tif (length <= nLimit) {\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tnType++;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (nType > QRCodeLimitLength.length) {\n\t\t\tthrow new Error(\"Too long data\");\n\t\t}\n\t\t\n\t\treturn nType;\n\t}\n\n\tfunction _getUTF8Length(sText) {\n\t\tvar replacedText = encodeURI(sText).toString().replace(/\\%[0-9a-fA-F]{2}/g, 'a');\n\t\treturn replacedText.length + (replacedText.length != sText ? 3 : 0);\n\t}\n\t\n\t/**\n\t * @class QRCode\n\t * @constructor\n\t * @example \n\t * new QRCode(document.getElementById(\"test\"), \"http://jindo.dev.naver.com/collie\");\n\t *\n\t * @example\n\t * var oQRCode = new QRCode(\"test\", {\n\t *    text : \"http://naver.com\",\n\t *    width : 128,\n\t *    height : 128\n\t * });\n\t * \n\t * oQRCode.clear(); // Clear the QRCode.\n\t * oQRCode.makeCode(\"http://map.naver.com\"); // Re-create the QRCode.\n\t *\n\t * @param {HTMLElement|String} el target element or 'id' attribute of element.\n\t * @param {Object|String} vOption\n\t * @param {String} vOption.text QRCode link data\n\t * @param {Number} [vOption.width=256]\n\t * @param {Number} [vOption.height=256]\n\t * @param {String} [vOption.colorDark=\"#000000\"]\n\t * @param {String} [vOption.colorLight=\"#ffffff\"]\n\t * @param {QRCode.CorrectLevel} [vOption.correctLevel=QRCode.CorrectLevel.H] [L|M|Q|H] \n\t */\n\tQRCode = function (el, vOption) {\n\t\tthis._htOption = {\n\t\t\twidth : 256, \n\t\t\theight : 256,\n\t\t\ttypeNumber : 4,\n\t\t\tcolorDark : \"#000000\",\n\t\t\tcolorLight : \"#ffffff\",\n\t\t\tcorrectLevel : QRErrorCorrectLevel.H\n\t\t};\n\t\t\n\t\tif (typeof vOption === 'string') {\n\t\t\tvOption\t= {\n\t\t\t\ttext : vOption\n\t\t\t};\n\t\t}\n\t\t\n\t\t// Overwrites options\n\t\tif (vOption) {\n\t\t\tfor (var i in vOption) {\n\t\t\t\tthis._htOption[i] = vOption[i];\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (typeof el == \"string\") {\n\t\t\tel = document.getElementById(el);\n\t\t}\n\n\t\tif (this._htOption.useSVG) {\n\t\t\tDrawing = svgDrawer;\n\t\t}\n\t\t\n\t\tthis._android = _getAndroid();\n\t\tthis._el = el;\n\t\tthis._oQRCode = null;\n\t\tthis._oDrawing = new Drawing(this._el, this._htOption);\n\t\t\n\t\tif (this._htOption.text) {\n\t\t\tthis.makeCode(this._htOption.text);\t\n\t\t}\n\t};\n\t\n\t/**\n\t * Make the QRCode\n\t * \n\t * @param {String} sText link data\n\t */\n\tQRCode.prototype.makeCode = function (sText) {\n\t\tthis._oQRCode = new QRCodeModel(_getTypeNumber(sText, this._htOption.correctLevel), this._htOption.correctLevel);\n\t\tthis._oQRCode.addData(sText);\n\t\tthis._oQRCode.make();\n\t\tthis._el.title = sText;\n\t\tthis._oDrawing.draw(this._oQRCode);\t\t\t\n\t\tthis.makeImage();\n\t};\n\t\n\t/**\n\t * Make the Image from Canvas element\n\t * - It occurs automatically\n\t * - Android below 3 doesn't support Data-URI spec.\n\t * \n\t * @private\n\t */\n\tQRCode.prototype.makeImage = function () {\n\t\tif (typeof this._oDrawing.makeImage == \"function\" && (!this._android || this._android >= 3)) {\n\t\t\tthis._oDrawing.makeImage();\n\t\t}\n\t};\n\t\n\t/**\n\t * Clear the QRCode\n\t */\n\tQRCode.prototype.clear = function () {\n\t\tthis._oDrawing.clear();\n\t};\n\t\n\t/**\n\t * @name QRCode.CorrectLevel\n\t */\n\tQRCode.CorrectLevel = QRErrorCorrectLevel;\n\t\n\treturn QRCode;\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiPrint/runner/testRunner',[\n    'jquery',\n    'lodash',\n    'async',\n    'helpers',\n    'taoQtiPrint/runner/itemRunner',\n    'taoQtiPrint/lib/qrcode'\n], function($, _, async, helpers, itemRunner, QRCode) {\n    'use str11ict';\n\n    //TODO find him his own place. Waiting is own house, the testRenderer squats the runner flat.\n    var testRenderer = {\n\n        createPage: function createPage(type) {\n            return $('<section></section>').addClass(type);\n        },\n\n        //TODO replace by a template\n        testPage: function rendertestPage(test, done) {\n\n            var $testPage = this.createPage('title');\n            var $codeElt = $('<div class=\"qr-code\">');\n            var qrCode = new QRCode($codeElt[0], {\n                text:         helpers._url('render', 'PrintTest', 'taoBooklet', { uri :  test.uri}),\n                width:        192,\n                height:       192,\n                colorDark:    \"#000000\",\n                colorLight:   \"#ffffff\",\n                correctLevel: QRCode.CorrectLevel.H\n            });\n\n            $testPage.append('<h1>' + test.title + '</h1>')\n                     .append($codeElt);\n\n            done(null, $testPage);\n        },\n\n        //TODO replace by a template\n        sectionPage: function renderSectionPage(section, pageNum, done) {\n\n\n            var $sectionPage = this.createPage('section');\n\n            $sectionPage.append('<h2>' + section.title + '</h2>');\n\n            _.forEach(section.rubricBlock, function(rubricBlock) {\n                $sectionPage.append('<div>' + rubricBlock + '</div>');\n            });\n            done(null, $sectionPage);\n        },\n\n        itemPage: function renderItemPage(item, uri, pageNum, done) {\n            var $itemContainer = this.createPage('item');\n\n            itemRunner('qtiprint', item, { uri : uri})\n                .on('error', function(err) {\n                    done(err);\n                })\n                .on('render', function() {\n                    done(null, $itemContainer);\n                })\n                .init()\n                .render($itemContainer);\n        }\n    };\n\n    /**\n     *\n     * Builds a brand new {@link TestRunner}.\n     *\n     * <strong>The factory is an internal mechanism to create encapsulated contexts.\n     *  I suggest you to use directly the name <i>testRunner</i> when you require this module.</strong>\n     *\n     *\n     * @exports testRunner\n     * @namespace testRunnerFactory\n     *\n     *\n     * @returns {TestRunner}\n     */\n    var testRunnerFactory = function testRunnerFactory(testData, options) {\n\n        testData = testData || {};\n\n        if (!testData || !testData.data || !testData.items) {\n            throw new Error('Invalid test data structure');\n        }\n\n        //contains the bound events.\n        var events = {};\n\n        var testRunner = {\n\n            /**\n             * Test container\n             * @type {jQueryElement}\n             */\n            $container: null,\n\n            /**\n             * Initialize the current item.\n             *\n             * @param {HTMLElement|jQueryElement} elt - the DOM element that is going to contain the rendered test.\n             * @returns {TestRunner} to chain calls\n             *\n             * @fires TestRunner#ready\n             * @fires TestRunner#render\n             * @fires TestRunner#error if the elt isn't valid\n             *\n             * @fires TestRunner#statechange the provider is reponsible to trigger this event\n             * @fires TestRunner#responsechange  the provider is reponsible to trigger this event\n             */\n            render: function(elt) {\n                var self = this;\n                var pageRenderers = [];\n\n                //check elt\n                if (!(elt instanceof HTMLElement) && !(elt instanceof $)) {\n                    return self.trigger('error', 'A valid HTMLElement (or a jquery element) at least is required to render the test');\n                }\n\n                //we keep a reference to the container\n                if (elt instanceof $) {\n                    this.$container = elt;\n                } else {\n                    this.$container = $(elt);\n                }\n\n                //Build the pageRenderers array that contains each page to render\n\n                //transform the function of the renderer to fit the format required by async (partial with data and binding)\n                pageRenderers.push(\n                    _.bind(\n                        _.partial(testRenderer.testPage, testData.data),\n                        testRenderer\n                    )\n                );\n\n                _.forEach(testData.data.testParts, function(testPart) {\n                    _.forEach(testPart.sections, function(section) {\n\n                        pageRenderers.push(\n                            _.bind(\n                                _.partial(testRenderer.sectionPage, section, pageRenderers.length),\n                                testRenderer\n                            )\n                        );\n\n                        _.forEach(section.items, function(item) {\n                            //\n                            if (testData.items[item.href] && testData.items[item.href].data) {\n                                //transform the function of the renderer to fit the format required by async (partial with data and binding)\n                                pageRenderers.push(\n                                    _.bind(\n                                        _.partial(testRenderer.itemPage, testData.items[item.href].data, item.href, pageRenderers.length),\n                                        testRenderer\n                                   )\n                                );\n                            }\n                        });\n                    });\n                });\n\n                //then we call all the renderers in parallel\n                async.parallel(pageRenderers, function renderingDone(err, $results) {\n                    if (err) {\n                        self.trigger('error', 'An error occurred while rendering a page :  ' + err);\n                    }\n\n                    //dummy rtl support from options\n                    if(options && options.rtl === true){\n                        self.$container.addClass('rtl').attr('dir', 'rtl');\n                    }\n\n                    //once they are all done, we insert the content to the container\n                    self.$container.empty().append($results);\n\n\n                    /**\n                     * The test is rendered\n                     * @event TestRunner#render\n                     */\n                    self.trigger('render');\n\n                    /**\n                     * The test is ready.\n                     * Alias of {@link TestRunner#render}\n                     * @event TestRunner#ready\n                     */\n                    self.trigger('ready');\n                });\n\n                return this;\n            },\n\n            /**\n             * Clear the running test.\n             * @returns {TestRunner}\n             *\n             * @fires TestRunner#clear\n             */\n            clear: function() {\n\n                this.$container.empty();\n\n                /**\n                 * The test is ready.\n                 * @event TestRunner#clear\n                 */\n                this.trigger('clear');\n\n                return this;\n            },\n            /**\n             * Attach an event handler.\n             * Calling `on` with the same eventName multiple times add callbacks: they\n             * will all be executed.\n             *\n             * @param {String} name - the name of the event to listen\n             * @param {Function} handler - the callback to run once the event is triggered. It's executed with the current testRunner context (ie. this\n             * @returns {TestRunner}\n             */\n            on: function(name, handler) {\n                if (_.isString(name) && _.isFunction(handler)) {\n                    events[name] = events[name] || [];\n                    events[name].push(handler);\n                }\n                return this;\n            },\n\n            /**\n             * Remove handlers for an event.\n             *\n             * @param {String} name - the event name\n             * @returns {TestRunner}\n             */\n            off: function(name) {\n                if (_.isString(name)) {\n                    events[name] = [];\n                }\n                return this;\n            },\n\n            /**\n             * Trigger an event manually.\n             *\n             * @param {String} name - the name of the event to trigger\n             * @param {*} data - arguments given to the handlers\n             * @returns {TestRunner}\n             */\n            trigger: function(name, data) {\n                var self = this;\n                if (_.isString(name) && _.isArray(events[name])) {\n                    _.forEach(events[name], function(event) {\n                        event.call(self, data);\n                    });\n                }\n                return this;\n            }\n        };\n\n        return testRunner;\n    };\n\n    return testRunnerFactory;\n});\n\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n */\n\n/**\n *\n * This controller renders a printable test in the current page.\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoBooklet/controller/printtest/render',[\n    'jquery',\n    'taoQtiPrint/runner/testRunner'\n], function($, testRunner){\n    'use strict';\n\n    /**\n     * As the page can be called by an external tool and\n     * as we build the page in JS asynchronously, we need this hack\n     * to tell the 3rd part tool that the page is ready.\n     */\n    var ready = function ready(){\n        window.status = 'runner-ready';\n    };\n\n    /**\n     * Old school way to debug document, especially when generated in PDF.\n     * It appends the message to the body.\n     * @param {String} msg - the content to display\n     */\n    var showMessage = function showMessage(msg, type){\n        type = type || 'info';\n        $('body').append('<div class=\"feedback-' + type + '\">'  + msg + '</div>');\n    };\n\n    /**\n     * Hack the current layout to match arbitrary rules\n     */\n    var printLayoutHacking = function printLayoutHacking($container){\n\n        var threshold = 6000;   //this height seems to work - value is empirical and linked to the A4 page layout with 300 DPI\n        var pages = 2;          //start on page 2\n        var previous;           //keep a ref to the previous section\n\n        //add a blank page\n        var blankPage = function blankPage( $section ){\n            $section.before('<div class=\"breaker\"></div>');\n            pages++;\n        };\n\n        //add pages based on the given height\n        var computePageFromHeight = function computePageFromHeight(height){\n            if(height > threshold){\n                pages += Math.ceil(height / threshold) - 1;\n            }\n        };\n\n        //browse direct section add apply the odd/even rules for section and items\n        $container.children('section').each(function(){\n            var $section = $(this);\n            var height;\n            var msg = '';\n\n            if($section.hasClass('section')){\n\n                if(pages % 2 === 0){\n                    blankPage($section);\n                }\n\n                computePageFromHeight($section.outerHeight());\n\n                previous = 'section';\n                pages++;\n            }\n            if($section.hasClass('item')){\n                if(previous !== 'item'){\n\n                    if(pages % 2 !== 0){\n                        blankPage($section);\n                    }\n\n                    height = $section.outerHeight();\n                    $section.nextUntil('.section', '.item').each(function(){\n                        height += $(this).outerHeight();\n                    });\n                    computePageFromHeight(height);\n\n                    pages++;\n                }\n                previous = 'item';\n            }\n        });\n    };\n\n    /**\n     * The renderer controller\n     */\n    var renderController = {\n\n        /**\n         * Controller entry point\n         * @param {Object} testData - the packed test data required by the testRunner\n         */\n        start : function start(testData, options){\n\n            //this is just in case something went wrong, but we weren't able to catch it.\n            setTimeout(function(){\n                showMessage(\"Something went wrong...\", 'error');\n                ready();\n            }, 45*1000);\n\n\n            //the content will be inserted in a detached element (to save time)\n            var $mainContainer = $('<main>');\n\n            //instantiate the TestRunner\n            testRunner(testData, options)\n              .on('error', function(e){\n                console.error(e);\n                showMessage(e, 'error');\n                ready();\n              })\n              .on('ready', function(){\n\n                //we attach the container to the DOM\n                $('body').append($mainContainer);\n\n                //hacky layout calculation\n                printLayoutHacking($mainContainer);\n\n                //we are done\n                ready();\n              })\n              .render($mainContainer);\n        }\n    };\n\n    /**\n     * @exports taoBooklet/controller/printtest/render\n     */\n    return renderController;\n});\n\n"]}